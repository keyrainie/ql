<?xml version="1.0" encoding="utf-8" ?>
<dataOperations xmlns="http://oversea.newegg.com/DataOperation"
				xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

  <dataCommand name="GetSpecialItemForC1Page" database="OverseaECommerceManagement" commandType="Text">
    <commandText>
      <![CDATA[			
		SELECT   TOP @num 
				Isnull(ps.firstonlinetime,0)   firstonlinetime,
				Datediff(DAY,Isnull(ps.firstonlinetime,0),Getdate()) Days,
				p.sysno  productsysno,
				p.ProductID,
				p.Category3SysNo  c3sysno,
				c.category2sysno  c2sysno,
				p.CurrentPrice/p.basicprice as Discount
		FROM     overseacontentmanagement.dbo.v_cm_itemcommoninfo_V2  p WITH (nolock)
			INNER JOIN overseacontentmanagement.dbo.V_CM_Product_Status ps WITH (nolock)
				      ON ps.productsysno = p.sysno
			INNER JOIN overseacontentmanagement.dbo.v_cm_categoryinfo_V2 c WITH (nolock)
				      ON p.Category3SysNo = c.category3sysno
			INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
					  ON  inventory.ItemSysNumber=p.sysno  
		WHERE    p.[status] = 1  
		         AND p.ProductType=0
		         AND c.category1sysno=@C1SysNo			
				 AND NOT EXISTS   (SELECT * FROM [IPP3].[dbo].[f_splitstr]('@HasItemSysnolist',',')					
                                       WHERE CAST(F1 AS INT) =p.Sysno ) 
				 AND p.CompanyCode=@CompanyCode
				 AND (inventory.OnlineQty>0 OR inventory.ShiftQty>0)
				 and p.basicprice is not null
				 and p.basicprice<>0
		ORDER BY Discount
			]]>
    </commandText>
  </dataCommand>

  <dataCommand name="CheckOnlinelistItemByPageType" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			  
SELECT distinct A.[SysNo] 
   ,A.[OnlineListlocationSysNo]
   ,IC.[SysNo]  AS ProductSysNo
   ,IC.ProductName                    
   ,A.[ProductID]
   ,A.[Priority]
   ,A.[BeginDate]
   ,A.[EndDate]
   ,A.[InDate]  CreateDate
   ,A.[InUser]  CreateUserName
   ,A.[EditDate]  LastEditDate
   ,A.[EditUser] LastEditUserName
   ,A.[Status]
   ,B.[PageType]
   ,B.[PositionID]
   ,B.[PageID]
   ,B.[Description] 
   ,m.sysno    BrandSysNo
   ,C3.[Category1Sysno]   C1SysNo
   ,C3.[Category2Sysno]   C2SysNo
   ,C3.[Category3Sysno]   C3SysNo
   ,IC.Status   ProductStatus
   ,Inventory.[OnlineQty]  
   ,Inventory.[ShiftQty]                                                 
    ,Isnull(IC.[Week1SalesCount],0)  W1    
    ,Isnull(IC.[Week4SalesCount],0)  W4                                                     
    ,Isnull(IC.[Month1SalesCount],0)  M1
    ,Isnull(IC.[Month2SalesCount],0)  M2
    ,Isnull(IC.[Month3SalesCount],0)  M3                                                          
FROM OverseaECommerceManagement.[dbo].[OnlineList] A WITH(NOLOCK)
LEFT JOIN OverseaECommerceManagement.[dbo].[OnlineListlocation] B WITH(NOLOCK)
    ON (A.OnlineListlocationSysNo=B.OnlineListlocationSysNo)
INNER JOIN OverseaContentManagement.dbo.V_CM_ItemCommonInfo AS IC WITH(NOLOCK)
   ON(A.ProductID=IC.ProductID)
LEFT JOIN OverseaInventoryManagement.dbo.V_INM_Inventory AS Inventory WITH(NOLOCK)
   ON(IC.[SysNo] = Inventory.ItemSysNumber) 
LEFT JOIN [OverseaContentManagement].[dbo].[V_CM_CategoryInfo] C3 WITH(NOLOCK) 
    ON IC.Category3Sysno= C3.[Category3Sysno] 
INNER JOIN overseacontentmanagement.dbo.V_CM_Manufacturer m  WITH (NOLOCK)
		ON  IC.ManufacturerSysNo=m.sysno   
WHERE   A.[InDate]>getdate()-30 	
    AND A.[InUser]<>'System'
	AND B.[PageType]=@PageType
	AND A.[Status]='A' 
	AND B.[Status]='A'
	AND IC.Status=1 
	AND (Inventory.[OnlineQty]>0  OR Inventory.[ShiftQty]>0 )   
	AND A.CompanyCode=@CompanyCode
ORDER BY A.Priority
        ]]>
		</commandText>
		<parameters>
			<param name="@PageType" dbType="Int32"/>
			<param name="@CompanyCode" dbType="String"/>
		</parameters>
	</dataCommand>

	<dataCommand name="InsertOnlineList" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
			INSERT INTO [OverseaECommerceManagement].[dbo].[OnlineList]
					   ([OnlineListlocationSysNo]
					   ,[ProductID]
					   ,[Priority]
					   ,[BeginDate]
					   ,[EndDate]
					   ,[InDate]
					   ,[InUser]
					   ,[EditDate]
					   ,[EditUser]
					   ,[Status]
					   ,[CompanyCode]
					   ,[LanguageCode]
					   ,[StoreCompanyCode])
				 VALUES
					   (@OnlineListlocationSysNo
					   ,@ProductID
					   ,@Priority
					   ,@BeginDate
					   ,@EndDate
					   ,@InDate
					   ,@InUser
					   ,@EditDate
					   ,@EditUser
					   ,@Status
					   ,@CompanyCode
					   ,@LanguageCode
					   ,@StoreCompanyCode)
				SELECT @SysNo=SCOPE_IDENTITY()
			  ]]>
		</commandText>
		<parameters>
			<param name="@SysNo" dbType="Int32"  direction="Output"/>
			<param name="@OnlineListlocationSysNo" dbType="Int32"/>
			<param name="@ProductID" dbType="String"/>
			<param name="@Priority" dbType="Int32"/>
			<param name="@BeginDate" dbType="DateTime"/>
			<param name="@EndDate" dbType="DateTime"/>
			<param name="@InDate" dbType="DateTime"/>
			<param name="@InUser" dbType="String"/>
			<param name="@EditDate" dbType="DateTime"/>
			<param name="@EditUser" dbType="String"/>
			<param name="@Status" dbType="String"/>
			<param name="@CompanyCode" dbType="String"/>
			<param name="@LanguageCode" dbType="String"/>
			<param name="@StoreCompanyCode" dbType="String"/>
		</parameters>
	</dataCommand>

	<dataCommand name="InsertOnlineListlocation" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
			INSERT INTO [OverseaECommerceManagement].[dbo].[OnlineListlocation]
						([PageType]
						,[PositionID]
						,[Priority]
						,[PageID]
						,[Description]
						,[InDate]
						,[InUser]
						,[EditDate]
						,[EditUser]
						,[Status]
						,[CompanyCode]
						,[LanguageCode]
						,[StoreCompanyCode])
				VALUES
						(@PageType
						,@PositionID
						,@Priority
						,@PageID
						,@Description
						,@InDate
						,@InUser
						,@EditDate
						,@EditUser
						,@Status
						,@CompanyCode
						,@LanguageCode
						,@StoreCompanyCode)
	
				SELECT @OnlineListlocationSysNo=SCOPE_IDENTITY()
			  ]]>
		</commandText>
		<parameters>
			<param name="@OnlineListlocationSysNo" dbType="Int32"  direction="Output"/>
			<param name="@PageType" dbType="Int32"/>
			<param name="@PositionID" dbType="Int32"/>
			<param name="@Priority" dbType="Int32"/>
			<param name="@PageID" dbType="Int32"/>
			<param name="@Description" dbType="String"/>
			<param name="@InDate" dbType="DateTime"/>
			<param name="@InUser" dbType="String"/>
			<param name="@EditDate" dbType="DateTime"/>
			<param name="@EditUser" dbType="String"/>
			<param name="@Status" dbType="String"/>
			<param name="@CompanyCode" dbType="String"/>
			<param name="@LanguageCode" dbType="String"/>
			<param name="@StoreCompanyCode" dbType="String"/>
		</parameters>
	</dataCommand>

	<dataCommand name="DeleteOnlineList" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[
			UPDATE  OverseaECommerceManagement.dbo.OnlineList				
			SET  [Status] ='D'
				,[EditDate] = getdate()
				,[EditUser] = 'System'			
			WHERE  OnlineListlocationSysNo IN (
										SELECT [OnlineListlocationSysNo]   
										 FROM [OverseaECommerceManagement].[dbo].[OnlineListlocation] WITH(NOlOCK)
										WHERE  [Status]='A'  
										AND  [CompanyCode]=@CompanyCode
										AND   [PageType]=@PageType
										AND   [PositionID]=@PositionID
										)
					AND CompanyCode=@CompanyCode 
					AND ISNULL(InUser,0)<>'System'	
					AND [Status] ='A'
					AND InDate<getdate()-30 				
			
			UPDATE  OverseaECommerceManagement.dbo.OnlineList				
			SET  [Status] ='D'
				,[EditDate] = getdate()
				,[EditUser] = 'System'			
			WHERE  InUser='System'
				AND 	OnlineListlocationSysNo IN (
										SELECT [OnlineListlocationSysNo]   
										 FROM [OverseaECommerceManagement].[dbo].[OnlineListlocation] WITH(NOlOCK)
										WHERE  [Status]='A'  
										AND  [CompanyCode]=@CompanyCode
										AND   [PageType]=@PageType
										AND   [PositionID]=@PositionID
										)
			     AND InDate<'@BeginTime'	
				 AND [Status] ='A'
			     AND CompanyCode=@CompanyCode
			]]>
		</commandText>
	</dataCommand>

	<dataCommand name="DeleteOnlineListSingle" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[
			UPDATE  OverseaECommerceManagement.dbo.OnlineList				
			SET  [Status] ='D'
				,[EditDate] = getdate()
				,[EditUser] = 'System'			
			WHERE  OnlineListlocationSysNo IN (
										SELECT [OnlineListlocationSysNo]   
										 FROM [OverseaECommerceManagement].[dbo].[OnlineListlocation]
										WHERE  [Status]='A'  
										AND  [CompanyCode]=@CompanyCode
										AND   [PageType]=@PageType
										AND   [PositionID]=@PositionID
										)
					AND CompanyCode=@CompanyCode 
					AND ISNULL(InUser,0)<>'System'
					AND [Status] ='A'
					AND  InDate<getdate()-30
			]]>
		</commandText>
	</dataCommand>

	<dataCommand name="GetAllBrand" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[
	SELECT distinct SysNo  BrandSysno  	       
	FROM IPP3.dbo.Manufacturer WITH(NOLOCK)
	WHERE [Status]=0 AND [Type]>0  AND CompanyCode=@CompanyCode
			]]>
		</commandText>
		<parameters>
			<param name="@CompanyCode" dbType="String"/>
		</parameters>
	</dataCommand>

	<dataCommand name="CheckOnlineListLocation" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
			SELECT OnlineListlocationSysNo  
			FROM [OverseaECommerceManagement].[dbo].[OnlineListlocation] WITH(NOLOCK)
			WHERE  [PageType]=@PageType  
					AND  [PositionID]=@PositionID
					AND  [PageID]=@PageID	
					AND  [status]='A'		
					AND CompanyCode=@CompanyCode
			]]>
		</commandText>
		<parameters>
			<param name="@PageType" dbType="Int32"/>
			<param name="@PageID" dbType="Int32"/>
			<param name="@PositionID" dbType="Int32"/>
			<param name="@CompanyCode" dbType="String"/>
		</parameters>
	</dataCommand>


	<dataCommand name="GetAllC1SysNolist" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
		SELECT distinct Category1Sysno C1SysNo
		FROM overseacontentmanagement.dbo.v_cm_categoryinfo_V2  WITH(NOLOCK)
		WHERE Category1Status=0 AND CompanyCode=@CompanyCode
			]]>
		</commandText>
		<parameters>
			<param name="@CompanyCode" dbType="String"/>
		</parameters>
	</dataCommand>

	<dataCommand name="GetAllC2SysNolist" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
		SELECT distinct [Category2Sysno]   C2SysNo
		FROM [OverseaContentManagement].[dbo].[V_CM_CategoryInfo]
		WHERE [Category2Status]=0 AND CompanyCode=@CompanyCode
			]]>
		</commandText>
		<parameters>
			<param name="@CompanyCode" dbType="String"/>
		</parameters>
	</dataCommand>

	<dataCommand name="GetAllC3SysNolist" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
		SELECT  distinct [Category3Sysno]   C3SysNo
		FROM [OverseaContentManagement].[dbo].[V_CM_CategoryInfo]
		WHERE [Category3Status]=0 AND CompanyCode=@CompanyCode
			]]>
		</commandText>
		<parameters>
			<param name="@CompanyCode" dbType="String"/>
		</parameters>
	</dataCommand>

	<dataCommand name="GetPriceDownItem" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
			SELECT  top @num  
					 pl.productsysno,
					 p.ProductID,
					c3.category2sysno    c2sysno,
					c3.category3sysno    c3sysno,
					Sum(pl.adjustmentprice) adjustmentprice
			FROM    [OverseaContentManagement].[dbo].[ProductPricechangeLog]  pl WITH (NOLOCK)
			INNER JOIN [OverseaContentManagement].[dbo].[V_CM_ItemCommonInfo]  p  WITH (NOLOCK)
				ON p.sysno = pl.productsysno AND p.Status=1
			INNER JOIN [OverseaContentManagement].[dbo].[V_CM_CategoryInfo]  c3  WITH (NOLOCK)
				ON p.category3sysno = c3.[Category3Sysno]
			INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
		        ON  inventory.ItemSysNumber=pl.productsysno 
			WHERE    pl.createdate>Getdate()- 7 
			         AND  c3.category2sysno=@C2SysNo	
					 AND pl.CompanyCode=@CompanyCode
					  AND (inventory.OnlineQty>0 OR inventory.ShiftQty>0)
					  AND pl.adjustmentprice<0
					  AND p.ProductType=0
			GROUP BY pl.productsysno,
					c3.category2sysno,
					 p.ProductID,
					c3.category3sysno
			ORDER BY adjustmentprice 
			]]>
		</commandText>
	</dataCommand>

	<dataCommand name="GetPriceDownItemForBrand" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
			SELECT  top @num  
					 pl.productsysno,
					 p.ProductID,		
					 Sum(pl.adjustmentprice) adjustmentprice,
					 m.sysno  BrandSysNo
			FROM    [OverseaContentManagement].[dbo].[ProductPricechangeLog]  pl WITH (NOLOCK)
			INNER JOIN [OverseaContentManagement].[dbo].[V_CM_ItemCommonInfo]  p  WITH (NOLOCK)
				ON p.sysno = pl.productsysno AND p.Status=1
			INNER JOIN overseacontentmanagement.dbo.V_CM_Manufacturer m  WITH (NOLOCK)
				ON  p.ManufacturerSysNo=m.sysno
			INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
		        ON  inventory.ItemSysNumber=pl.productsysno 
			WHERE   pl.createdate>Getdate()-7 
					AND   m.sysno=@BrandSysNo					
					  AND NOT EXISTS   (SELECT * FROM [IPP3].[dbo].[f_splitstr]('@HasItemSysnolist',',')					
                                       WHERE CAST(F1 AS INT) = pl.productsysno) 				
					AND pl.CompanyCode=@CompanyCode
					 AND (inventory.OnlineQty>0 OR inventory.ShiftQty>0)
					 AND pl.adjustmentprice<0
					 AND p.ProductType=0
			GROUP BY pl.productsysno,m.sysno,p.ProductID		
			ORDER BY adjustmentprice 
			]]>
		</commandText>
	</dataCommand>

	<dataCommand name="GetPriceDownItemForBrandSingle" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
			SELECT  top @num  
					 pl.productsysno,
					 p.ProductID,		
					 Sum(pl.adjustmentprice) adjustmentprice,
					 m.sysno  BrandSysNo
			FROM    [OverseaContentManagement].[dbo].[ProductPricechangeLog]  pl WITH (NOLOCK)
			INNER JOIN [OverseaContentManagement].[dbo].[V_CM_ItemCommonInfo]  p  WITH (NOLOCK)
				ON p.sysno = pl.productsysno AND p.Status=1
			INNER JOIN overseacontentmanagement.dbo.V_CM_Manufacturer m  WITH (NOLOCK)
				ON  p.ManufacturerSysNo=m.sysno
			INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
		        ON  inventory.ItemSysNumber=pl.productsysno  
			WHERE   pl.createdate>Getdate()- 7 
					AND   m.sysno=@BrandSysNo				
					AND pl.CompanyCode=@CompanyCode
					 AND pl.adjustmentprice<0
					 AND (inventory.OnlineQty>0 OR inventory.ShiftQty>0)
					 AND p.ProductType=0
			GROUP BY pl.productsysno,m.sysno,p.ProductID		
			ORDER BY adjustmentprice 
			]]>
		</commandText>
	</dataCommand>

	<dataCommand name="GetPriceDownItemForC1Page" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
			SELECT  top @num  
					 pl.productsysno,
					 p.ProductID,
					c3.category2sysno    c2sysno,
					c3.category3sysno    c3sysno,
					Sum(pl.adjustmentprice) adjustmentprice
			FROM    [OverseaContentManagement].[dbo].[ProductPricechangeLog]  pl WITH (NOLOCK)
			INNER JOIN [OverseaContentManagement].[dbo].[V_CM_ItemCommonInfo]  p  WITH (NOLOCK)
				ON p.sysno = pl.productsysno AND p.Status=1
			INNER JOIN [OverseaContentManagement].[dbo].[V_CM_CategoryInfo]  c3  WITH (NOLOCK)
				ON p.category3sysno = c3.[Category3Sysno]
			INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
		        ON  inventory.ItemSysNumber=pl.productsysno  
			WHERE    pl.createdate>Getdate()-7 
			         AND  c3.category1sysno=@C1SysNo				
					   AND NOT EXISTS   (SELECT * FROM [IPP3].[dbo].[f_splitstr]('@HasItemSysnolist',',')					
                                       WHERE CAST(F1 AS INT) = pl.productsysno) 					 
					 AND pl.CompanyCode=@CompanyCode
					 AND (inventory.OnlineQty>0 OR inventory.ShiftQty>0)
					  AND pl.adjustmentprice<0
					    AND p.ProductType=0
			GROUP BY pl.productsysno,
			         p.ProductID,
					c3.category2sysno,
					c3.category3sysno
			ORDER BY adjustmentprice 
			]]>
		</commandText>
	</dataCommand>

	<dataCommand name="GetPriceDownItemForC1PageSingle" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
			SELECT  top @num  
					 pl.productsysno,
					 p.ProductID,
					c3.category2sysno    c2sysno,
					c3.category3sysno    c3sysno,
					Sum(pl.adjustmentprice) adjustmentprice
			FROM    [OverseaContentManagement].[dbo].[ProductPricechangeLog]  pl WITH (NOLOCK)
			INNER JOIN [OverseaContentManagement].[dbo].[V_CM_ItemCommonInfo]  p  WITH (NOLOCK)
				ON p.sysno = pl.productsysno 
			INNER JOIN [OverseaContentManagement].[dbo].[V_CM_CategoryInfo]  c3  WITH (NOLOCK)
				ON p.category3sysno = c3.[Category3Sysno]
			INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
		        ON  inventory.ItemSysNumber=pl.productsysno  
			WHERE    pl.createdate>Getdate()-7 
			         AND  c3.category1sysno=@C1SysNo					
					 AND pl.CompanyCode=@CompanyCode
					 AND (inventory.OnlineQty>0 OR inventory.ShiftQty>0)
					 AND pl.adjustmentprice<0
					 AND p.ProductType=0
				     AND p.Status=1
			GROUP BY pl.productsysno,
			         p.ProductID,
					 c3.category2sysno,
					 c3.category3sysno
			ORDER BY adjustmentprice 
			]]>
		</commandText>
	</dataCommand>

	<dataCommand name="GetPriceDownItemForC2Page" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
			SELECT  top @num  
					 pl.productsysno,
					 p.ProductID,
					c3.category2sysno    c2sysno,
					c3.category3sysno    c3sysno,
					Sum(pl.adjustmentprice) adjustmentprice
			FROM    [OverseaContentManagement].[dbo].[ProductPricechangeLog]  pl WITH (NOLOCK)
			INNER JOIN [OverseaContentManagement].[dbo].[V_CM_ItemCommonInfo]  p  WITH (NOLOCK)
				ON p.sysno = pl.productsysno  AND p.CompanyCode=@CompanyCode 
			INNER JOIN [OverseaContentManagement].[dbo].[V_CM_CategoryInfo]  c3  WITH (NOLOCK)
				ON p.category3sysno = c3.[Category3Sysno]  AND c3.CompanyCode=@CompanyCode
			INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
		        ON  inventory.ItemSysNumber=pl.productsysno  
			WHERE    pl.createdate>Getdate()-7 
			         AND  c3.category2sysno=@C2SysNo	
					 AND NOT EXISTS   (SELECT * FROM [IPP3].[dbo].[f_splitstr]('@HasItemSysnolist',',')					
                                       WHERE CAST(F1 AS INT) = pl.productsysno) 		
					 AND pl.CompanyCode=@CompanyCode
					 AND pl.adjustmentprice<0
					 AND p.ProductType=0
				     AND p.Status=1
					 AND (inventory.OnlineQty>0 OR inventory.ShiftQty>0)
			GROUP BY pl.productsysno,
			         p.ProductID,
					c3.category2sysno,
					c3.category3sysno
			ORDER BY adjustmentprice 
			]]>
		</commandText>
	</dataCommand>

	<dataCommand name="GetPriceDownItemForC2PageSingle" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
			SELECT  top @num  
					 pl.productsysno,
					 p.ProductID,
					c3.category2sysno    c2sysno,
					c3.category3sysno    c3sysno,
					Sum(pl.adjustmentprice) adjustmentprice
			FROM    [OverseaContentManagement].[dbo].[ProductPricechangeLog]  pl WITH (NOLOCK)
			INNER JOIN [OverseaContentManagement].[dbo].[V_CM_ItemCommonInfo]  p  WITH (NOLOCK)
				ON p.sysno = pl.productsysno  AND p.CompanyCode=@CompanyCode 
			INNER JOIN [OverseaContentManagement].[dbo].[V_CM_CategoryInfo]  c3  WITH (NOLOCK)
				ON p.category3sysno = c3.[Category3Sysno]  AND c3.CompanyCode=@CompanyCode
			INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
		        ON  inventory.ItemSysNumber=pl.productsysno  
			WHERE    pl.createdate>Getdate()-7 
			         AND  c3.category2sysno=@C2SysNo					
					 AND pl.CompanyCode=@CompanyCode
					 AND pl.adjustmentprice<0
					 AND p.ProductType=0
				     AND p.Status=1
					 AND (inventory.OnlineQty>0 OR inventory.ShiftQty>0)
			GROUP BY pl.productsysno,
			         p.ProductID,
					 c3.category2sysno,
					 c3.category3sysno
			ORDER BY adjustmentprice 
			]]>
		</commandText>
	</dataCommand>

	<dataCommand name="GetPriceDownItemForC3Page" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
			SELECT  top @num  
					pl.productsysno,
					p.ProductID,
					c3.category2sysno    c2sysno,
					c3.category3sysno    c3sysno,
					Sum(pl.adjustmentprice) adjustmentprice
			FROM    [OverseaContentManagement].[dbo].[ProductPricechangeLog]  pl WITH (NOLOCK)
			INNER JOIN [OverseaContentManagement].[dbo].[V_CM_ItemCommonInfo]  p  WITH (NOLOCK)
				ON p.sysno = pl.productsysno AND p.CompanyCode=@CompanyCode 
			INNER JOIN [OverseaContentManagement].[dbo].[V_CM_CategoryInfo]  c3  WITH (NOLOCK)
				ON p.category3sysno = c3.[Category3Sysno] AND c3.CompanyCode=@CompanyCode
			INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
		        ON  inventory.ItemSysNumber=pl.productsysno  
			WHERE    pl.createdate>Getdate()-7 
			         AND  c3.category3sysno=@C3SysNo
					 AND NOT EXISTS   (SELECT * FROM [IPP3].[dbo].[f_splitstr]('@HasItemSysnolist',',')					
                                       WHERE CAST(F1 AS INT) = pl.productsysno) 
					 AND pl.CompanyCode=@CompanyCode
					 AND pl.adjustmentprice<0
					 AND p.ProductType=0
				     AND p.Status=1
					 AND (inventory.OnlineQty>0 OR inventory.ShiftQty>0)
			GROUP BY pl.productsysno,
			         p.ProductID,
					 c3.category2sysno,
					 c3.category3sysno
			ORDER BY adjustmentprice 
			]]>
		</commandText>
	</dataCommand>

	<dataCommand name="GetPriceDownItemForC3PageSingle" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
			SELECT  top @num  
					 pl.productsysno,
					 p.ProductID,
					 c3.category2sysno    c2sysno,
					 c3.category3sysno    c3sysno,
					 Sum(pl.adjustmentprice) adjustmentprice
			FROM    [OverseaContentManagement].[dbo].[ProductPricechangeLog]  pl WITH (NOLOCK)
			INNER JOIN [OverseaContentManagement].[dbo].[V_CM_ItemCommonInfo]  p  WITH (NOLOCK)
				ON p.sysno = pl.productsysno AND p.CompanyCode=@CompanyCode 
			INNER JOIN [OverseaContentManagement].[dbo].[V_CM_CategoryInfo]  c3  WITH (NOLOCK)
				ON p.category3sysno = c3.[Category3Sysno] AND c3.CompanyCode=@CompanyCode
			INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
		        ON  inventory.ItemSysNumber=pl.productsysno  
			WHERE    pl.createdate>Getdate()-7 
			         AND  c3.category3sysno=@C3SysNo					
					 AND pl.CompanyCode=@CompanyCode
					 AND (inventory.OnlineQty>0 OR inventory.ShiftQty>0)
					 AND pl.adjustmentprice<0
					 AND p.ProductType=0
					 AND p.Status=1
			GROUP BY pl.productsysno,
			         p.ProductID,
					 c3.category2sysno,
					 c3.category3sysno
			ORDER BY adjustmentprice 
			]]>
		</commandText>
	</dataCommand>

	<dataCommand name="GetPriceDownPercentItemForC2" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
			SELECT  TOP @num  
			        a.Sysno  ProductSysNo
				   ,a.ProductID 
		   FROM  (SELECT item.Sysno
					    ,item.ProductID
					    ,max(item.currentprice) as CurrentPrice
					    ,isnull( max(case when price.[OldPrice]>price.[NewPrice] 
						     then price.[OldPrice]
							 else  price.[NewPrice] end)
					    ,max(item.currentprice)) as [OldPrice]
			FROM OverseaContentManagement.dbo.V_CM_ItemCommonInfo as item with(nolock)
			INNER JOIN  [OverseaContentManagement].[dbo].[ProductPricechangeLog] price with(nolock)				         
			  ON item.Sysno=price.ProductSysno 
		    INNER JOIN  [OverseaContentManagement].dbo.V_CM_CategoryInfo  c with(nolock)	
	          ON c.Category3Sysno=item.Category3SysNo and c.Category2Sysno=@C2SysNo
			INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
		      ON  inventory.ItemSysNumber=item.Sysno  
			WHERE item.[Status]=1  
			    AND price.CreateDate>getdate()-7 
				AND item.CurrentPrice<>0
				AND item.CompanyCode=@CompanyCode
				AND item.LanguageCode='zh-CN' 
				AND NOT EXISTS   (SELECT * FROM [IPP3].[dbo].[f_splitstr]('@HasItemSysnolist',',')					
                                       WHERE CAST(F1 AS INT) =item.Sysno ) 
				AND item.ProductType=0
				AND OldPrice>0
				AND (inventory.OnlineQty>0 OR inventory.ShiftQty>0)
			GROUP BY item.Sysno,item.ProductID
			) as a
			ORDER BY (OldPrice-CurrentPrice)/OldPrice 
			]]>
		</commandText>
	</dataCommand>

	<dataCommand name="GetPriceDownPercentItemForC2Single" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
			SELECT  TOP @num  
			        a.Sysno  ProductSysNo
				   ,a.ProductID 
		   FROM  (SELECT item.Sysno
					    ,item.ProductID
					    ,max(item.currentprice) as CurrentPrice
					    ,isnull( max(case when price.[OldPrice]>price.[NewPrice] 
						     then price.[OldPrice]
							 else  price.[NewPrice] end)
					    ,max(item.currentprice)) as [OldPrice]
					FROM OverseaContentManagement.dbo.V_CM_ItemCommonInfo as item  WITH(NOLOCK)
					INNER JOIN  [OverseaContentManagement].[dbo].[ProductPricechangeLog]  price  WITH(NOLOCK)		         
					  ON item.Sysno=price.ProductSysno
					INNER JOIN  [OverseaContentManagement].dbo.V_CM_CategoryInfo  c WITH(NOLOCK)
					  ON c.Category3Sysno=item.Category3SysNo and c.Category2Sysno=@C2SysNo
					 INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
						ON  inventory.ItemSysNumber=item.Sysno 
					WHERE item.[Status]=1  
					    AND price.CreateDate>getdate()-7 
						AND item.CurrentPrice<>0
						AND item.CompanyCode=@CompanyCode
						AND item.LanguageCode='zh-CN' 
						AND item.ProductType=0
						AND OldPrice>0
						AND (inventory.OnlineQty>0 OR inventory.ShiftQty>0)
					GROUP BY item.Sysno,item.ProductID
				) as a
			ORDER BY (OldPrice-CurrentPrice)/OldPrice 
			]]>
		</commandText>
	</dataCommand>

	<dataCommand name="GetPriceDownItemForHome" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
			SELECT  top @num  
					pl.productsysno,
					p.ProductID,
					c3.category2sysno    c2sysno,
					c3.category3sysno    c3sysno,
					Sum(adjustmentprice) adjustmentprice
			FROM    [OverseaContentManagement].[dbo].[ProductPricechangeLog]  pl WITH (NOLOCK)
			INNER JOIN [OverseaContentManagement].[dbo].[V_CM_ItemCommonInfo]  p  WITH (NOLOCK)
				ON p.sysno = pl.productsysno 
			INNER JOIN [OverseaContentManagement].[dbo].[V_CM_CategoryInfo]  c3  WITH (NOLOCK)
				ON p.category3sysno = c3.[Category3Sysno]
			INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
		        ON  inventory.ItemSysNumber=pl.productsysno  
			WHERE    pl.createdate>Getdate()-7 
			         AND  c3.category2sysno=@C2SysNo					
					 AND NOT EXISTS   (SELECT * FROM [IPP3].[dbo].[f_splitstr]('@ItemSysnolist',',')					
                                       WHERE CAST(F1 AS INT) = pl.productsysno) 
					 AND pl.CompanyCode=@CompanyCode
					 AND p.ProductType=0
					 AND p.Status=1
					 AND (inventory.OnlineQty>0 OR inventory.ShiftQty>0)
			GROUP BY pl.productsysno,
			         p.ProductID,
					 c3.category2sysno,
					 c3.category3sysno
			ORDER BY adjustmentprice 
			]]>
		</commandText>
	</dataCommand>


	<dataCommand name="GetSaleHightItem" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
			SELECT   TOP @num 
						item.sysno  productsysno,
						item.ProductID,
						Max(Isnull(item.week1salescount,0)) W1,
						c.category2sysno                    c2sysno,
						item.category3sysno                 c3sysno
			FROM     overseacontentmanagement.dbo.v_cm_itemcommoninfo_V2 item WITH (nolock)
				INNER JOIN overseacontentmanagement.dbo.v_cm_categoryinfo_V2 c WITH (nolock)
					   ON item.category3sysno = c.category3sysno
				INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
		               ON  inventory.ItemSysNumber=item.sysno  
			WHERE    c.category2sysno =@C2SysNo  
			         AND item.status = 1
					 AND item.CompanyCode=@CompanyCode
					 AND item.ProductType=0
					 AND (inventory.OnlineQty>0 OR inventory.ShiftQty>0)
			GROUP BY item.week1salescount,
					 item.sysno,
					 c.category2sysno,
					 item.category3sysno,
					 item.ProductID
			ORDER BY item.week1salescount DESC
			]]>
		</commandText>
	</dataCommand>

	<dataCommand name="GetSaleHightItemForHomePage" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
			SELECT   TOP @num 
			                item.sysno  productsysno,
							item.ProductID,
							Max(Isnull(item.week1salescount,0)) W1,
							c.category2sysno                    c2sysno,
							item.category3sysno                 c3sysno
			FROM     overseacontentmanagement.dbo.v_cm_itemcommoninfo_V2 item WITH (nolock)
		    INNER JOIN overseacontentmanagement.dbo.v_cm_categoryinfo_V2 c WITH (nolock)
				ON item.category3sysno = c.category3sysno
			INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
		        ON  inventory.ItemSysNumber=item.sysno  
			WHERE    c.category2sysno =@C2SysNo
			         AND item.status = 1 
					 AND NOT EXISTS   (SELECT * FROM [IPP3].[dbo].[f_splitstr]('@ItemSysnolist',',')					
                                       WHERE CAST(F1 AS INT) =item.Sysno ) 
					 AND item.CompanyCode=@CompanyCode
					 AND item.ProductType=0
					 AND (inventory.OnlineQty>0 OR inventory.ShiftQty>0)
			GROUP BY item.week1salescount,
					 item.sysno,
					 c.category2sysno,
					 item.ProductID,
					 item.category3sysno
			ORDER BY item.week1salescount DESC
			]]>
		</commandText>
	</dataCommand>

	<dataCommand name="GetSaleHightItemForHomePageSingle" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
			SELECT   TOP @num 
		                item.sysno  productsysno,
						item.ProductID,
						Max(Isnull(item.week1salescount,0)) W1,
						c.category2sysno                    c2sysno,
						item.category3sysno                 c3sysno
			FROM     overseacontentmanagement.dbo.v_cm_itemcommoninfo_V2 item WITH (nolock)
		    INNER JOIN overseacontentmanagement.dbo.v_cm_categoryinfo_V2 c WITH (nolock)
					   ON item.category3sysno = c.category3sysno
		    INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
		               ON  inventory.ItemSysNumber=item.sysno  
			WHERE    c.category2sysno =@C2SysNo
			         AND item.status = 1 	
					 AND item.ProductType=0
					 AND item.CompanyCode=@CompanyCode
					 AND (inventory.OnlineQty>0 OR inventory.ShiftQty>0)
			GROUP BY item.week1salescount,
					 item.sysno,
					 c.category2sysno,
					 item.ProductID,
					 item.category3sysno
			ORDER BY item.week1salescount DESC
			]]>
		</commandText>
	</dataCommand>

	<!--专卖店当季热销-->
	<dataCommand name="GetSaleHightItemForBrand" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
	SELECT   TOP @num
	            item.sysno  productsysno,
				item.ProductID,	
				Isnull((item.Month1Salescount+item.Month2Salescount+item.Month3Salescount),0) M3,			
				m.sysno  BrandSysNo
	FROM     overseacontentmanagement.dbo.v_cm_itemcommoninfo_V2 item WITH (nolock)
	 INNER JOIN overseacontentmanagement.dbo.v_cm_categoryinfo_V2 c WITH (nolock)
	      ON item.category3sysno = c.category3sysno
	INNER JOIN overseacontentmanagement.dbo.V_CM_Manufacturer m  WITH (nolock)
	      ON  item.ManufacturerSysNo=m.sysno
	INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
		 ON  inventory.ItemSysNumber=item.sysno 
	WHERE  item.status = 1
			AND  m.sysno=@BrandSysNo
			AND item.ProductType=0		
			AND NOT EXISTS   (SELECT * FROM [IPP3].[dbo].[f_splitstr]('@HasItemSysnolist',',')					
                                       WHERE CAST(F1 AS INT) =item.Sysno ) 
			AND item.CompanyCode=@CompanyCode
			AND (inventory.OnlineQty>0 OR inventory.ShiftQty>0)
	GROUP BY (item.Month1Salescount+item.Month2Salescount+item.Month3Salescount)
			 ,item.sysno
			 ,item.ProductID
			 ,m.sysno			 
	ORDER BY (item.Month1SalesCount+item.Month2SalesCount+item.Month3SalesCount) DESC
			]]>
		</commandText>
	</dataCommand>

	<dataCommand name="GetSaleHightItemForBrandSingle" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
	SELECT   TOP @num
	            item.sysno  productsysno,
				item.ProductID,	
				Isnull((item.Month1SalesCount+item.Month2SalesCount+item.Month3SalesCount),0) M3,			
				m.sysno  BrandSysNo
	FROM   overseacontentmanagement.dbo.v_cm_itemcommoninfo_V2 item WITH (nolock)
	INNER JOIN overseacontentmanagement.dbo.v_cm_categoryinfo_V2 c WITH (nolock)
	      ON item.category3sysno = c.category3sysno
	INNER JOIN overseacontentmanagement.dbo.V_CM_Manufacturer m  WITH (nolock)
	      ON  item.ManufacturerSysNo=m.sysno
	INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
		 ON  inventory.ItemSysNumber=item.sysno 
	WHERE  item.status =1
			AND  m.sysno=@BrandSysNo	
			AND item.ProductType=0
			AND item.CompanyCode=@CompanyCode    
			AND (inventory.OnlineQty>0 OR inventory.ShiftQty>0)	  
	GROUP BY (item.Month1SalesCount+item.Month2SalesCount+item.Month3SalesCount)
			 ,item.sysno
			 ,item.ProductID
			 ,m.sysno			 
	ORDER BY (item.Month1SalesCount+item.Month2SalesCount+item.Month3SalesCount) DESC
			]]>
		</commandText>
	</dataCommand>

	<dataCommand name="GetSaleHightItemForC1Page" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
			SELECT   TOP @num 
			                item.sysno  productsysno,
							item.ProductID,
							Max(Isnull(item.week1salescount,0)) W1,
							c.category2sysno                    c2sysno,
							item.category3sysno                 c3sysno
			FROM     overseacontentmanagement.dbo.v_cm_itemcommoninfo_V2 item WITH (nolock)
				INNER JOIN overseacontentmanagement.dbo.v_cm_categoryinfo_V2 c WITH (nolock)
					   ON item.category3sysno = c.category3sysno
				INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
					  ON  inventory.ItemSysNumber=item.sysno  
			WHERE    c.category1sysno =@C1SysNo
			         AND item.status = 1 				
					 AND NOT EXISTS   (SELECT * FROM [IPP3].[dbo].[f_splitstr]('@ItemSysnolist',',')					
                                       WHERE CAST(F1 AS INT) =item.Sysno ) 
					 AND item.CompanyCode=@CompanyCode
					 AND item.ProductType=0
					 AND (inventory.OnlineQty>0 OR inventory.ShiftQty>0)
			GROUP BY item.week1salescount,
					 item.sysno,
					 c.category2sysno,
					 item.ProductID,
					 item.category3sysno
			ORDER BY item.week1salescount DESC
			]]>
		</commandText>
	</dataCommand>

	<dataCommand name="GetSaleHightItemForC1PagebyC2sysno" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
			SELECT  TOP @num 
	                item.sysno  productsysno,
					item.ProductID,
					Max(Isnull(item.week1salescount,0)) W1,
					c.category2sysno                    c2sysno,
					item.category3sysno                 c3sysno
		FROM     overseacontentmanagement.dbo.v_cm_itemcommoninfo_V2 item WITH (nolock)
				INNER JOIN overseacontentmanagement.dbo.v_cm_categoryinfo_V2 c WITH (nolock)
					   ON item.category3sysno = c.category3sysno
				INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
					  ON  inventory.ItemSysNumber=item.sysno  
			WHERE    c.category2sysno =@C2SysNo
			         AND item.status = 1 
					 AND NOT EXISTS   (SELECT * FROM [IPP3].[dbo].[f_splitstr]('@ItemSysnolist',',')					
                                       WHERE CAST(F1 AS INT) =item.Sysno ) 
					 AND item.CompanyCode=@CompanyCode
					 AND item.ProductType=0
					 AND (inventory.OnlineQty>0 OR inventory.ShiftQty>0)
			GROUP BY item.week1salescount,
					 item.sysno,
					 c.category2sysno,
					 item.ProductID,
					 item.category3sysno
			ORDER BY item.week1salescount DESC
			]]>
		</commandText>
	</dataCommand>

	<dataCommand name="GetSaleHightItemForC1PageSingle" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
			SELECT  TOP @num 
	                item.sysno  productsysno,
					item.ProductID,
					Max(Isnull(item.week1salescount,0)) W1,
					c.category2sysno                    c2sysno,
					item.category3sysno                 c3sysno
			FROM     overseacontentmanagement.dbo.v_cm_itemcommoninfo_V2 item WITH (nolock)
				INNER JOIN overseacontentmanagement.dbo.v_cm_categoryinfo_V2 c WITH (nolock)
					   ON item.category3sysno = c.category3sysno
				INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
					  ON  inventory.ItemSysNumber=item.sysno  
			WHERE    c.category1sysno =@C1SysNo
			         AND item.status = 1 					
					 AND item.CompanyCode=@CompanyCode
					 AND item.ProductType=0
					 AND (inventory.OnlineQty>0 OR inventory.ShiftQty>0)
			GROUP BY item.week1salescount,
					 item.sysno,
					 c.category2sysno,
					 item.ProductID,
					 item.category3sysno
			ORDER BY item.week1salescount DESC
			]]>
		</commandText>
	</dataCommand>

	<dataCommand name="GetSaleHightItemForC1PageByC2sysnoSingle" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
			SELECT  TOP @num 
	                item.sysno  productsysno,
					item.ProductID,
					Max(Isnull(item.week1salescount,0)) W1,
					c.category2sysno                    c2sysno,
					item.category3sysno                 c3sysno
			FROM     overseacontentmanagement.dbo.v_cm_itemcommoninfo_V2 item WITH (nolock)
				INNER JOIN overseacontentmanagement.dbo.v_cm_categoryinfo_V2 c WITH (nolock)
					   ON item.category3sysno = c.category3sysno
				INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
					  ON  inventory.ItemSysNumber=item.sysno  
			WHERE    c.category2sysno =@C2SysNo
			         AND item.status = 1 					
					 AND item.CompanyCode=@CompanyCode
					 AND item.ProductType=0
					 AND (inventory.OnlineQty>0 OR inventory.ShiftQty>0)
			GROUP BY item.week1salescount,
					 item.sysno,
					 c.category2sysno,
					 item.ProductID,
					 item.category3sysno
			ORDER BY item.week1salescount DESC
			]]>
		</commandText>
	</dataCommand>


	<dataCommand name="GetNewItem" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
		SELECT   TOP @num 
				Isnull(ps.firstonlinetime,0)   firstonlinetime,
				Datediff(DAY,Isnull(ps.firstonlinetime,0),Getdate()) Days,
				p.sysno  productsysno,
				p.ProductID,
				p.c3sysno,
				c.category2sysno  c2sysno
		FROM    overseacontentmanagement.dbo.v_cm_itemcommoninfo_V2 p WITH (nolock)
		 INNER JOIN overseacontentmanagement.dbo.V_CM_Product_Status ps WITH (nolock)
				   ON ps.productsysno = p.sysno
		 INNER JOIN overseacontentmanagement.dbo.v_cm_categoryinfo_V2 c WITH (nolock)
				   ON p.c3sysno = c.category3sysno
		 INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
				   ON  inventory.ItemSysNumber=p.sysno 
		WHERE   p.[status] = 1 
				AND c.category2sysno=@C2SysNo 
				AND p.CompanyCode=@CompanyCode
				AND p.ProductType=0
				AND (inventory.OnlineQty>0 OR inventory.ShiftQty>0)
		ORDER BY Days
			]]>
		</commandText>
	</dataCommand>

	<dataCommand name="GetNewItemForC1Page" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
		SELECT   TOP @num 
				Isnull(ps.firstonlinetime,0)   firstonlinetime,
				Datediff(DAY,Isnull(ps.firstonlinetime,0),Getdate()) Days,
				p.sysno  productsysno,
				p.ProductID,
				p.Category3SysNo  c3sysno,
				c.category2sysno  c2sysno
		FROM     overseacontentmanagement.dbo.v_cm_itemcommoninfo_V2  p WITH (nolock)
			INNER JOIN overseacontentmanagement.dbo.V_CM_Product_Status ps WITH (nolock)
				      ON ps.productsysno = p.sysno
			INNER JOIN overseacontentmanagement.dbo.v_cm_categoryinfo_V2 c WITH (nolock)
				      ON p.Category3SysNo = c.category3sysno
			INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
					  ON  inventory.ItemSysNumber=p.sysno  
		WHERE    p.[status] = 1  
		         AND p.ProductType=0
		         AND c.category1sysno=@C1SysNo			
				 AND NOT EXISTS   (SELECT * FROM [IPP3].[dbo].[f_splitstr]('@HasItemSysnolist',',')					
                                       WHERE CAST(F1 AS INT) =p.Sysno ) 
				 AND p.CompanyCode=@CompanyCode
				 AND (inventory.OnlineQty>0 OR inventory.ShiftQty>0)
		ORDER BY Days
			]]>
		</commandText>
	</dataCommand>

	<dataCommand name="GetNewItemForC1PageSingle" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[			
		SELECT  TOP @num 
				Isnull(ps.firstonlinetime,0)   firstonlinetime,
				Datediff(DAY,Isnull(ps.firstonlinetime,0),Getdate()) Days,
				p.sysno  productsysno,
				p.ProductID,
				p.category3sysno  c3sysno,
				c.category2sysno  c2sysno
		FROM   overseacontentmanagement.dbo.v_cm_itemcommoninfo_V2  p WITH (nolock)
			INNER JOIN overseacontentmanagement.dbo.V_CM_Product_Status ps WITH (nolock)
				  ON ps.productsysno = p.sysno
			INNER JOIN overseacontentmanagement.dbo.v_cm_categoryinfo_V2 c WITH (nolock)
				  ON p.category3sysno = c.category3sysno
		    INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
				  ON  inventory.ItemSysNumber=p.sysno 
		WHERE    p.[status] = 1  
		         AND p.ProductType=0
		         AND c.category1sysno=@C1SysNo				
				 AND p.CompanyCode=@CompanyCode
				 AND (inventory.OnlineQty>0 OR inventory.ShiftQty>0)
		ORDER BY Days
			]]>
		</commandText>
	</dataCommand>

  <dataCommand name="GetSpecialItemForC1PageSingle" database="OverseaECommerceManagement" commandType="Text">
    <commandText>
      <![CDATA[			
		SELECT  TOP @num 
				Isnull(ps.firstonlinetime,0)   firstonlinetime,
				Datediff(DAY,Isnull(ps.firstonlinetime,0),Getdate()) Days,
				p.sysno  productsysno,
				p.ProductID,
				p.category3sysno  c3sysno,
				c.category2sysno  c2sysno,
        p.CurrentPrice/p.basicprice as Discount
		FROM   overseacontentmanagement.dbo.v_cm_itemcommoninfo_V2  p WITH (nolock)
			INNER JOIN overseacontentmanagement.dbo.V_CM_Product_Status ps WITH (nolock)
				  ON ps.productsysno = p.sysno
			INNER JOIN overseacontentmanagement.dbo.v_cm_categoryinfo_V2 c WITH (nolock)
				  ON p.category3sysno = c.category3sysno
		    INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
				  ON  inventory.ItemSysNumber=p.sysno 
		WHERE    p.[status] = 1  
		         AND p.ProductType=0
		         AND c.category1sysno=@C1SysNo				
				 AND p.CompanyCode=@CompanyCode
				 AND (inventory.OnlineQty>0 OR inventory.ShiftQty>0)
         and p.basicprice is not null
				 and p.basicprice<>0
		ORDER BY Discount
			]]>
    </commandText>
  </dataCommand>

	<dataCommand name="GetNewItemForBrand" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[
				SELECT   TOP @num 
						Isnull(ps.firstonlinetime,0)   firstonlinetime
						,Datediff(DAY,Isnull(ps.firstonlinetime,0),Getdate()) Days
						,item.sysno  productsysno
						,item.ProductID
						,m.sysno  brandsysno
				FROM   overseacontentmanagement.dbo.v_cm_itemcommoninfo_V2  item  WITH(NOLOCK)
					INNER JOIN overseacontentmanagement.dbo.V_CM_Manufacturer  m  WITH(NOLOCK)
						ON  item.ManufacturerSysNo=m.sysno
					INNER JOIN overseacontentmanagement.dbo.V_CM_Product_Status  ps WITH(NOLOCK)
						ON ps.ProductSysNo=item.sysno
					INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
						ON  inventory.ItemSysNumber=item.sysno  
				WHERE    item.[status] = 1 
			             AND item.ProductType=0
						 AND  m.sysno=@BrandSysNo 
						 AND NOT EXISTS   (SELECT * FROM [IPP3].[dbo].[f_splitstr]('@HasItemSysnolist',',')					
                                       WHERE CAST(F1 AS INT) =item.Sysno ) 
						 AND item.CompanyCode=@CompanyCode
						 AND (inventory.OnlineQty>0 or inventory.ShiftQty>0)
				ORDER BY Days 
			]]>
		</commandText>
	</dataCommand>

	<dataCommand name="GetNewItemForBrandSingle" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[
				SELECT   TOP @num 
						Isnull(ps.firstonlinetime,0)   firstonlinetime
						,Datediff(DAY,Isnull(ps.firstonlinetime,0),Getdate()) Days
						,item.sysno  productsysno
						,item.ProductID
						,m.sysno  brandsysno
				FROM     overseacontentmanagement.dbo.v_cm_itemcommoninfo_V2  item  WITH(NOLOCK)
				INNER JOIN overseacontentmanagement.dbo.V_CM_Manufacturer  m  WITH(NOLOCK)
						ON  item.ManufacturerSysNo=m.sysno
				INNER JOIN overseacontentmanagement.dbo.V_CM_Product_Status  ps WITH(NOLOCK)
						ON ps.ProductSysNo=item.sysno
				INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
						ON  inventory.ItemSysNumber=item.sysno 
				WHERE    item.[status] = 1 
				         AND item.ProductType=0
						 AND  m.sysno=@BrandSysNo 						
						 AND item.CompanyCode=@CompanyCode
						 AND (inventory.OnlineQty>0 or inventory.ShiftQty>0)
				ORDER BY Days 
			]]>
		</commandText>
	</dataCommand>

	<dataCommand name="CheckBrandItemNum" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[
				SELECT   count(item.sysno)
				FROM     overseacontentmanagement.dbo.v_cm_itemcommoninfo_V2  item  WITH(NOLOCK)
				INNER JOIN overseacontentmanagement.dbo.V_CM_Manufacturer  m  WITH(NOLOCK)
						ON  item.ManufacturerSysNo=m.sysno		
				INNER JOIN OverseaInventoryManagement.dbo.V_INM_Inventory  inventory  WITH(NOLOCK)
						ON  inventory.ItemSysNumber=item.sysno 
				WHERE    item.[status] = 1 
				         AND item.ProductType=0
						 AND  m.sysno=@BrandSysNo 						
						 AND item.CompanyCode=@CompanyCode	
			]]>
		</commandText>
	</dataCommand>

	<dataCommand name="CheckC2ItemNumOnC1" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[
		SELECT distinct [Category2Sysno]   C2SysNo
		FROM [OverseaContentManagement].[dbo].[V_CM_CategoryInfo] WITH(NOLOCK)
		WHERE [Category2Status]=0 
		      AND Category1Sysno=@Category1Sysno
		      AND CompanyCode=@CompanyCode			 
			]]>
		</commandText>
	</dataCommand>

	<dataCommand name="ClearTableOnLinelist" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[
		DELETE TOP(5000) OverseaECommerceManagement.[dbo].[OnlineList]
	    WHERE [Status]='D' AND  [InUser]='System'  
		      AND  Datediff(DAY,InDate,Getdate()) >@Day
		      AND CompanyCode=@CompanyCode			 
			]]>
		</commandText>
	</dataCommand>

	<dataCommand name="SendMailInfo" database="OverseaECommerceManagement" commandType="Text">
		<commandText>
			<![CDATA[	
	INSERT INTO [MailDB].[dbo].[AsyncEmail_Internal]
           ([MailAddress]
           ,[CCMailAddress]         
           ,[MailSubject]
           ,[MailBody]
           ,[Status]
           ,[Priority]      
           ,[CreateTime]
           ,[CompanyCode]
           ,[LanguageCode]
           ,[StoreCompanyCode])
     VALUES
           (@MailAddress
           ,@CCMailAddress
           ,@MailSubject
           ,@MailBody
           ,0
           ,1
           ,getdate()
           ,@CompanyCode
           ,@LanguageCode
           ,@CompanyCode)
			 ]]>
		</commandText>
		<parameters>
			<param name="@MailAddress" dbType="String" />
			<param name="@CCMailAddress" dbType="String" />
			<param name="@MailSubject" dbType="String" />
			<param name="@MailBody" dbType="String" />
			<param name="@CompanyCode" dbType="String"/>
			<param name="@LanguageCode" dbType="String"/>
		</parameters>
	</dataCommand>

</dataOperations>
