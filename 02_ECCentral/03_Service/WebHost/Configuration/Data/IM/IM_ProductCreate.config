<?xml version="1.0" encoding="utf-8" ?>
<dataOperations xmlns="http://oversea.newegg.com/DataOperation">  

  <dataCommand name="IsExistsSameProduct" database="IMService" commandType="Text">
    <commandText>
      <![CDATA[
      SELECT COUNT(1) 
      FROM OverseaContentManagement.dbo.ProductGroupInfo WITH(NOLOCK)
      WHERE C3SysNo = @C3SysNo
        AND BrandSysno = @BrandSysNo
        AND ProductModel = @ProductModel
      ]]>
    </commandText>
    <parameters>            
      <param name="@C3SysNo" dbType="Int32" />
      <param name="@BrandSysNo" dbType="Int32" />
      <param name="@ProductModel" dbType="String" />
    </parameters>
  </dataCommand>

  <dataCommand name="IsExistsSameProductNoGroup" database="IMService" commandType="Text">
    <commandText>
      <![CDATA[        
      SELECT COUNT(1) 
      FROM ipp3.dbo.Product WITH(NOLOCK)
      WHERE C3SysNo = @C3SysNo
        AND BrandSysNo = @BrandSysNo
        AND ProductMode = @ProductModel
      ]]>
    </commandText>
    <parameters>
      <param name="@C3SysNo" dbType="Int32" />
      <param name="@BrandSysNo" dbType="Int32" />
      <param name="@ProductModel" dbType="String" />
    </parameters>
  </dataCommand>

  <dataCommand name="GetCategory3LargeFlag" database="IMService"  commandType="Text">
    <commandText>
      <![CDATA[
  DECLARE @flag CHAR(1)

  SET @flag =(SELECT TOP 1 LargeFlag 
        FROM IPP3.dbo.Category3 WITH(NOLOCK) where SysNo=@C3SysNo AND CompanyCode = @CompanyCode)                   

  IF(@flag='S')
      SET @LargeFlag=0
  ELSE IF(@flag='L')
      SET @LargeFlag=1
  ELSE
  SET @LargeFlag=-999
		]]>
    </commandText>
    <parameters>
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" size="50"/>
      <param name="@C3SysNo" dbType="Int32" />
      <param name="@LargeFlag" dbType="Int32" size="5" direction="Output" />
    </parameters>
  </dataCommand>

  <dataCommand name="CreateSingleProductCommonInfo" database="IMService" commandType="Text">
    <!--定义SQL语句-->
    <commandText>
      <![CDATA[
      
    IF EXISTS(SELECT TOP 1 1 FROM OverseaContentManagement.dbo.ProductCommonInfo WITH(NOLOCK) 
              WHERE CommonSKUNumber = @CommonSKUNumber 
                AND CompanyCode = @CompanyCode)
    BEGIN
      SET @SysNo = -1
    END
    ELSE
    BEGIN        

        INSERT INTO OverseaContentManagement.dbo.ProductCommonInfo
                   (CommonSKUNumber
                   ,ProductGroupSysno
                   ,UPCCode
                   ,ProductName
                   ,BriefName
                   ,Keywords
                   ,PMUserSysNo
                   ,ProductModel
                   ,ProductType
                   ,IsTakePictures
                   ,CompanyBelongs
                   ,OnlyForRank
                   ,PicNumber
                   ,IsOfferInvoice
                   ,IsLarge
                   ,InDate
                   ,InUser
                   ,CompanyCode
                   ,StoreCompanyCode
                   ,LanguageCode
                   ,HostWarrantyDay
                   ,PartWarrantyDay
                   ,Warranty
                   ,ServicePhone
                   ,ServiceInfo
                   ,Weight
                   ,Length
                   ,Width
                   ,Height
                   ,MinPackNumber
                   ,Note
                   ,Attention
                   ,ProductLink
                   ,PackageList
                   ,ProductDesc
                   )
             VALUES
                   (@CommonSKUNumber
                   ,@ProductGroupSysno
                   ,@UPCCode
                   ,@ProductName
                   ,@BriefName
                   ,@Keywords
                   ,@PMUserSysNo
                   ,@ProductModel
                   ,@ProductType
                   ,@IsTakePictures
                   ,@CompanyBelongs
                   ,@OnlyForRank
                   ,@PicNumber
                   ,@IsOfferInvoice
                   ,@IsLarge
                   ,GETDATE()
                   ,@InUser
                   ,@CompanyCode
                   ,@StoreCompanyCode
                   ,@LanguageCode
                   ,@HostWarrantyDay
                   ,@PartWarrantyDay
                   ,@Warranty
                   ,@ServicePhone
                   ,@ServiceInfo
                   ,@Weight
                   ,@Length
                   ,@Width
                   ,@Height
                   ,@MinPackNumber
                   ,@Note
                   ,@Attention
                   ,@ProductLink
                   ,@PackageList 
                   ,@ProductDesc
                   )      
                   
       SELECT @SysNo = SCOPE_IDENTITY();
                
    END
	  ]]>
    </commandText>
    <parameters>
      <param name="@CommonSKUNumber" dbType="String" />
      <param name="@ProductGroupSysno" dbType="Int32" />
      <param name="@UPCCode" dbType="String" />
      <param name="@ProductName" dbType="String" />
      <param name="@BriefName" dbType="String" />
      <param name="@Keywords" dbType="String" />
      <param name="@PMUserSysNo" dbType="Int32" />
      <param name="@ProductModel" dbType="String" />
      <param name="@ProductType" dbType="String" />
      <param name="@IsTakePictures" dbType="String" />
      <param name="@CompanyBelongs" dbType="String" />
      <param name="@OnlyForRank" dbType="Int32" />
      <param name="@PicNumber" dbType="Int32" />
      <param name="@IsOfferInvoice" dbType="String" />
      <param name="@IsLarge" dbType="String" />
      <param name="@InUser" dbType="String" />
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" size="50"/>
      <param name="@StoreCompanyCode" dbType="AnsiStringFixedLength" size="50"/>
      <param name="@LanguageCode" dbType="AnsiStringFixedLength" size="5" />
      <param name="@HostWarrantyDay" dbType="Int32" />
      <param name="@PartWarrantyDay" dbType="Int32" />
      <param name="@Warranty" dbType="String" />
      <param name="@ServicePhone" dbType="String" />
      <param name="@ServiceInfo" dbType="String" />
      <param name="@Weight" dbType="Int32" />
      <param name="@Length" dbType="Decimal" />
      <param name="@Width" dbType="Decimal" />
      <param name="@Height" dbType="Decimal" />
      <param name="@MinPackNumber" dbType="Int32" />
      <param name="@Note" dbType="String" />
      <param name="@Attention" dbType="String" />
      <param name="@ProductLink" dbType="String" />
      <param name="@PackageList" dbType="String" />
      <param name="@ProductDesc" dbType="String" />
      <param name="@SysNo" dbType="Int32" size="10" direction="Output"/>
    </parameters>
  </dataCommand>

  <dataCommand name="CreateProductCommonInfo" database="IMService" commandType="Text">
    <!--定义SQL语句-->
    <commandText>
      <![CDATA[
      
    IF EXISTS(SELECT TOP 1 1 FROM OverseaContentManagement.dbo.ProductCommonInfo WITH(NOLOCK) 
              WHERE CommonSKUNumber = @CommonSKUNumber 
                AND CompanyCode = @CompanyCode)
    BEGIN
      SET @SysNo = -1
    END
    ELSE
    BEGIN        

        INSERT INTO OverseaContentManagement.dbo.ProductCommonInfo
                   (CommonSKUNumber
                   ,ProductGroupSysno
                   ,UPCCode
                   ,ProductName
                   ,BriefName
                   ,Keywords
                   ,PMUserSysNo
                   ,ProductModel
                   ,ProductType
                   ,IsTakePictures
                   ,CompanyBelongs
                   ,OnlyForRank
                   ,PicNumber
                   ,IsOfferInvoice
                   ,IsLarge
                   ,InDate
                   ,InUser
                   ,CompanyCode
                   ,StoreCompanyCode
                   ,LanguageCode
                   ,HostWarrantyDay
                   ,PartWarrantyDay
                   ,Warranty
                   ,ServicePhone
                   ,ServiceInfo
                   ,Weight
                   ,Length
                   ,Width
                   ,Height
                   ,MinPackNumber
                   ,Note
                   ,Attention
                   ,ProductLink
                   ,PackageList
                   ,ProductDesc
                   )
             VALUES
                   (@CommonSKUNumber
                   ,@ProductGroupSysno
                   ,@UPCCode
                   ,@ProductName
                   ,@BriefName
                   ,@Keywords
                   ,@PMUserSysNo
                   ,@ProductModel
                   ,@ProductType
                   ,@IsTakePictures
                   ,@CompanyBelongs
                   ,@OnlyForRank
                   ,@PicNumber
                   ,@IsOfferInvoice
                   ,@IsLarge
                   ,GETDATE()
                   ,@InUser
                   ,@CompanyCode
                   ,@StoreCompanyCode
                   ,@LanguageCode
                   ,@HostWarrantyDay
                   ,@PartWarrantyDay
                   ,@Warranty
                   ,@ServicePhone
                   ,@ServiceInfo
                   ,@Weight
                   ,@Length
                   ,@Width
                   ,@Height
                   ,@MinPackNumber
                   ,@Note
                   ,@Attention
                   ,@ProductLink
                   ,@PackageList 
                   ,@ProductDesc
                   )      
                   
       SELECT @SysNo = SCOPE_IDENTITY();
                
    END
	  ]]>
    </commandText>
    <parameters>
      <param name="@CommonSKUNumber" dbType="String" />
      <param name="@ProductGroupSysno" dbType="Int32" />
      <param name="@UPCCode" dbType="String" />
      <param name="@ProductName" dbType="String" />
      <param name="@BriefName" dbType="String" />
      <param name="@Keywords" dbType="String" />
      <param name="@PMUserSysNo" dbType="Int32" />
      <param name="@ProductModel" dbType="String" />
      <param name="@ProductType" dbType="String" />
      <param name="@IsTakePictures" dbType="String" />
      <param name="@CompanyBelongs" dbType="String" />
      <param name="@OnlyForRank" dbType="Int32" />
      <param name="@PicNumber" dbType="Int32" />
      <param name="@IsOfferInvoice" dbType="String" />
      <param name="@IsLarge" dbType="String" />
      <param name="@InUser" dbType="String" />
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" size="50"/>
      <param name="@StoreCompanyCode" dbType="AnsiStringFixedLength" size="50"/>
      <param name="@LanguageCode" dbType="AnsiStringFixedLength" size="5" />
      <param name="@HostWarrantyDay" dbType="Int32" />
      <param name="@PartWarrantyDay" dbType="Int32" />
      <param name="@Warranty" dbType="String" />
      <param name="@ServicePhone" dbType="String" />
      <param name="@ServiceInfo" dbType="String" />
      <param name="@Weight" dbType="Int32" />
      <param name="@Length" dbType="Decimal" />
      <param name="@Width" dbType="Decimal" />
      <param name="@Height" dbType="Decimal" />
      <param name="@MinPackNumber" dbType="Int32" />
      <param name="@Note" dbType="String" />
      <param name="@Attention" dbType="String" />
      <param name="@ProductLink" dbType="String" />
      <param name="@PackageList" dbType="String" />
      <param name="@ProductDesc" dbType="String" />
      <param name="@SysNo" dbType="Int32" size="10" direction="Output"/>
    </parameters>
  </dataCommand>

  <dataCommand name="CreateProductCommonInfoEx" database="IMService" commandType="Text">
    <!--定义SQL语句-->
    <commandText>
      <![CDATA[
        INSERT INTO [OverseaContentManagement].[dbo].[ProductCommonInfo_Ex]
             ([SysNo]
             ,[Performance]
             ,[ProductDescLong]
             ,[ProductPhotoDesc])
        VALUES
             (@SysNo
             ,@Performance
             ,@ProductDescLong
             ,@ProductPhotoDesc)

	  ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />
      <param name="@Performance" dbType="String" />
      <param name="@ProductDescLong" dbType="String" />
      <param name="@ProductPhotoDesc" dbType="String" />
    </parameters>
  </dataCommand>

  <dataCommand name="CreateProductCommonInfoStatus" database="IMService" commandType="Text">
    <!--定义SQL语句-->
    <commandText>
      <![CDATA[
        INSERT INTO OverseaContentManagement.dbo.ProductCommonInfo_Status
                   (CommonSKUNumber
                   ,IsChangeStyleWithTemplate
                   ,IsExtendWarrantyDisuse
                   ,IsBasicInformationCorrect
                   ,IsAccessoriesShow
                   ,IsAccessoriesCorrect
                   ,IsVirtualPic
                   ,IsPictureCorrect
                   ,IsWarrantyCorrect
                   ,IsWarrantyShow
                   ,IsWeightCorrect
                  )
             VALUES
                   (@CommonSKUNumber
                   ,'Y'
                   ,'N'
                   ,'N'
                   ,'N'
                   ,'Y'
                   ,'N'
                   ,'N'
                   ,'N'
                   ,'Y'
                   ,'N')            

	  ]]>
    </commandText>
    <parameters>
      <param name="@CommonSKUNumber" dbType="String" />
    </parameters>
  </dataCommand>

  <dataCommand name="CreateProductCommonInfoProperty" database="IMService" commandType="Text">
    <!--定义SQL语句-->
    <commandText>
      <![CDATA[
        INSERT INTO OverseaContentManagement.dbo.ProductCommonInfo_Property
                   (CommonSKUNumber
                   ,GroupSysno
                   ,PropertySysno
                   ,ValueSysno
                   ,ManualInput
                   ,EditDate
                   ,EditUser
                   ,CompanyCode
                   ,LanguageCode
                   ,StoreCompanyCode)
             VALUES
                   (@CommonSKUNumber
                   ,@GroupSysno
                   ,@PropertySysno
                   ,@ValueSysno
                   ,@ManualInput
                   ,GETDATE()
                   ,@EditUser
                   ,@CompanyCode
                   ,@LanguageCode
                   ,@StoreCompanyCode)                  

	  ]]>
    </commandText>
    <parameters>
      <param name="@CommonSKUNumber" dbType="String" />
      <param name="@GroupSysno" dbType="Int32" />
      <param name="@PropertySysno" dbType="Int32" />
      <param name="@ValueSysno" dbType="Int32" />
      <param name="@ManualInput" dbType="String" />
      <param name="@EditUser" dbType="String" />
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" size="50"/>
      <param name="@StoreCompanyCode" dbType="AnsiStringFixedLength" size="50"/>
      <param name="@LanguageCode" dbType="AnsiStringFixedLength" size="5" />
    </parameters>
  </dataCommand>
  
  <dataCommand name="CreateProductSequence" database="IMService"  commandType="Text">
    <commandText>
      <![CDATA[
		INSERT INTO IPP3.dbo.Product_Sequence
		(
			CreateTime
		)
		VALUES
		(
			GetDate()
		)
		SELECT @SysNo = SCOPE_IDENTITY()
		]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" size="10" direction="Output"/>
    </parameters>
  </dataCommand>

  <dataCommand name="CreateSingleProduct" database="IMService"  commandType="Text">
    <commandText>
      <![CDATA[
    IF EXISTS(SELECT TOP 1 1 FROM IPP3.dbo.Product WITH(NOLOCK) WHERE ProductID = @ProductID AND CompanyCode = @CompanyCode)
    BEGIN
      SET @Flag = -1
    END
    ELSE IF EXISTS(SELECT TOP 1 1 FROM IPP3.dbo.Product WITH(NOLOCK) WHERE SysNo = @SysNo AND CompanyCode = @CompanyCode)
    BEGIN
      SET @Flag = -2
    END
    ELSE
    BEGIN
      SET @Flag = 0
		INSERT INTO IPP3.dbo.Product
		(
			SysNo,
			ProductID,
			ProductMode,
			ProductType,
			ProductName,
			ProductDesc,
      ProductDescLong,
			Performance,
			Warranty,
			PackageList,
			Weight,
			C3SysNo,
			ManufacturerSysNo,
			ProductLink,
			MultiPicNum,
			PMUserSysNo,
			PPMUserSysNo,
			CreateUserSysNo,
			CreateTime,
			Attention,
			Note,
			Status,
			IsLarge,
			BriefName,
      RemarkCount,
			RemarkScore,
			IsConsign,
			PromotionTitle,
			ProductTitle,
			ProductLine,
			BriefNameAddition,
      BrandSysNo,
      CompanyCode,
      ProductCommonInfoSysno,
      MerchantSysNo,
      BarCode
      
		)
		VALUES
		(
			@SysNo,
			@ProductID,
			@ProductMode,
			@ProductType,
			@ProductName,
			@ProductDesc,
      @ProductDescLong,
			NULL,
			@Warranty,
			@PackageList,
			@Weight,
			@C3SysNo,
			@ManufacturerSysNo,
			@ProductLink,
			@MultiPicNum,
			@PMUserSysNo,
			@PPMUserSysNo,
			@CreateUserSysNo,
			GetDate(),
			@Attention,
			@Note,
			@Status,
			@IsLarge,
			@BriefName,
      @RemarkCount,
			@RemarkScore,
			@IsConsign,
			@PromotionTitle,
			@ProductTitle,
			@ProductLine,
			@BriefNameAddition,
      @BrandSysNo,
      @CompanyCode,
      @ProductCommonInfoSysno,
      @MerchantSysNo,
      @BarCode
		)
    END
		]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />
      <param name="@ProductID" dbType="String" size="20"/>
      <param name="@ProductMode" dbType="String" size="100"/>
      <param name="@ProductType" dbType="Int32"/>
      <param name="@ProductName" dbType="String" size="200"/>
      <param name="@ProductDesc" dbType="String" size="2000"/>
      <param name="@ProductDescLong" dbType="String" size="2000"/>
      <param name="@Performance" dbType="String"/>
      <param name="@Warranty" dbType="String" size="200"/>
      <param name="@PackageList" dbType="String" size="500"/>
      <param name="@Weight" dbType="Int32"/>
      <param name="@C3SysNo" dbType="Int32"/>
      <param name="@ManufacturerSysNo" dbType="Int32"/>
      <param name="@ProductLink" dbType="String" size="200"/>
      <param name="@MultiPicNum" dbType="Int32"/>
      <param name="@PMUserSysNo" dbType="Int32"/>
      <param name="@PPMUserSysNo" dbType="Int32"/>
      <param name="@CreateUserSysNo" dbType="Int32"/>
      <param name="@Attention" dbType="String" size="4000"/>
      <param name="@Note" dbType="String" size="500"/>
      <param name="@Status" dbType="Int32"/>
      <param name="@IsLarge" dbType="Int32"/>
      <param name="@BriefName" dbType="String" size="100"/>
      <param name="@RemarkCount" dbType="Int32"/>
      <param name="@RemarkScore" dbType="Int32"/>
      <param name="@IsConsign" dbType="Int32"/>
      <param name="@PromotionTitle" dbType="String" size="200"/>
      <param name="@ProductTitle" dbType="String" size="200"/>
      <param name="@ProductLine" dbType="String" size="100"/>
      <param name="@BriefNameAddition" dbType="String" size="100"/>
      <param name="@BrandSysNo" dbType="Int32"/>
      <param name="@Flag" dbType="Int32" size="10" direction="Output"/>
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" size="50"/>
      <param name="@ProductCommonInfoSysno" dbType="Int32"/>
      <param name="@MerchantSysNo" dbType="Int32"/>
      <param name="@BarCode" dbType="String" size="30"/>
    </parameters>
  </dataCommand>

  <dataCommand name="CreateSingleProductEx" database="IMService"  commandType="Text">
    <commandText>
      <![CDATA[
      IF EXISTS (
					  SELECT TOP 1 1 FROM
					  IPP3.dbo.Product_Ex WITH(NOLOCK)
					  WHERE SysNo	= @SysNo AND CompanyCode = @CompanyCode
					  )
				BEGIN
          SET @Flag = -1
				END
			ELSE
				BEGIN
          SET @Flag = 0
		      INSERT INTO IPP3.dbo.Product_Ex
		      (
			      SysNo,
			      IsPermitRefund,
			      IsOfferValueAddedInvoice,
			      DMSValue,
			      SaleDays,
			      CompanyProduct,
			      PreviousProductSysNo,
			      BuyOnlyForRank,
			      IsInstalmentProduct,
			      InstalmentPhase,
			      NoInventoryDays,
			      Keywords,
			      IsTakePictures,
			      ProductColor,
			      IsChangeStylewithTemplate,
            CompanyCode,
            HostWarrantyDay,
            PartWarrantyDay,
            IsAutoShowSecHand,
            MinPackNumber
		      )
		      VALUES
		      (
			      @SysNo,
			      @IsPermitRefund,
			      @IsOfferValueAddedInvoice,
			      @DMSValue,
			      @SaleDays,
			      @CompanyProduct,
            CASE WHEN @PreviousProductSysNo = 0 THEN NULL ELSE @PreviousProductSysNo END,
			      @BuyOnlyForRank,
			      @IsInstalmentProduct,
			      @InstalmentPhase,
			      @NoInventoryDays,
			      @Keywords,
			      @IsTakePictures,
			      @ProductColor,
			      @IsChangeStylewithTemplate,
            @CompanyCode,
            @HostWarrantyDay,
            @PartWarrantyDay,
            'A',
            CASE WHEN @MinPackNumber = 0 THEN NULL ELSE @MinPackNumber END
		      )
          
           INSERT INTO [OverseaContentManagement].[dbo].[ProductPageKeywords]
               ([ProductSysNo]
               ,[InDate]
               ,[InUser]
               ,[EditDate]
               ,[EditUser]
               ,[CompanyCode]
               )
            VALUES
               (@SysNo
               ,GETDATE()
               ,@EditUser
               ,GETDATE()
               ,@EditUser
               ,@CompanyCode
			        ) 
      END
		]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32"/>
      <param name="@IsPermitRefund" dbType="Int32"/>
      <param name="@IsOfferValueAddedInvoice" dbType="Int32"/>
      <param name="@DMSValue" dbType="Decimal" size="19"/>
      <param name="@SaleDays" dbType="Decimal" size="19"/>
      <param name="@CompanyProduct" dbType="Int32"/>
      <param name="@PreviousProductSysNo" dbType="Int32"/>
      <param name="@BuyOnlyForRank" dbType="Int32"/>
      <param name="@IsInstalmentProduct" dbType="Int32"/>
      <param name="@InstalmentPhase" dbType="Int32"/>
      <param name="@NoInventoryDays" dbType="Int32"/>
      <param name="@Keywords" dbType="String" size="400"/>
      <param name="@IsTakePictures" dbType="Int32"/>
      <param name="@ProductColor" dbType="String" size="20"/>
      <param name="@IsChangeStylewithTemplate" dbType="Int32"/>
      <param name="@Flag" dbType="Int32" size="10" direction="Output"/>
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" size="50" />
      <param name="@HostWarrantyDay" dbType="Int32"/>
      <param name="@PartWarrantyDay" dbType="Int32"/>
      <param name="@EditUser" dbType="String"/>
      <param name="@MinPackNumber" dbType="Int32"/>
    </parameters>
  </dataCommand>

  <dataCommand name="CreateSingleProductStatus" database="IMService"  commandType="Text">
    <commandText>
      <![CDATA[
		INSERT INTO IPP3.dbo.Product_Status
		(
			ProductSysNo,
			InfoStatus,
			InfoUserSysNo,
      AllowStatus,
      PicStatus,
      PriceStatus,
      WarrantyStatus,
      WeightStatus,
      VirtualPicStatus,
      AccessoryStatus,
      CompanyCode 
		)
		VALUES
		(
			@ProductSysNo,
			@InfoStatus,
			@InfoUserSysNo,
      @AllowStatus,
      @PicStatus,
      @PriceStatus,
      @WarrantyStatus,
      @WeightStatus,
      @VirtualPicStatus,
      1,
      @CompanyCode
		)
		SELECT @SysNo = SCOPE_IDENTITY()
		]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" size="10" direction="Output"/>
      <param name="@ProductSysNo" dbType="Int32"/>
      <param name="@InfoStatus" dbType="Int32"/>
      <param name="@InfoUserSysNo" dbType="Int32"/>
      <param name="@AllowStatus" dbType="Int32"/>
      <param name="@PicStatus" dbType="Int32"/>
      <param name="@PriceStatus" dbType="Int32"/>
      <param name="@WarrantyStatus" dbType="Int32"/>
      <param name="@WeightStatus" dbType="Int32"/>
      <param name="@VirtualPicStatus" dbType="Int32"/>
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" size="50"/>
    </parameters>
  </dataCommand>

  <dataCommand name="CreateSingleProductInitPrice" database="IMService"  commandType="Text">
    <commandText>
      <![CDATA[
		INSERT INTO IPP3.dbo.Product_Price
		(
			ProductSysNo,
			BasicPrice,
			CurrentPrice,
			UnitCost,
			Discount,
			PointType,
			IsWholeSale,
			MaxPerOrder,
			Q1,
			P1,
			Q2,
			P2,
			Q3,
			P3,
			CashRebate,
			Point,
			ClearanceSale,
			CreateTime,
			UnitCostWithoutTax,
      CompanyCode,
      VirtualPrice,
      IsUseAlipayVipPrice,
      AlipayVipPrice
		)
		VALUES
		(
			@ProductSysNo,
			@BasicPrice,
			@CurrentPrice,
			@UnitCost,
			@Discount,
			@PointType,
			@IsWholeSale,
			@MaxPerOrder,
      (CASE WHEN @Q1=-999999 THEN NULL ELSE @Q1 END),
			(CASE WHEN @P1=-999999 THEN NULL ELSE @P1 END),
			(CASE WHEN @Q2=-999999 THEN NULL ELSE @Q2 END),
			(CASE WHEN @P2=-999999 THEN NULL ELSE @P2 END),
			(CASE WHEN @Q3=-999999 THEN NULL ELSE @Q3 END),
			(CASE WHEN @P3=-999999 THEN NULL ELSE @P3 END),
			@CashRebate,
			@Point,
			@ClearanceSale,
			GetDate(),
			@UnitCostWithoutTax,
      @CompanyCode,
      @VirtualPrice,
      'N',
      NULL      
		)
		SELECT @SysNo = SCOPE_IDENTITY()
		]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" size="10" direction="Output"/>
      <param name="@ProductSysNo" dbType="Int32"/>
      <param name="@BasicPrice" dbType="Decimal" size="19"/>
      <param name="@CurrentPrice" dbType="Decimal" size="19"/>
      <param name="@UnitCost" dbType="Decimal" size="19"/>
      <param name="@Discount" dbType="Decimal" size="19"/>
      <param name="@PointType" dbType="Int32"/>
      <param name="@IsWholeSale" dbType="Int32"/>
      <param name="@MaxPerOrder" dbType="Int32"/>
      <param name="@Q1" dbType="Int32"/>
      <param name="@P1" dbType="Decimal" size="19"/>
      <param name="@Q2" dbType="Int32"/>
      <param name="@P2" dbType="Decimal" size="19"/>
      <param name="@Q3" dbType="Int32"/>
      <param name="@P3" dbType="Decimal" size="19"/>
      <param name="@CashRebate" dbType="Decimal" size="19"/>
      <param name="@Point" dbType="Int32"/>
      <param name="@ClearanceSale" dbType="Int32"/>
      <param name="@UnitCostWithoutTax" dbType="Decimal" size="19"/>
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" size="50"/>
      <param name="@VirtualPrice" dbType="Decimal"/>
    </parameters>
  </dataCommand>

  <dataCommand name="CreateSingleProductVirtualPriceLog" database="IMService"  commandType="Text">
    <commandText>
      <![CDATA[
    
      INSERT INTO [OverseaContentManagement].[dbo].[ProductVirtualPricePricechangeLog]
             ([ProductSysno]
             ,[NewVirtualPrice]
             ,[OldVirtualPrice]
             ,[Note]
             ,[OptIP]
             ,[CreateUser]
             ,[CreateDate]
             )
       VALUES
             (@ProductSysno
             ,@VirtualPrice
             ,@OldVirtualPrice
             ,''
             ,@OptIP
             ,@CreateUser
             ,GETDATE()
             )
		]]>
    </commandText>
    <parameters>
      <param name="@ProductSysNo" dbType="Int32" />
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" size="50"/>
      <param name="@VirtualPrice" dbType="Decimal" size="19" />
      <param name="@OldVirtualPrice" dbType="Decimal" size="19" />
      <param name="@OptIP" dbType="String" size="19" />
      <param name="@CreateUser" dbType="String"/>
    </parameters>
  </dataCommand>

  <dataCommand name="CreatePIMProductProperty" database="IMService" commandType="Text">
    <commandText>
      <![CDATA[

        INSERT INTO  PMDB.dbo.PIM_ProductProperty        
          (ProductSysNo
          ,GroupSysNo
          ,PropertySysNo
          ,ValueSysNo
          ,ManualInput 
          ,IsActive
          ,LastEditUserSysNo
          ,LastEditTime
          ,CompanyCode
          ,LanguageCode
          ,StoreCompanyCode)        
        VALUES        
          (@ProductSysNo
          ,@GroupSysNo
          ,@PropertySysNo
          ,@ValueSysNo
          ,@ManualInput 
          ,1
          ,@LastEditUserSysNo
          ,GETDATE()
          ,@CompanyCode
          ,@LanguageCode
          ,@StoreCompanyCode)      

    ]]>
    </commandText>
    <parameters>
      <param name="@ProductSysNo" dbType="Int32" />
      <param name="@GroupSysNo" dbType="Int32" />
      <param name="@PropertySysNo" dbType="Int32" />
      <param name="@ValueSysNo" dbType="Int32" />
      <param name="@ManualInput" dbType="String" />
      <param name="@LastEditUserSysNo" dbType="Int32" />
      <param name="@CompanyCode" dbType="String" />
      <param name="@LanguageCode" dbType="String" />
      <param name="@StoreCompanyCode" dbType="String" />
    </parameters>
  </dataCommand>

  <dataCommand name="CreateProductDimensions" database="IMService"  commandType="Text">
    <commandText>
      <![CDATA[
    
      INSERT INTO [OverseaContentManagement].[dbo].[Product_Dimensions]
           ([ProductSysNo]
           ,[Length]
           ,[Width]
           ,[Height]
           ,[InDate]
           ,[InUser]
           ,[EditDate]
           ,[EditUser]
           ,[CompanyCode]
           ,[StoreCompanyCode]
           ,[CountryCode]
           ,[LanguageCode]
           ,[Status])
     VALUES
           (@ProductSysNo
           ,@Length
           ,@Width
           ,@Height
           ,getdate()
           ,@InUser
           ,getdate()
           ,@InUser
           ,@CompanyCode
           ,null
           ,null
           ,'zh-CN'
           ,'A')
		]]>
    </commandText>
    <parameters>
      <param name="@ProductSysNo" dbType="Int32" />
      <param name="@Length" dbType="Decimal" size="19" />
      <param name="@Width" dbType="Decimal" size="19" />
      <param name="@Height" dbType="Decimal" size="19" />
      <param name="@InUser" dbType="String"/>
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" size="50"/>
    </parameters>
  </dataCommand>
  
  <dataCommand name="GetGroupInfoDataFeed" database="IMService"  commandType="Text">
    <commandText>
      <![CDATA[
    
      SELECT pgi.ProductName
	          ,pgi.BrandSysno
	          ,pgi.C3SysNo
	          ,pgi.ProductModel
	          ,b.ManufacturerSysNo
      FROM  OverseaContentManagement.dbo.ProductGroupInfo pgi
      INNER JOIN OverseaContentManagement.dbo.Brand b
        ON pgi.BrandSysno = b.SysNo
      WHERE pgi.SysNo = @SysNo
        AND pgi.CompanyCode = @CompanyCode
		]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />      
    </parameters>
  </dataCommand>

  <dataCommand name="CreateDataFeedProductGroupInfo" database="IMService" commandType="Text">
    <!--定义SQL语句-->
    <commandText>
      <![CDATA[
        INSERT INTO OverseaContentManagement.dbo.ProductGroupInfo
                   (ProductName
                   ,BrandSysno
                   ,C3SysNo
                   ,ProductModel
                   ,Type
                   ,InDate
                   ,InUser
                   ,CompanyCode
                   ,StoreCompanyCode
                   ,LanguageCode)
             VALUES
                   (@ProductName
                   ,@BrandSysno
                   ,@C3SysNo
                   ,@ProductModel
                   ,@Type
                   ,GETDATE()
                   ,@InUser
                   ,@CompanyCode
                   ,@StoreCompanyCode
                   ,@LanguageCode)
                   
       SELECT @SysNo = SCOPE_IDENTITY();
       
	  ]]>
    </commandText>
    <parameters>
      <param name="@ProductName" dbType="String" />
      <param name="@BrandSysno" dbType="Int32" />
      <param name="@C3SysNo" dbType="Int32" />
      <param name="@ProductModel" dbType="String" />
      <param name="@Type" dbType="String" />
      <param name="@InUser" dbType="String" />
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" size="50"/>
      <param name="@StoreCompanyCode" dbType="AnsiStringFixedLength" size="50"/>
      <param name="@LanguageCode" dbType="AnsiStringFixedLength" size="5" />
      <param name="@SysNo" dbType="Int32" size="10" direction="Output"/>
    </parameters>
  </dataCommand>

  <dataCommand name="CreateDataFeedProductGroupInfoProperty" database="IMService" commandType="Text">
    <!--定义SQL语句-->
    <commandText>
      <![CDATA[

        INSERT INTO OverseaContentManagement.dbo.ProductGroupInfo_Property
                   (ProductGroupSysno
                   ,GroupSysno
                   ,PropertySysno
                   ,ValueSysno
                   ,ManualInput
                   ,EditDate
                   ,EditUser
                   ,CompanyCode
                   ,LanguageCode
                   ,StoreCompanyCode)
             VALUES
                   (@ProductGroupSysno
                   ,@GroupSysno
                   ,@PropertySysno
                   ,@ValueSysno
                   ,@ManualInput
                   ,GETDATE()
                   ,@EditUser
                   ,@CompanyCode
                   ,@LanguageCode
                   ,@StoreCompanyCode)                  

	  ]]>
    </commandText>
    <parameters>
      <param name="@ProductGroupSysno" dbType="Int32" />
      <param name="@GroupSysno" dbType="Int32" />
      <param name="@PropertySysno" dbType="Int32" />
      <param name="@ValueSysno" dbType="Int32" />
      <param name="@ManualInput" dbType="String" />
      <param name="@EditUser" dbType="String" />
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" size="50"/>
      <param name="@StoreCompanyCode" dbType="AnsiStringFixedLength" size="50"/>
      <param name="@LanguageCode" dbType="AnsiStringFixedLength" size="5" />
    </parameters>
  </dataCommand>

  <dataCommand name="CreateDataFeedProductGroupInfoPropertySetting" database="IMService" commandType="Text">
    <!--定义SQL语句-->
    <commandText>
      <![CDATA[
        INSERT INTO OverseaContentManagement.dbo.ProductGroupInfo_PropertySetting
                   (ProductGroupSysno
                   ,PropertySysno
                   ,IsPolymeric
                   ,IsDisplayPic
                   ,ShowName
                   ,InDate
                   ,InUser
                   ,EditDate
                   ,EditUser
                   ,CompanyCode
                   ,LanguageCode
                   ,StoreCompanyCode
                  )
             VALUES
                   (@ProductGroupSysno
                   ,@PropertySysno
                   ,@IsPolymeric
                   ,@IsDisplayPic
                   ,@ShowName
                   ,GETDATE()
                   ,@InUser
                   ,GETDATE()
                   ,@InUser
                   ,@CompanyCode
                   ,@LanguageCode
                   ,@StoreCompanyCode
                   )            
	  ]]>
    </commandText>
    <parameters>
      <param name="@ProductGroupSysno" dbType="Int32" />
      <param name="@PropertySysno" dbType="Int32" />
      <param name="@IsPolymeric" dbType="String" />
      <param name="@IsDisplayPic" dbType="String" />
      <param name="@ShowName" dbType="String" />
      <param name="@InUser" dbType="String" />
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" size="50"/>
      <param name="@StoreCompanyCode" dbType="AnsiStringFixedLength" size="50"/>
      <param name="@LanguageCode" dbType="AnsiStringFixedLength" size="5" />
    </parameters>
  </dataCommand>

  <dataCommand name="GetExsitsSameProductCommonInfoDataFeed" database="IMService" commandType="Text">
    <!--定义SQL语句-->
    <commandText>
      <![CDATA[
        SELECT count(1)
          FROM OverseaContentManagement.dbo.ProductCommonInfo a WITH(NOLOCK) 
               INNER JOIN OverseaContentManagement.dbo.ProductGroupInfo b 
                 ON a.ProductGroupSysno = b.SysNo AND b.CompanyCode= @CompanyCode      
        WHERE  a.ProductModel = @ProductModel
          AND  b.C3SysNo  = @Category3SysNo
          AND  b.BrandSysNo = @BrandSysNo
          AND  a.CompanyCode = @CompanyCode  
	  ]]>
    </commandText>
    <parameters>
      <param name="@Category3SysNo" dbType="Int32" />
      <param name="@BrandSysNo" dbType="Int32" />
      <param name="@ProductModel" dbType="String"/>
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" size="50"/>
    </parameters>
  </dataCommand>

  <dataCommand name="GetGroupInfoGroupPropertySettingListDataFeed" database="IMService"  commandType="Text">
    <commandText>
      <![CDATA[
      
      SELECT PropertySysno as PropertySysNo
      FROM OverseaContentManagement.dbo.ProductGroupInfo_PropertySetting
      WHERE ProductGroupSysno = @SysNo
        AND CompanyCode = @CompanyCode
      ORDER BY PropertySysno
 
		]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" size="50"/>
    </parameters>
  </dataCommand>

  <dataCommand name="GetProductCommonInfoGroupPropertyListDataFeed" database="IMService"  commandType="Text">
    <commandText>
      <![CDATA[
      
     SELECT 
        CommonSKUNumber
       --,GroupSysno
       ,PropertySysno
       ,ValueSysno
     FROM OverseaContentManagement.dbo.ProductCommonInfo_Property 
     WHERE CommonSKUNumber IN ( 
                                SELECT CommonSKUNumber 
                                FROM OverseaContentManagement.dbo.ProductCommonInfo 
                                WHERE ProductGroupSysno = @GroupSysNo) 
       AND PropertySysno IN (
                              SELECT PropertySysno 
                              FROM OverseaContentManagement.dbo.ProductGroupInfo_PropertySetting  
                              WHERE ProductGroupSysno = @GroupSysNo )   
       AND CompanyCode = @CompanyCode      
     ORDER BY CommonSKUNumber,PropertySysno            
 
		]]>
    </commandText>
    <parameters>
      <param name="@GroupSysNo" dbType="Int32" />
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" size="50"/>
    </parameters>
  </dataCommand>

  <dataCommand name="CreateProductCommonInfoDataFeed" database="IMService" commandType="Text">
    <!--定义SQL语句-->
    <commandText>
      <![CDATA[
      
    IF EXISTS(SELECT TOP 1 1 FROM OverseaContentManagement.dbo.ProductCommonInfo WITH(NOLOCK) WHERE CommonSKUNumber = @CommonSKUNumber AND CompanyCode = @CompanyCode)
    BEGIN
      SET @SysNo = -1
    END
    ELSE
    BEGIN    
    
        IF(@ProductType = 'R')
        BEGIN
           SET @Warranty = '以发票上的购买日期为准,7天内全额退款,8-15天退款80%,15天后泰隆优选不承担任何售后服务,可直接联系厂家保修。';
        END
        
        SET @IsOfferInvoice = 'Y';
    
        INSERT INTO OverseaContentManagement.dbo.ProductCommonInfo
                   (CommonSKUNumber
                   ,ProductGroupSysno
                   ,UPCCode
                   ,ProductName
                   ,BriefName
                   ,Keywords
                   ,PMUserSysNo
                   ,ProductModel
                   ,ProductType
                   ,IsTakePictures
                   ,CompanyBelongs
                   ,OnlyForRank
                   ,PicNumber
                   ,IsOfferInvoice
                   ,IsLarge
                   ,InDate
                   ,InUser
                   ,CompanyCode
                   ,StoreCompanyCode
                   ,LanguageCode
                   ,HostWarrantyDay
                   ,PartWarrantyDay
                   ,Warranty
                   ,ServicePhone
                   ,ServiceInfo
                   ,Weight
                   ,Length
                   ,Width
                   ,Height
                   ,MinPackNumber
                   ,Note
                   ,Attention
                   ,ProductLink
                   ,PackageList
                   ,ProductDesc
                   )
             VALUES
                   (@CommonSKUNumber
                   ,@ProductGroupSysno
                   ,@UPCCode
                   ,@ProductName
                   ,@BriefName
                   ,@Keywords
                   ,@PMUserSysNo
                   ,@ProductModel
                   ,@ProductType
                   ,@IsTakePictures
                   ,@CompanyBelongs
                   ,@OnlyForRank
                   ,@PicNumber
                   ,@IsOfferInvoice
                   ,@IsLarge
                   ,GETDATE()
                   ,@InUser
                   ,@CompanyCode
                   ,@StoreCompanyCode
                   ,@LanguageCode
                   ,@HostWarrantyDay
                   ,@PartWarrantyDay
                   ,@Warranty
                   ,@ServicePhone
                   ,@ServiceInfo
                   ,@Weight
                   ,@Length
                   ,@Width
                   ,@Height
                   ,@MinPackNumber
                   ,@Note
                   ,@Attention
                   ,@ProductLink
                   ,@PackageList 
                   ,@ProductDesc
                   )      
                   
       SELECT @SysNo = SCOPE_IDENTITY();
                
    END
	  ]]>
    </commandText>
    <parameters>
      <param name="@CommonSKUNumber" dbType="String" />
      <param name="@ProductGroupSysno" dbType="Int32" />
      <param name="@UPCCode" dbType="String" />
      <param name="@ProductName" dbType="String" />
      <param name="@BriefName" dbType="String" />
      <param name="@Keywords" dbType="String" />
      <param name="@PMUserSysNo" dbType="Int32" />
      <param name="@ProductModel" dbType="String" />
      <param name="@ProductType" dbType="String" />
      <param name="@IsTakePictures" dbType="String" />
      <param name="@CompanyBelongs" dbType="String" />
      <param name="@OnlyForRank" dbType="Int32" />
      <param name="@PicNumber" dbType="Int32" />
      <param name="@IsOfferInvoice" dbType="String" />
      <param name="@IsLarge" dbType="String" />
      <param name="@InUser" dbType="String" />
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" size="50"/>
      <param name="@StoreCompanyCode" dbType="AnsiStringFixedLength" size="50"/>
      <param name="@LanguageCode" dbType="AnsiStringFixedLength" size="5" />
      <param name="@HostWarrantyDay" dbType="Int32" />
      <param name="@PartWarrantyDay" dbType="Int32" />
      <param name="@Warranty" dbType="String" />
      <param name="@ServicePhone" dbType="String" />
      <param name="@ServiceInfo" dbType="String" />
      <param name="@Weight" dbType="Int32" />
      <param name="@Length" dbType="Decimal" />
      <param name="@Width" dbType="Decimal" />
      <param name="@Height" dbType="Decimal" />
      <param name="@MinPackNumber" dbType="Int32" />
      <param name="@Note" dbType="String" />
      <param name="@Attention" dbType="String" />
      <param name="@ProductLink" dbType="String" />
      <param name="@PackageList" dbType="String" />
      <param name="@ProductDesc" dbType="String" />
      <param name="@SysNo" dbType="Int32" size="10" direction="Output"/>
    </parameters>
  </dataCommand>

  <dataCommand name="CreateProductCommonInfoExDataFeed" database="IMService" commandType="Text">
    <!--定义SQL语句-->
    <commandText>
      <![CDATA[
        INSERT INTO [OverseaContentManagement].[dbo].[ProductCommonInfo_Ex]
             ([SysNo]
             ,[Performance]
             ,[ProductDescLong]
             ,[ProductPhotoDesc])
        VALUES
             (@SysNo
             ,@Performance
             ,@ProductDescLong
             ,@ProductPhotoDesc)

	  ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />
      <param name="@Performance" dbType="String" />
      <param name="@ProductDescLong" dbType="String" />
      <param name="@ProductPhotoDesc" dbType="String" />
    </parameters>
  </dataCommand>

  <dataCommand name="CreateProductCommonInfoStatusDataFeed" database="IMService" commandType="Text">
    <!--定义SQL语句-->
    <commandText>
      <![CDATA[
        INSERT INTO OverseaContentManagement.dbo.ProductCommonInfo_Status
                   (CommonSKUNumber
                   ,IsChangeStyleWithTemplate
                   ,IsExtendWarrantyDisuse
                   ,IsBasicInformationCorrect
                   ,IsAccessoriesShow
                   ,IsAccessoriesCorrect
                   ,IsVirtualPic
                   ,IsPictureCorrect
                   ,IsWarrantyCorrect
                   ,IsWarrantyShow
                   ,IsWeightCorrect
                  )
             VALUES
                   (@CommonSKUNumber
                   ,'Y'
                   ,'N'
                   ,'N'
                   ,'N'
                   ,'Y'
                   ,'N'
                   ,'N'
                   ,'N'
                   ,'Y'
                   ,'N')            

	  ]]>
    </commandText>
    <parameters>
      <param name="@CommonSKUNumber" dbType="String" />
    </parameters>
  </dataCommand>

  <dataCommand name="CreateProductCommonInfoPropertyDataFeed" database="IMService" commandType="Text">
    <!--定义SQL语句-->
    <commandText>
      <![CDATA[
        INSERT INTO OverseaContentManagement.dbo.ProductCommonInfo_Property
                   (CommonSKUNumber
                   ,GroupSysno
                   ,PropertySysno
                   ,ValueSysno
                   ,ManualInput
                   ,EditDate
                   ,EditUser
                   ,CompanyCode
                   ,LanguageCode
                   ,StoreCompanyCode)
             VALUES
                   (@CommonSKUNumber
                   ,@GroupSysno
                   ,@PropertySysno
                   ,@ValueSysno
                   ,@ManualInput
                   ,GETDATE()
                   ,@EditUser
                   ,@CompanyCode
                   ,@LanguageCode
                   ,@StoreCompanyCode)                  

	  ]]>
    </commandText>
    <parameters>
      <param name="@CommonSKUNumber" dbType="String" />
      <param name="@GroupSysno" dbType="Int32" />
      <param name="@PropertySysno" dbType="Int32" />
      <param name="@ValueSysno" dbType="Int32" />
      <param name="@ManualInput" dbType="String" />
      <param name="@EditUser" dbType="String" />
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" size="50"/>
      <param name="@StoreCompanyCode" dbType="AnsiStringFixedLength" size="50"/>
      <param name="@LanguageCode" dbType="AnsiStringFixedLength" size="5" />
    </parameters>
  </dataCommand>

  <dataCommand name="InsertItemVirtualPriceLogDataFeed" database="IMService"  commandType="Text">
    <commandText>
      <![CDATA[
    
      INSERT INTO [OverseaContentManagement].[dbo].[ProductVirtualPricePricechangeLog]
             ([ProductSysno]
             ,[NewVirtualPrice]
             ,[OldVirtualPrice]
             ,[Note]
             ,[OptIP]
             ,[CreateUser]
             ,[CreateDate]
             )
       VALUES
             (@ProductSysno
             ,@VirtualPrice
             ,@OldVirtualPrice
             ,''
             ,@OptIP
             ,@CreateUser
             ,GETDATE()
             )
		]]>
    </commandText>
    <parameters>
      <param name="@ProductSysNo" dbType="Int32" />
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" size="50"/>
      <param name="@VirtualPrice" dbType="Decimal" size="19" />
      <param name="@OldVirtualPrice" dbType="Decimal" size="19" />
      <param name="@OptIP" dbType="String" size="19" />
      <param name="@CreateUser" dbType="String"/>
    </parameters>
  </dataCommand>

  <dataCommand name="CreateProductPropertyDataFeed" database="IMService" commandType="Text">
    <commandText>
      <![CDATA[

        INSERT INTO  PMDB.dbo.PIM_ProductProperty        
          (ProductSysNo
          ,GroupSysNo
          ,PropertySysNo
          ,ValueSysNo
          ,ManualInput 
          ,IsActive
          ,LastEditUserSysNo
          ,LastEditTime
          ,CompanyCode
          ,LanguageCode
          ,StoreCompanyCode)        
        VALUES        
          (@ProductSysNo
          ,@GroupSysNo
          ,@PropertySysNo
          ,@ValueSysNo
          ,@ManualInput 
          ,1
          ,@LastEditUserSysNo
          ,GETDATE()
          ,@CompanyCode
          ,@LanguageCode
          ,@StoreCompanyCode)      

    ]]>
    </commandText>
    <parameters>
      <param name="@ProductSysNo" dbType="Int32" />
      <param name="@GroupSysNo" dbType="Int32" />
      <param name="@PropertySysNo" dbType="Int32" />
      <param name="@ValueSysNo" dbType="Int32" />
      <param name="@ManualInput" dbType="String" />
      <param name="@LastEditUserSysNo" dbType="Int32" />
      <param name="@CompanyCode" dbType="String" />
      <param name="@LanguageCode" dbType="String" />
      <param name="@StoreCompanyCode" dbType="String" />
    </parameters>
  </dataCommand>

  <dataCommand name="CreateBasicInfoDataFeed" database="IMService"  commandType="Text">
    <commandText>
      <![CDATA[
    IF EXISTS(SELECT TOP 1 1 FROM IPP3.dbo.Product WITH(NOLOCK) WHERE ProductID = @ProductID AND CompanyCode = @CompanyCode)
    BEGIN
      SET @Flag = -1
    END
    ELSE IF EXISTS(SELECT TOP 1 1 FROM IPP3.dbo.Product WITH(NOLOCK) WHERE SysNo = @SysNo AND CompanyCode = @CompanyCode)
    BEGIN
      SET @Flag = -2
    END
    ELSE
    BEGIN
      SET @Flag = 0
		INSERT INTO IPP3.dbo.Product
		(
			SysNo,
			ProductID,
			ProductMode,
			ProductType,
			ProductName,
			ProductDesc,
      ProductDescLong,
			Performance,
			Warranty,
			PackageList,
			Weight,
			C3SysNo,
			ManufacturerSysNo,
			ProductLink,
			MultiPicNum,
			PMUserSysNo,
			PPMUserSysNo,
			CreateUserSysNo,
			CreateTime,
			Attention,
			Note,
			Status,
			IsLarge,
			BriefName,
      RemarkCount,
			RemarkScore,
			IsConsign,
			PromotionTitle,
			ProductTitle,
			ProductLine,
			BriefNameAddition,
      BrandSysNo,
      CompanyCode,
      ProductCommonInfoSysno,
      MerchantSysNo,
      BarCode
      
		)
		VALUES
		(
			@SysNo,
			@ProductID,
			@ProductMode,
			@ProductType,
			@ProductName,
			@ProductDesc,
      @ProductDescLong,
			NULL,
			@Warranty,
			@PackageList,
			@Weight,
			@C3SysNo,
			@ManufacturerSysNo,
			@ProductLink,
			@MultiPicNum,
			@PMUserSysNo,
			@PPMUserSysNo,
			@CreateUserSysNo,
			GetDate(),
			@Attention,
			@Note,
			@Status,
			@IsLarge,
			@BriefName,
      @RemarkCount,
			@RemarkScore,
			@IsConsign,
			@PromotionTitle,
			@ProductTitle,
			@ProductLine,
			@BriefNameAddition,
      @BrandSysNo,
      @CompanyCode,
      @ProductCommonInfoSysno,
      @MerchantSysNo,
      @BarCode
		)
    END
		]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />
      <param name="@ProductID" dbType="String" size="20"/>
      <param name="@ProductMode" dbType="String" size="100"/>
      <param name="@ProductType" dbType="Int32"/>
      <param name="@ProductName" dbType="String" size="200"/>
      <param name="@ProductDesc" dbType="String" size="2000"/>
      <param name="@ProductDescLong" dbType="String" size="2000"/>
      <param name="@Performance" dbType="String"/>
      <param name="@Warranty" dbType="String" size="200"/>
      <param name="@PackageList" dbType="String" size="500"/>
      <param name="@Weight" dbType="Int32"/>
      <param name="@C3SysNo" dbType="Int32"/>
      <param name="@ManufacturerSysNo" dbType="Int32"/>
      <param name="@ProductLink" dbType="String" size="200"/>
      <param name="@MultiPicNum" dbType="Int32"/>
      <param name="@PMUserSysNo" dbType="Int32"/>
      <param name="@PPMUserSysNo" dbType="Int32"/>
      <param name="@CreateUserSysNo" dbType="Int32"/>
      <param name="@Attention" dbType="String" size="4000"/>
      <param name="@Note" dbType="String" size="500"/>
      <param name="@Status" dbType="Int32"/>
      <param name="@IsLarge" dbType="Int32"/>
      <param name="@BriefName" dbType="String" size="100"/>
      <param name="@RemarkCount" dbType="Int32"/>
      <param name="@RemarkScore" dbType="Int32"/>
      <param name="@IsConsign" dbType="Int32"/>
      <param name="@PromotionTitle" dbType="String" size="200"/>
      <param name="@ProductTitle" dbType="String" size="200"/>
      <param name="@ProductLine" dbType="String" size="100"/>
      <param name="@BriefNameAddition" dbType="String" size="100"/>
      <param name="@BrandSysNo" dbType="Int32"/>
      <param name="@Flag" dbType="Int32" size="10" direction="Output"/>
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" size="50"/>
      <param name="@ProductCommonInfoSysno" dbType="Int32"/>
      <param name="@MerchantSysNo" dbType="Int32"/>
      <param name="@BarCode" dbType="String" size="30"/>
    </parameters>
  </dataCommand>

  <dataCommand name="CreateExInfoDataFeed" database="IMService"  commandType="Text">
    <commandText>
      <![CDATA[
      IF EXISTS (
					  SELECT TOP 1 1 FROM
					  IPP3.dbo.Product_Ex WITH(NOLOCK)
					  WHERE SysNo	= @SysNo AND CompanyCode = @CompanyCode
					  )
				BEGIN
          SET @Flag = -1
				END
			ELSE
				BEGIN
          SET @Flag = 0
		      INSERT INTO IPP3.dbo.Product_Ex
		      (
			      SysNo,
			      IsPermitRefund,
			      IsOfferValueAddedInvoice,
			      DMSValue,
			      SaleDays,
			      CompanyProduct,
			      PreviousProductSysNo,
			      BuyOnlyForRank,
			      IsInstalmentProduct,
			      InstalmentPhase,
			      NoInventoryDays,
			      Keywords,
			      IsTakePictures,
			      ProductColor,
			      IsChangeStylewithTemplate,
            CompanyCode,
            HostWarrantyDay,
            PartWarrantyDay,
            IsAutoShowSecHand,
            MinPackNumber
		      )
		      VALUES
		      (
			      @SysNo,
			      @IsPermitRefund,
			      @IsOfferValueAddedInvoice,
			      @DMSValue,
			      @SaleDays,
			      @CompanyProduct,
            @PreviousProductSysNo,
			      @BuyOnlyForRank,
			      @IsInstalmentProduct,
			      @InstalmentPhase,
			      @NoInventoryDays,
			      @Keywords,
			      @IsTakePictures,
			      @ProductColor,
			      @IsChangeStylewithTemplate,
            @CompanyCode,
            @HostWarrantyDay,
            @PartWarrantyDay,
            'A',
            @MinPackNumber
		      )
          
           INSERT INTO [OverseaContentManagement].[dbo].[ProductPageKeywords]
               ([ProductSysNo]
               ,[InDate]
               ,[InUser]
               ,[EditDate]
               ,[EditUser]
               ,[CompanyCode]
               )
            VALUES
               (@SysNo
               ,GETDATE()
               ,@EditUser
               ,GETDATE()
               ,@EditUser
               ,@CompanyCode
			        ) 
      END
		]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32"/>
      <param name="@IsPermitRefund" dbType="Int32"/>
      <param name="@IsOfferValueAddedInvoice" dbType="Int32"/>
      <param name="@DMSValue" dbType="Decimal" size="19"/>
      <param name="@SaleDays" dbType="Decimal" size="19"/>
      <param name="@CompanyProduct" dbType="Int32"/>
      <param name="@PreviousProductSysNo" dbType="Int32"/>
      <param name="@BuyOnlyForRank" dbType="Int32"/>
      <param name="@IsInstalmentProduct" dbType="Int32"/>
      <param name="@InstalmentPhase" dbType="Int32"/>
      <param name="@NoInventoryDays" dbType="Int32"/>
      <param name="@Keywords" dbType="String" size="400"/>
      <param name="@IsTakePictures" dbType="Int32"/>
      <param name="@ProductColor" dbType="String" size="20"/>
      <param name="@IsChangeStylewithTemplate" dbType="Int32"/>
      <param name="@Flag" dbType="Int32" size="10" direction="Output"/>
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" size="50" />
      <param name="@HostWarrantyDay" dbType="Int32"/>
      <param name="@PartWarrantyDay" dbType="Int32"/>
      <param name="@EditUser" dbType="String"/>
      <param name="@MinPackNumber" dbType="Int32"/>
    </parameters>
  </dataCommand>

  <dataCommand name="CreateProductStatusDataFeed" database="IMService"  commandType="Text">
    <commandText>
      <![CDATA[
		INSERT INTO IPP3.dbo.Product_Status
		(
			ProductSysNo,
			InfoStatus,
			InfoUserSysNo,
      AllowStatus,
      PicStatus,
      PriceStatus,
      WarrantyStatus,
      WeightStatus,
      VirtualPicStatus,
      AccessoryStatus,
      CompanyCode 
		)
		VALUES
		(
			@ProductSysNo,
			@InfoStatus,
			@InfoUserSysNo,
      @AllowStatus,
      @PicStatus,
      @PriceStatus,
      @WarrantyStatus,
      @WeightStatus,
      @VirtualPicStatus,
      1,
      @CompanyCode
		)
		SELECT @SysNo = SCOPE_IDENTITY()
		]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" size="10" direction="Output"/>
      <param name="@ProductSysNo" dbType="Int32"/>
      <param name="@InfoStatus" dbType="Int32"/>
      <param name="@InfoUserSysNo" dbType="Int32"/>
      <param name="@AllowStatus" dbType="Int32"/>
      <param name="@PicStatus" dbType="Int32"/>
      <param name="@PriceStatus" dbType="Int32"/>
      <param name="@WarrantyStatus" dbType="Int32"/>
      <param name="@WeightStatus" dbType="Int32"/>
      <param name="@VirtualPicStatus" dbType="Int32"/>
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" size="50"/>
    </parameters>
  </dataCommand>

  <dataCommand name="CreateInitProductPriceDataFeed" database="IMService"  commandType="Text">
    <commandText>
      <![CDATA[
		INSERT INTO IPP3.dbo.Product_Price
		(
			ProductSysNo,
			BasicPrice,
			CurrentPrice,
			UnitCost,
			Discount,
			PointType,
			IsWholeSale,
			MaxPerOrder,
			Q1,
			P1,
			Q2,
			P2,
			Q3,
			P3,
			CashRebate,
			Point,
			ClearanceSale,
			CreateTime,
			UnitCostWithoutTax,
      CompanyCode,
      VirtualPrice,
      IsUseAlipayVipPrice,
      AlipayVipPrice
		)
		VALUES
		(
			@ProductSysNo,
			@BasicPrice,
			@CurrentPrice,
			@UnitCost,
			@Discount,
			@PointType,
			@IsWholeSale,
			@MaxPerOrder,
      (CASE WHEN @Q1=-999999 THEN NULL ELSE @Q1 END),
			(CASE WHEN @P1=-999999 THEN NULL ELSE @P1 END),
			(CASE WHEN @Q2=-999999 THEN NULL ELSE @Q2 END),
			(CASE WHEN @P2=-999999 THEN NULL ELSE @P2 END),
			(CASE WHEN @Q3=-999999 THEN NULL ELSE @Q3 END),
			(CASE WHEN @P3=-999999 THEN NULL ELSE @P3 END),
			@CashRebate,
			@Point,
			@ClearanceSale,
			GetDate(),
			@UnitCostWithoutTax,
      @CompanyCode,
      @VirtualPrice,
      'N',
      NULL      
		)
		SELECT @SysNo = SCOPE_IDENTITY()
		]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" size="10" direction="Output"/>
      <param name="@ProductSysNo" dbType="Int32"/>
      <param name="@BasicPrice" dbType="Decimal" size="19"/>
      <param name="@CurrentPrice" dbType="Decimal" size="19"/>
      <param name="@UnitCost" dbType="Decimal" size="19"/>
      <param name="@Discount" dbType="Decimal" size="19"/>
      <param name="@PointType" dbType="Int32"/>
      <param name="@IsWholeSale" dbType="Int32"/>
      <param name="@MaxPerOrder" dbType="Int32"/>
      <param name="@Q1" dbType="Int32"/>
      <param name="@P1" dbType="Decimal" size="19"/>
      <param name="@Q2" dbType="Int32"/>
      <param name="@P2" dbType="Decimal" size="19"/>
      <param name="@Q3" dbType="Int32"/>
      <param name="@P3" dbType="Decimal" size="19"/>
      <param name="@CashRebate" dbType="Decimal" size="19"/>
      <param name="@Point" dbType="Int32"/>
      <param name="@ClearanceSale" dbType="Int32"/>
      <param name="@UnitCostWithoutTax" dbType="Decimal" size="19"/>
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" size="50"/>
      <param name="@VirtualPrice" dbType="Decimal"/>
    </parameters>
  </dataCommand>

  <dataCommand name="CreateProductPriceCatchDataFeed" database="IMService"  commandType="Text">
    <commandText>
      <![CDATA[
    
      INSERT INTO [IPP3].[dbo].[Product_PriceCatch]
           ([ProductSysNo]
           ,[ProductID]
           ,[JDPrice]
           ,[InDate]
           ,[InUserSysNo]
           ,[CompanyCode]
           ,[LanguageCode]
           ,[CurrencySysNo]
           ,[StoreCompanyCode])
     VALUES
           (@ProductSysNo
           ,@ProductID
           ,@JDPrice
           ,getdate()
           ,@InUserSysNo
           ,@CompanyCode
           ,'zh-CN'
           ,1
           ,@CompanyCode
           )
		]]>
    </commandText>
    <parameters>
      <param name="@ProductSysNo" dbType="Int32" />
      <param name="@ProductID" dbType="String" />
      <param name="@JDPrice" dbType="Decimal" size="19" />
      <param name="@InUserSysNo" dbType="Int32" />
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" size="50"/>
    </parameters>
  </dataCommand>

  <dataCommand name="CreateProductPriceCatchForAmDataFeed" database="IMService"  commandType="Text">
    <commandText>
      <![CDATA[
    
      INSERT INTO [IPP3].[dbo].[Product_PriceCatchForAm]
           ([ProductSysNo]
           ,[ProductID]
           ,[AMPrice]
           ,[InDate]
           ,[InUserSysNo]
           ,[CompanyCode]
           ,[LanguageCode]
           ,[CurrencySysNo]
           ,[StoreCompanyCode])
     VALUES
           (@ProductSysNo
           ,@ProductID
           ,@AMPrice
           ,getdate()
           ,@InUserSysNo
           ,@CompanyCode
           ,'zh-CN'
           ,1
           ,@CompanyCode)
		]]>
    </commandText>
    <parameters>
      <param name="@ProductSysNo" dbType="Int32" />
      <param name="@ProductID" dbType="String" />
      <param name="@AMPrice" dbType="Decimal" size="19" />
      <param name="@InUserSysNo" dbType="Int32" />
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" size="50"/>
    </parameters>
  </dataCommand>

  <dataCommand name="CreateProductDimensionsDataFeed" database="IMService"  commandType="Text">
    <commandText>
      <![CDATA[
    
      INSERT INTO [OverseaContentManagement].[dbo].[Product_Dimensions]
           ([ProductSysNo]
           ,[Length]
           ,[Width]
           ,[Height]
           ,[InDate]
           ,[InUser]
           ,[EditDate]
           ,[EditUser]
           ,[CompanyCode]
           ,[StoreCompanyCode]
           ,[CountryCode]
           ,[LanguageCode]
           ,[Status])
     VALUES
           (@ProductSysNo
           ,@Length
           ,@Width
           ,@Height
           ,getdate()
           ,@InUser
           ,getdate()
           ,@InUser
           ,@CompanyCode
           ,null
           ,null
           ,'zh-CN'
           ,'A')
		]]>
    </commandText>
    <parameters>
      <param name="@ProductSysNo" dbType="Int32" />
      <param name="@Length" dbType="Decimal" size="19" />
      <param name="@Width" dbType="Decimal" size="19" />
      <param name="@Height" dbType="Decimal" size="19" />
      <param name="@InUser" dbType="String"/>
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" size="50"/>
    </parameters>
  </dataCommand>
  
</dataOperations>