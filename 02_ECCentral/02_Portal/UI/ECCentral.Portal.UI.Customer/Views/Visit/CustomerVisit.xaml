<ovs:PageBase x:Class="ECCentral.Portal.UI.Customer.Views.CustomerVisit" 
           xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
           xmlns:ovs="clr-namespace:Newegg.Oversea.Silverlight.ControlPanel.Core.Base;assembly=Newegg.Oversea.Silverlight.ControlPanel.Core"
           xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
           xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
           xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
              xmlns:controls="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls"
              xmlns:ovsControls="clr-namespace:Newegg.Oversea.Silverlight.Controls;assembly=Newegg.Oversea.Silverlight.Controls"
              xmlns:ovsDataControls="clr-namespace:Newegg.Oversea.Silverlight.Controls.Data;assembly=Newegg.Oversea.Silverlight.Controls.Data"
              xmlns:sdk="http://schemas.microsoft.com/winfx/2006/xaml/presentation/sdk"
              xmlns:toolkit="http://schemas.microsoft.com/winfx/2006/xaml/presentation/toolkit"
              xmlns:ucCommon="clr-namespace:ECCentral.Portal.Basic.Components.UserControls.CustomerPicker;assembly=ECCentral.Portal.Basic"
              xmlns:my="clr-namespace:ECCentral.Portal.UI.Customer.Resources"
              xmlns:customer="clr-namespace:ECCentral.BizEntity.Customer;assembly=ECCentral.BizEntity"
              xmlns:converter="clr-namespace:ECCentral.Portal.Basic.Utilities;assembly=ECCentral.Portal.Basic"
              xmlns:commonConverter="clr-namespace:ECCentral.Portal.Basic.Converters;assembly=ECCentral.Portal.Basic"
              xmlns:baseConverter="clr-namespace:ECCentral.Portal.Basic.Utilities;assembly=ECCentral.Portal.Basic"
            mc:Ignorable="d" d:DesignHeight="480" d:DesignWidth="800">
    <Grid x:Name="LayoutRoot">
        <ovsControls:FunctionPanel x:Name="pagePanel" ContentHorizontalScrollBarVisibility="Disabled" ContentVerticalScrollBarVisibility="Disabled">
            <ovsControls:FunctionPanel.Resources>
                <my:ResCustomerVisit x:Key="MySource" />
                <converter:EnumConverter x:Name="MyEnumConverter"/>
                <commonConverter:DateTimeConverter x:Name="MyDateConverter" />
                <commonConverter:MoneyConverter x:Name="MyMoneyConverter" />
                <baseConverter:BooleanConverter x:Name="BooleanConverter"></baseConverter:BooleanConverter>
            </ovsControls:FunctionPanel.Resources>
            <ovsControls:FunctionPanel.Content>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <toolkit:Expander x:Name="expanderQueryCondition" Grid.Row="0" Header="{Binding Path=Expander_SearchCondition, Source={StaticResource MySource}}"
                          IsExpanded="True">
                        <StackPanel Orientation="Horizontal"  Margin="20,5">
                            <StackPanel Orientation="Vertical">
                                <StackPanel Orientation="Horizontal">
                                    <Grid x:Name="gridBaseCondition">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition   Width="200" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="200" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition  Width="200" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition  Width="200" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition  />
                                            <RowDefinition  />
                                            <RowDefinition  />
                                        </Grid.RowDefinitions>

                                        <TextBlock Text="{Binding Path=TextBlock_SearchType, Source={StaticResource MySource}}" Grid.Row="0" Grid.Column="0" />
                                        <ComboBox Margin="7 0 9 0" x:Name="cmbSeachType" Grid.Row="0" Grid.Column="1" DisplayMemberPath="Value"
                                            SelectedValuePath="Key" SelectedValue="{Binding SeachType, Mode=TwoWay}" SelectionChanged="cmbSeachType_SelectionChanged"/>
                                        <TextBlock Text="顾客ID:" Grid.Row="0" Grid.Column="2" />
                                        <TextBox Text="{Binding CustomerID,Mode=TwoWay}"  Grid.Row="0" Grid.Column="3" ></TextBox>
                                        <TextBlock Text="顾客SysNo:" Grid.Row="0" Grid.Column="4" />
                                        <TextBox Text="{Binding CustomerSysNo,Mode=TwoWay,NotifyOnValidationError=True,ValidatesOnExceptions=True}"  Grid.Row="0" Grid.Column="5" ></TextBox>
                                        <TextBlock Text="客户姓名: " Grid.Row="0" Grid.Column="6" />
                                        <TextBox Text="{Binding CustomerName,Mode=TwoWay}"  Grid.Row="0" Grid.Column="7" ></TextBox>
                                        <TextBlock Text="电子邮箱: " Grid.Row="1" Grid.Column="0" />
                                        <TextBox Text="{Binding Email,Mode=TwoWay}"  Grid.Row="1" Grid.Column="1" ></TextBox>
                                        <TextBlock Text="电话: " Grid.Row="1" Grid.Column="2" />
                                        <TextBox Text="{Binding Phone,Mode=TwoWay,ValidatesOnExceptions=True,NotifyOnValidationError=True}"  Grid.Row="1" Grid.Column="3" ></TextBox>
                                        <TextBlock Text="地址: " Grid.Row="1" Grid.Column="4" />
                                        <TextBox Text="{Binding Address,Mode=TwoWay}"  Grid.Row="1" Grid.Column="5" ></TextBox>
                                        <TextBlock Text="{Binding Path=TextBlock_CustomerRank, Source={StaticResource MySource}}"  Grid.Row="1" Grid.Column="6"/>
                                        <ComboBox Margin="7 0 9 0" x:Name="cmbCustomerRank"   Grid.Row="1" Grid.Column="7" DisplayMemberPath="Value"
                                            SelectedValuePath="Key" SelectedValue="{Binding CustomerRank, Mode=TwoWay}">
                                        </ComboBox>

                                        <TextBlock Text="{Binding Path=TextBlock_AccumulatedAmount, Source={StaticResource MySource}}"  Grid.Row="2" Grid.Column="0"/>
                                        <StackPanel Orientation="Horizontal"  Grid.Row="2" Grid.Column="1">
                                            <TextBox x:Name="txtAccumulatedAmountFrom" Width="70" Text="{Binding FromTotalAmount, Mode=TwoWay,ValidatesOnExceptions=True, NotifyOnValidationError=True}" />
                                            <TextBlock Text="{Binding Path=TextBlock_To, Source={StaticResource MySource}}"/>
                                            <TextBox x:Name="txtAccumulatedAmountTo"  Width="70" Text="{Binding ToTotalAmount, Mode=TwoWay, ValidatesOnExceptions=True, NotifyOnValidationError=True}" />
                                        </StackPanel>
                                        <TextBlock Text="{Binding Path=TextBlock_LastOrderTime, Source={StaticResource MySource}}" Grid.Row="2" Grid.Column="2"/>
                                        <StackPanel Margin="5 0 0 0" Orientation="Horizontal"  Grid.Row="2" Grid.Column="3">
                                            <ComboBox  SelectedIndex="{Binding ShipTypeCondition, Mode=TwoWay}" Width="70">
                                                <ComboBoxItem Content="="></ComboBoxItem>
                                                <ComboBoxItem Content=">"></ComboBoxItem>
                                                <ComboBoxItem Content="&lt;"></ComboBoxItem>

                                            </ComboBox>
                                            <TextBox  Width="75" Text="{Binding ShipType, Mode=TwoWay,ValidatesOnExceptions=True,NotifyOnValidationError=True}" ></TextBox>
                                            <TextBlock Text="天"></TextBlock>
                                        </StackPanel>
                                        <TextBlock Text="{Binding Path=TextBlock_VipType, Source={StaticResource MySource}}" Grid.Row="2" Grid.Column="4"/>
                                        <CheckBox x:Name="cbVip" Content="{Binding Path=CheckBox_IsVip, Source={StaticResource MySource}}" IsChecked="{Binding IsVip, Mode=TwoWay}" Grid.Row="2" Grid.Column="5" />
                                    </Grid>
                                </StackPanel>
                                <StackPanel x:Name="spSpider" Orientation="Vertical" Visibility="Collapsed" >
                                    <controls:GridSplitter HorizontalAlignment="Stretch"  VerticalAlignment="Center"  Margin="0,5"/>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition   Width="200" />
                                            <ColumnDefinition Width="20" />
                                            <ColumnDefinition Width="90" />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition  />
                                        </Grid.RowDefinitions>


                                        <TextBlock Visibility="{Binding Path=Visibility, ElementName=cmbDealStatus}" Text="{Binding Path=TextBlock_DealStatus,Source={StaticResource MySource}}" Grid.Row="0" Grid.Column="0" />
                                        <ComboBox x:Name="cmbDealStatus"  Grid.Row="0" Grid.Column="1"  DisplayMemberPath="Value"
                                            SelectedValuePath="Key" SelectedValue="{Binding DealStatus, Mode=TwoWay}"/>
                                        <TextBlock Name="tbCallResult" Text="{Binding Path=TextBlock_CallResult,Source={StaticResource MySource}}"  Grid.Row="0" Grid.Column="3" />
                                        <StackPanel Visibility="{Binding Path=Visibility , ElementName=tbCallResult}" Orientation="Horizontal" Grid.Row="0" Grid.Column="4">
                                            <CheckBox x:Name="cbCallResultConnected"     />
                                            <CheckBox x:Name="cbCallResultNotConnected"  />
                                            <CheckBox x:Name="cbCallResultCustomerReject"/>
                                            <CheckBox x:Name="cbCallResultNotSelf"       />
                                            <CheckBox x:Name="cbCallResultNoIsError"     />
                                            <CheckBox x:Name="cbCallResultOtherTime"     />
                                        </StackPanel>
                                    </Grid>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition   Width="200" />
                                            <ColumnDefinition Width="20" />
                                            <ColumnDefinition Width="90" />
                                            <ColumnDefinition  Width="200" />
                                            <ColumnDefinition Width="20" />
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition  Width="200" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition />
                                            <RowDefinition />
                                        </Grid.RowDefinitions>
                                        <TextBlock Text="{Binding Path=TextBlock_ConsumeDesire,Source={StaticResource MySource}}" Grid.Row="0" Grid.Column="0" />
                                        <ComboBox x:Name="cmbConsumeDesire" Grid.Row="0" Grid.Column="1"  DisplayMemberPath="Value"
                                            SelectedValuePath="Key" SelectedValue="{Binding ConsumeDesire, Mode=TwoWay}"/>
                                        <TextBlock Text="{Binding Path=TextBlock_IsActivated,Source={StaticResource MySource}}" Grid.Row="0" Grid.Column="3"/>
                                        <ComboBox x:Name="cmbActivated" Grid.Row="0" Grid.Column="4" DisplayMemberPath="Value"
                                            SelectedValuePath="Key" SelectedValue="{Binding IsActivated, Mode=TwoWay}"/>
                                        <TextBlock Text="{Binding Path=TextBlock_IsMaintain,Source={StaticResource MySource}}"   Grid.Row="0" Grid.Column="6"/>
                                        <ComboBox x:Name="cmbMaintain" Grid.Row="0" Grid.Column="7" DisplayMemberPath="Value"
                                            SelectedValuePath="Key" SelectedValue="{Binding IsMaintain, Mode=TwoWay}"/>

                                        <TextBlock Text="{Binding Path=TextBlock_EditUser,Source={StaticResource MySource}}" Grid.Row="1" Grid.Column="0" />
                                        <ComboBox x:Name="cmbEditUser" DisplayMemberPath="UserDisplayName"  SelectedValuePath="SysNo" Grid.Row="1" Grid.Column="1" SelectedValue="{Binding LastEditorSysNo, Mode=TwoWay}"/>
                                        <TextBlock Text="{Binding Path=TextBlock_LastVisitDate,Source={StaticResource MySource}}" Grid.Row="1" Grid.Column="3" />
                                        <ovsControls:DateRange x:Name="dateVisitDate"  Grid.Row="1" Grid.Column="4"  SelectedDateStart="{Binding FromVisitDate, Mode=TwoWay}"  SelectedDateEnd="{Binding ToVisitDate, Mode=TwoWay}"/>
                                        <TextBlock Visibility="{Binding Path=Visibility, ElementName=drSpiderTime}"  Text="Spider时间" Grid.Row="1" Grid.Column="6" />
                                        <ovsControls:DateRange Name="drSpiderTime"   Grid.Row="1" Grid.Column="7"  SelectedDateStart="{Binding SpiderOrderDateFrom, Mode=TwoWay}"  SelectedDateEnd="{Binding SpiderOrderDateTo, Mode=TwoWay}"/>
                                    </Grid>
                                </StackPanel>
                            </StackPanel>
                            <controls:GridSplitter Name="Spliterr_Query_1" 
												   HorizontalAlignment="Center"
												   Margin="10,0"
												   VerticalAlignment="Stretch" />
                            <StackPanel Orientation="Vertical" HorizontalAlignment="Left" VerticalAlignment="Center">
                                <Button  x:Name="btnSearch" Click="btnSearch_Click" Margin="0"  Content="{Binding Path=Button_Search, Source={StaticResource MySource}}" 
                                          Tag="/Themes/Default/Icons/Button/query.png" />
                                <CheckBox  x:Name="cbMore" Content="{Binding Path=CheckBox_More,Source={StaticResource MySource}}" IsChecked="{Binding IsSpiderSearch, Mode= TwoWay}"   Margin="0,5,0,0" Click="cbMore_Click"/>
                            </StackPanel>
                        </StackPanel>
                    </toolkit:Expander>
                    <!--回访统计开始-->
                    <toolkit:Expander Name="exVisited" Grid.Row="1" Header="{Binding Path=Expander_SearchResults, Source={StaticResource MySource}}" IsExpanded="True">
                        <ovsDataControls:DataGrid Name="dgVisited" GridID="A0DD2CF6-B3A6-4C3D-BF1E-707DF2DAC606" ExportAllClick="dgVisited_ExportAllClick"
                                       CanUserSortColumns="True" IsServerSort="True" EnableCustomizeColumn="True" IsShowAllExcelExporter="True"
                                      AutoGenerateColumns="False"  IsReadOnly="True"  LoadingDataSource="dgVisited_LoadingDataSource" FrozenColumnCount="1">
                            <ovsDataControls:DataGrid.Columns>
                                <!--操作 start-->
                                <ovsDataControls:DataGridTemplateColumn Name="VisitedOperateView" Width="80"
                                                            ovsDataControls:DataGridAttached.Header="操作">
                                    <ovsDataControls:DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <HyperlinkButton x:Name="hlbVisitedView"
                                                 Content="查看" Click="hlbVisitedView_Click" />
                                        </DataTemplate>
                                    </ovsDataControls:DataGridTemplateColumn.CellTemplate>
                                </ovsDataControls:DataGridTemplateColumn>
                                <!--操作 end-->
                                <ovsDataControls:DataGridTextColumn Name="VisitedCustomerID"                                                        
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_CustomerID,Source={StaticResource MySource}}" Binding="{Binding [CustomerID]}" Width="100" SortField="[CustomerID]" SortMemberPath="[CustomerID]" CanUserSort="True"/>
                                <ovsDataControls:DataGridTextColumn  Name="VisitedCustomerName"                                                       
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_CustomerName,Source={StaticResource MySource}}" Binding="{Binding [CustomerName]}" Width="100" SortField="[CustomerName]" SortMemberPath="[CustomerName]" CanUserSort="True"/>
                                <ovsDataControls:DataGridTextColumn Width="150" Name="VisitedPhone"
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_Phone,Source={StaticResource MySource}}" Binding="{Binding [Phone]}" CanUserSort="False"/>
                                <ovsDataControls:DataGridTextColumn Width="150" Name="VisitedRegisterTime"
                                                        ovsDataControls:DataGridAttached.Header="注册日期" Binding="{Binding [RegisterTime],Converter={StaticResource MyDateConverter}, ConverterParameter=Long}" SortField="RegisterTime" CanUserSort="True"/>
                                <ovsDataControls:DataGridTextColumn Width="80"  Name="VisitedRank"
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_Rank,Source={StaticResource MySource}}" Binding="{Binding [Rank], Converter={StaticResource MyEnumConverter}}" SortField="Rank" CanUserSort="True" />
                                <ovsDataControls:DataGridTextColumn Name="VisitedEmail"
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_Email,Source={StaticResource MySource}}" Binding="{Binding [Email]}" Width="150"  CanUserSort="True" SortField="Email" />
                                <ovsDataControls:DataGridTextColumn Width="80" Name="VisitedConfirmedTotalAmt"
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_ConfirmedTotalAmt,Source={StaticResource MySource}}" Binding="{Binding Path=[ConfirmedTotalAmt],Converter={StaticResource MyMoneyConverter}}" CanUserSort="True" SortField="ConfirmedTotalAmt"/>
                                <ovsDataControls:DataGridTextColumn Name="VisitedLastBuyDate"
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_LastBuyDate,Source={StaticResource MySource}}" Binding="{Binding Path=[LastBuyTime],Converter={StaticResource MyDateConverter}, ConverterParameter=Long}" CanUserSort="True"  SortField="LastBuyTime"/>
                                <ovsDataControls:DataGridTextColumn Name="VisitedLastEditUserName"
                                                        ovsDataControls:DataGridAttached.Header="更新人" CanUserSort="True" SortField="LastEditUserName" Binding="{Binding Path=[LastEditUserName]}" />
                                <ovsDataControls:DataGridTextColumn Name="VisitedIsActive"
                                                        ovsDataControls:DataGridAttached.Header="激活状态" Binding="{Binding Path=[IsActive],Converter={StaticResource MyEnumConverter}}" CanUserSort="True" SortField="IsActive" />
                                <ovsDataControls:DataGridTextColumn Name="VisitedLastCallTime"
                                                        ovsDataControls:DataGridAttached.Header="最近联系日期" Binding="{Binding Path=[LastCallTime],Converter={StaticResource MyDateConverter}, ConverterParameter=Long}"  CanUserSort="True" SortField="LastCallTime" />
                                <ovsDataControls:DataGridTextColumn Name="VisitedLastCallStatus"
                                                        ovsDataControls:DataGridAttached.Header="回访结果" Binding="{Binding Path=[LastCallStatus], Converter={StaticResource MyEnumConverter}}"  CanUserSort="True" SortField="LastCallStatus" />
                                <ovsDataControls:DataGridTextColumn Name="VisitedLastMaintenanceStatusDisp"
                                                        ovsDataControls:DataGridAttached.Header="维护结果" Binding="{Binding Path=[LastMaintenanceStatus],Converter={StaticResource MyEnumConverter}}"  CanUserSort="True" SortField="LastMaintenanceStatusDisp" />
                                <ovsDataControls:DataGridTextColumn Name="VisitedLastCallReason"
                                                        ovsDataControls:DataGridAttached.Header="原因" Binding="{Binding Path=[LastCallReason], Converter={StaticResource MyEnumConverter}}"  CanUserSort="True" SortField="LastCallReason" />
                                <ovsDataControls:DataGridTextColumn Name="VisitedContactCount"
                                                        ovsDataControls:DataGridAttached.Header="外拨次数" Binding="{Binding Path=[ContactCount]}"  CanUserSort="True" SortField="ContactCount" />
                                <ovsDataControls:DataGridTextColumn Name="VisitedNeedBuy"
                                                        ovsDataControls:DataGridAttached.Header="购买意向" Binding="{Binding Path=[NeedBuy], Converter={StaticResource MyEnumConverter}}"  CanUserSort="True" SortField="NeedBuy" />
                                <ovsDataControls:DataGridTextColumn Name="VisitedIsRMA"
                                                        ovsDataControls:DataGridAttached.Header="是否有退货" Binding="{Binding Path=[IsRMA], Converter={StaticResource BooleanConverter}}"  CanUserSort="True" SortField="IsRMA" />
                                <ovsDataControls:DataGridTextColumn Name="VisitedSpiderAmt"
                                                        ovsDataControls:DataGridAttached.Header="Spider金额" Binding="{Binding Path=[SpiderAmt]}"  CanUserSort="True" SortField="SpiderAmt" />
                                <ovsDataControls:DataGridTextColumn Name="VisitedSpiderCount"
                                                        ovsDataControls:DataGridAttached.Header="Spider合计" Binding="{Binding Path=[SpiderCount]}"  CanUserSort="True" SortField="SpiderCount" />
                            </ovsDataControls:DataGrid.Columns>
                        </ovsDataControls:DataGrid>
                    </toolkit:Expander>
                    <!--回访统计结束-->
                    <!--待回访开始-->
                    <toolkit:Expander Name="exWaitingVisit" Grid.Row="1" Header="{Binding Path=Expander_SearchResults, Source={StaticResource MySource}}" IsExpanded="True">
                        <ovsDataControls:DataGrid Name="dgWaitingVisit" GridID="CA77A8F6-AB83-4FFC-B0D7-865C688A2272" ExportAllClick="dgWaitingVisit_ExportAllClick"
                                       CanUserSortColumns="True" IsServerSort="True" EnableCustomizeColumn="True" IsShowAllExcelExporter="True"
                                      AutoGenerateColumns="False"  IsReadOnly="True"  LoadingDataSource="dgWaitingVisit_LoadingDataSource" FrozenColumnCount="1">
                            <ovsDataControls:DataGrid.Columns>
                                <!--操作 start-->
                                <ovsDataControls:DataGridTemplateColumn Name="OperateVisit" Width="80"
                                                            ovsDataControls:DataGridAttached.Header="操作">
                                    <ovsDataControls:DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <HyperlinkButton x:Name="hlbWaitingVisit"
                                                 Content="待回访" Click="hlbEvent_Click" />
                                        </DataTemplate>
                                    </ovsDataControls:DataGridTemplateColumn.CellTemplate>
                                </ovsDataControls:DataGridTemplateColumn>
                                <!--操作 end-->
                                <ovsDataControls:DataGridTextColumn Name="WaitingVisitCustomerID"                                                        
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_CustomerID,Source={StaticResource MySource}}" Binding="{Binding [CustomerID]}" Width="100" SortField="[CustomerID]" SortMemberPath="[CustomerID]" CanUserSort="True"/>
                                <ovsDataControls:DataGridTextColumn  Name="WaitingVisitCustomerName"                                                       
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_CustomerName,Source={StaticResource MySource}}" Binding="{Binding [CustomerName]}" Width="100" SortField="[CustomerName]" SortMemberPath="[CustomerName]" CanUserSort="True"/>
                                <ovsDataControls:DataGridTextColumn Width="150" Name="WaitingVisitPhone"
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_Phone,Source={StaticResource MySource}}" Binding="{Binding [Phone]}" CanUserSort="False"/>
                                <ovsDataControls:DataGridTextColumn Width="150" Name="WaitingVisitRegisterTime"
                                                        ovsDataControls:DataGridAttached.Header="注册日期" Binding="{Binding [RegisterTime],Converter={StaticResource MyDateConverter}, ConverterParameter=Long}" SortField="RegisterTime" CanUserSort="True"/>
                                <ovsDataControls:DataGridTextColumn Width="80"  Name="WaitingVisitRank"
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_Rank,Source={StaticResource MySource}}" Binding="{Binding [Rank], Converter={StaticResource MyEnumConverter}}" SortField="Rank" CanUserSort="True" />
                                <ovsDataControls:DataGridTextColumn Name="WaitingVisitEmail"
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_Email,Source={StaticResource MySource}}" Binding="{Binding [Email]}" Width="150"  CanUserSort="True" SortField="Email" />
                                <ovsDataControls:DataGridTextColumn Width="80" Name="WaitingVisitConfirmedTotalAmt"
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_ConfirmedTotalAmt,Source={StaticResource MySource}}" Binding="{Binding Path=[ConfirmedTotalAmt],Converter={StaticResource MyMoneyConverter}}" CanUserSort="True" SortField="ConfirmedTotalAmt"/>
                                <ovsDataControls:DataGridTextColumn Name="WaitingVisitLastBuyDate"
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_LastBuyDate,Source={StaticResource MySource}}" Binding="{Binding Path=[LastBuyTime],Converter={StaticResource MyDateConverter}, ConverterParameter=Long}" CanUserSort="True"  SortField="LastBuyTime"/>
                            </ovsDataControls:DataGrid.Columns>
                        </ovsDataControls:DataGrid>
                    </toolkit:Expander>
                    <!--待回访结束-->
                    <!--需跟进回访开始-->
                    <toolkit:Expander Name="exFollowUpVisit" Grid.Row="1" Header="{Binding Path=Expander_SearchResults, Source={StaticResource MySource}}" IsExpanded="True">
                        <ovsDataControls:DataGrid Name="dgFollowUpVisit" GridID="8105C61D-33DD-465A-8078-8BD6F880AEE9" ExportAllClick="dgFollowUpVisit_ExportAllClick"
                                       CanUserSortColumns="True" IsServerSort="True" EnableCustomizeColumn="True" IsShowAllExcelExporter="True"
                                      AutoGenerateColumns="False"  IsReadOnly="True"  LoadingDataSource="dgFollowUpVisit_LoadingDataSource" FrozenColumnCount="1">
                            <ovsDataControls:DataGrid.Columns>
                                <!--操作 start-->
                                <ovsDataControls:DataGridTemplateColumn Name="OperateFollowUpVisit" Width="80"
                                                            ovsDataControls:DataGridAttached.Header="操作">
                                    <ovsDataControls:DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <HyperlinkButton x:Name="hlbVisit"
                                                 Content="待回访" Click="hlbEvent_Click" />
                                        </DataTemplate>
                                    </ovsDataControls:DataGridTemplateColumn.CellTemplate>
                                </ovsDataControls:DataGridTemplateColumn>
                                <!--操作 end-->
                                <ovsDataControls:DataGridTextColumn Name="FollowUpVisitCustomerID"                                                        
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_CustomerID,Source={StaticResource MySource}}" Binding="{Binding [CustomerID]}" Width="100" SortField="[CustomerID]" SortMemberPath="[CustomerID]" CanUserSort="True"/>
                                <ovsDataControls:DataGridTextColumn  Name="FollowUpVisitCustomerName"                                                       
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_CustomerName,Source={StaticResource MySource}}" Binding="{Binding [CustomerName]}" Width="100" SortField="[CustomerName]" SortMemberPath="[CustomerName]" CanUserSort="True"/>


                                <ovsDataControls:DataGridTextColumn Width="150" Name="FollowUpVisitPhone"
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_Phone,Source={StaticResource MySource}}" Binding="{Binding [Phone]}" CanUserSort="False"/>

                                <ovsDataControls:DataGridTextColumn Width="150" Name="FollowUpVisitRegisterTime"
                                                        ovsDataControls:DataGridAttached.Header="注册日期" Binding="{Binding [RegisterTime],Converter={StaticResource MyDateConverter}, ConverterParameter=Long}" SortField="RegisterTime" CanUserSort="True"/>
                                <ovsDataControls:DataGridTextColumn Width="80"  Name="FollowUpVisitRank"
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_Rank,Source={StaticResource MySource}}" Binding="{Binding [Rank], Converter={StaticResource MyEnumConverter}}" SortField="Rank" CanUserSort="True" />
                                <ovsDataControls:DataGridTextColumn Name="FollowUpVisitEmail"
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_Email,Source={StaticResource MySource}}" Binding="{Binding [Email]}" Width="150"  CanUserSort="True" SortField="Email" />
                                <ovsDataControls:DataGridTextColumn Width="80" Name="FollowUpVisitConfirmedTotalAmt"
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_ConfirmedTotalAmt,Source={StaticResource MySource}}" Binding="{Binding Path=[ConfirmedTotalAmt],Converter={StaticResource MyMoneyConverter}}" CanUserSort="True" SortField="ConfirmedTotalAmt"/>
                                <ovsDataControls:DataGridTextColumn Name="FollowUpVisitLastBuyDate"
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_LastBuyDate,Source={StaticResource MySource}}" Binding="{Binding Path=[LastBuyTime],Converter={StaticResource MyDateConverter}, ConverterParameter=Long}" CanUserSort="True"  SortField="LastBuyTime"/>
                                <ovsDataControls:DataGridTextColumn Name="FollowUpVisitLastEditUserName"
                                                        ovsDataControls:DataGridAttached.Header="更新人" CanUserSort="True" SortField="LastEditUserName" Binding="{Binding Path=[LastEditUserName]}" />
                                <ovsDataControls:DataGridTextColumn Name="FollowUpVisitLastCallTime"
                                                        ovsDataControls:DataGridAttached.Header="最近联系日期" Binding="{Binding Path=[LastCallTime],Converter={StaticResource MyDateConverter}, ConverterParameter=Long}"  CanUserSort="True" SortField="LastCallTime" />
                                <ovsDataControls:DataGridTextColumn Name="FollowUpVisitLastCallStatus"
                                                        ovsDataControls:DataGridAttached.Header="回访结果" Binding="{Binding Path=[LastCallStatus], Converter={StaticResource MyEnumConverter}}"  CanUserSort="True" SortField="LastCallStatus" />
                                <ovsDataControls:DataGridTextColumn Name="FollowUpVisitLastCallReason"
                                                        ovsDataControls:DataGridAttached.Header="原因" Binding="{Binding Path=[LastCallReason], Converter={StaticResource MyEnumConverter}}"  CanUserSort="True" SortField="LastCallReason" />
                                <ovsDataControls:DataGridTextColumn Name="FollowUpVisitContactCount"
                                                        ovsDataControls:DataGridAttached.Header="外拨次数" Binding="{Binding Path=[ContactCount]}"  CanUserSort="True" SortField="ContactCount" />
                                <ovsDataControls:DataGridTextColumn Name="FollowUpVisitNeedBuy"
                                                        ovsDataControls:DataGridAttached.Header="购买意向" Binding="{Binding Path=[NeedBuy], Converter={StaticResource MyEnumConverter}}"  CanUserSort="True" SortField="NeedBuy" />
                            </ovsDataControls:DataGrid.Columns>
                        </ovsDataControls:DataGrid>
                    </toolkit:Expander>
                    <!--需跟进回访结束-->
                    <!--待维护开始-->
                    <toolkit:Expander Name="exMaintenance" Grid.Row="1" Header="{Binding Path=Expander_SearchResults, Source={StaticResource MySource}}" IsExpanded="True">
                        <ovsDataControls:DataGrid Name="dgMaintenance" GridID="8411CCB6-042B-4F93-9A69-887FF7875BD3" ExportAllClick="dgMaintenance_ExportAllClick"
                                       CanUserSortColumns="True" IsServerSort="True" EnableCustomizeColumn="True" IsShowAllExcelExporter="True"
                                      AutoGenerateColumns="False"  IsReadOnly="True"  LoadingDataSource="dgMaintenance_LoadingDataSource" FrozenColumnCount="1">
                            <ovsDataControls:DataGrid.Columns>
                                <!--操作 start-->
                                <ovsDataControls:DataGridTemplateColumn Name="OperateMantaince" Width="80"
                                                            ovsDataControls:DataGridAttached.Header="操作">
                                    <ovsDataControls:DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <HyperlinkButton x:Name="hlbMantaince"
                                                 Content="待维护" Click="hlbEvent_Click" />
                                        </DataTemplate>
                                    </ovsDataControls:DataGridTemplateColumn.CellTemplate>
                                </ovsDataControls:DataGridTemplateColumn>
                                <!--操作 end-->
                                <ovsDataControls:DataGridTextColumn Name="MaintenanceCustomerID"                                                        
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_CustomerID,Source={StaticResource MySource}}" Binding="{Binding [CustomerID]}" Width="100" SortField="[CustomerID]" SortMemberPath="[CustomerID]" CanUserSort="True"/>
                                <ovsDataControls:DataGridTextColumn  Name="MaintenanceCustomerName"                                                       
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_CustomerName,Source={StaticResource MySource}}" Binding="{Binding [CustomerName]}" Width="100" SortField="[CustomerName]" SortMemberPath="[CustomerName]" CanUserSort="True"/>
                                <ovsDataControls:DataGridTextColumn Width="150" Name="MaintenancePhone"
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_Phone,Source={StaticResource MySource}}" Binding="{Binding [Phone]}" CanUserSort="False"/>
                                <ovsDataControls:DataGridTextColumn Width="150" Name="MaintenanceRegisterTime"
                                                        ovsDataControls:DataGridAttached.Header="注册日期" Binding="{Binding [RegisterTime],Converter={StaticResource MyDateConverter}, ConverterParameter=Long}" SortField="RegisterTime" CanUserSort="True"/>
                                <ovsDataControls:DataGridTextColumn Width="80"  Name="MaintenanceRank"
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_Rank,Source={StaticResource MySource}}" Binding="{Binding [Rank], Converter={StaticResource MyEnumConverter}}" SortField="Rank" CanUserSort="True" />
                                <ovsDataControls:DataGridTextColumn Name="MaintenanceEmail"
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_Email,Source={StaticResource MySource}}" Binding="{Binding [Email]}" Width="150"  CanUserSort="True" SortField="Email" />
                                <ovsDataControls:DataGridTextColumn Width="80" Name="MaintenanceConfirmedTotalAmt"
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_ConfirmedTotalAmt,Source={StaticResource MySource}}" Binding="{Binding Path=[ConfirmedTotalAmt],Converter={StaticResource MyMoneyConverter}}" CanUserSort="True" SortField="ConfirmedTotalAmt"/>
                                <ovsDataControls:DataGridTextColumn Name="MaintenanceLastBuyDate"
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_LastBuyDate,Source={StaticResource MySource}}" Binding="{Binding Path=[LastBuyTime],Converter={StaticResource MyDateConverter}, ConverterParameter=Long}" CanUserSort="True"  SortField="LastBuyTime"/>
                                <ovsDataControls:DataGridTextColumn Name="MaintenanceLastEditUserName"
                                                        ovsDataControls:DataGridAttached.Header="更新人" CanUserSort="True" SortField="LastEditUserName" Binding="{Binding Path=[LastEditUserName]}" />
                                <ovsDataControls:DataGridTextColumn Name="MaintenanceIsActive"
                                                        ovsDataControls:DataGridAttached.Header="激活状态" Binding="{Binding Path=[IsActive],Converter={StaticResource MyEnumConverter}}" CanUserSort="True" SortField="IsActive" />
                                <ovsDataControls:DataGridTextColumn Name="MaintenanceLastCallTime"
                                                        ovsDataControls:DataGridAttached.Header="最近联系日期" Binding="{Binding Path=[LastCallTime],Converter={StaticResource MyDateConverter}, ConverterParameter=Long}"  CanUserSort="True" SortField="LastCallTime" />
                                <ovsDataControls:DataGridTextColumn Name="MaintenanceLastCallStatus"
                                                        ovsDataControls:DataGridAttached.Header="回访结果" Binding="{Binding Path=[LastCallStatus], Converter={StaticResource MyEnumConverter}}"  CanUserSort="True" SortField="LastCallStatus" />
                                <ovsDataControls:DataGridTextColumn Name="MaintenanceContactCount"
                                                        ovsDataControls:DataGridAttached.Header="外拨次数" Binding="{Binding Path=[ContactCount]}"  CanUserSort="True" SortField="ContactCount" />
                                <ovsDataControls:DataGridTextColumn Name="MaintenanceNeedBuy"
                                                        ovsDataControls:DataGridAttached.Header="购买意向" Binding="{Binding Path=[NeedBuy], Converter={StaticResource MyEnumConverter}}"  CanUserSort="True" SortField="NeedBuy" />
                                <ovsDataControls:DataGridTextColumn Name="MaintenanceIsRMA"
                                                        ovsDataControls:DataGridAttached.Header="是否有退货" Binding="{Binding Path=[IsRMA], Converter={StaticResource BooleanConverter}}"  CanUserSort="True" SortField="IsRMA" />
                                <ovsDataControls:DataGridTextColumn Name="MaintenanceSpiderAmt"
                                                        ovsDataControls:DataGridAttached.Header="Spider金额" Binding="{Binding Path=[SpiderAmt]}"  CanUserSort="True" SortField="SpiderAmt" />
                                <ovsDataControls:DataGridTextColumn Name="MaintenanceSpiderCount"
                                                        ovsDataControls:DataGridAttached.Header="Spider合计" Binding="{Binding Path=[SpiderCount]}"  CanUserSort="True" SortField="SpiderCount" />
                            </ovsDataControls:DataGrid.Columns>
                        </ovsDataControls:DataGrid>
                    </toolkit:Expander>
                    <!--待维护结束-->
                    <!--需跟进维护开始-->
                    <toolkit:Expander Name="exFollowUpMaintenance" Grid.Row="1" Header="{Binding Path=Expander_SearchResults, Source={StaticResource MySource}}" IsExpanded="True">
                        <ovsDataControls:DataGrid Name="dgFollowUpMaintenance" GridID="C05CF85F-E913-4B7A-8700-FF60DA3B9897" ExportAllClick="dgFollowUpMaintenance_ExportAllClick"
                                       CanUserSortColumns="True" IsServerSort="True" EnableCustomizeColumn="True" IsShowAllExcelExporter="True"
                                      AutoGenerateColumns="False"  IsReadOnly="True"  LoadingDataSource="dgFollowUpMaintenance_LoadingDataSource" FrozenColumnCount="1">
                            <ovsDataControls:DataGrid.Columns>
                                <!--操作 start-->
                                <ovsDataControls:DataGridTemplateColumn Name="OperateFollowUpMaintenance" Width="80"
                                                            ovsDataControls:DataGridAttached.Header="操作">
                                    <ovsDataControls:DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <HyperlinkButton x:Name="hlbMantaince"
                                                 Content="待维护" Click="hlbEvent_Click" />
                                        </DataTemplate>
                                    </ovsDataControls:DataGridTemplateColumn.CellTemplate>
                                </ovsDataControls:DataGridTemplateColumn>
                                <!--操作 end-->
                                <ovsDataControls:DataGridTextColumn Name="FollowUpMaintenanceCustomerID"                                                        
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_CustomerID,Source={StaticResource MySource}}" Binding="{Binding [CustomerID]}" Width="100" SortField="[CustomerID]" SortMemberPath="[CustomerID]" CanUserSort="True"/>
                                <ovsDataControls:DataGridTextColumn  Name="FollowUpMaintenanceCustomerName"                                                       
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_CustomerName,Source={StaticResource MySource}}" Binding="{Binding [CustomerName]}" Width="100" SortField="[CustomerName]" SortMemberPath="[CustomerName]" CanUserSort="True"/>
                                <ovsDataControls:DataGridTextColumn Width="150" Name="FollowUpMaintenancePhone"
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_Phone,Source={StaticResource MySource}}" Binding="{Binding [Phone]}" CanUserSort="False"/>
                                <ovsDataControls:DataGridTextColumn Width="150" Name="FollowUpMaintenanceRegisterTime"
                                                        ovsDataControls:DataGridAttached.Header="注册日期" Binding="{Binding [RegisterTime],Converter={StaticResource MyDateConverter}, ConverterParameter=Long}" SortField="RegisterTime" CanUserSort="True"/>
                                <ovsDataControls:DataGridTextColumn Width="80"  Name="FollowUpMaintenanceRank"
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_Rank,Source={StaticResource MySource}}" Binding="{Binding [Rank], Converter={StaticResource MyEnumConverter}}" SortField="Rank" CanUserSort="True" />
                                <ovsDataControls:DataGridTextColumn Name="FollowUpMaintenanceEmail"
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_Email,Source={StaticResource MySource}}" Binding="{Binding [Email]}" Width="150"  CanUserSort="True" SortField="Email" />
                                <ovsDataControls:DataGridTextColumn Width="80" Name="FollowUpMaintenanceConfirmedTotalAmt"
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_ConfirmedTotalAmt,Source={StaticResource MySource}}" Binding="{Binding Path=[ConfirmedTotalAmt],Converter={StaticResource MyMoneyConverter}}" CanUserSort="True" SortField="ConfirmedTotalAmt"/>
                                <ovsDataControls:DataGridTextColumn Name="FollowUpMaintenanceLastBuyDate"
                                                        ovsDataControls:DataGridAttached.Header="{Binding Path=grid_header_LastBuyDate,Source={StaticResource MySource}}" Binding="{Binding Path=[LastBuyTime],Converter={StaticResource MyDateConverter}, ConverterParameter=Long}" CanUserSort="True"  SortField="LastBuyTime"/>
                                <ovsDataControls:DataGridTextColumn Name="FollowUpMaintenanceLastEditUserName"
                                                        ovsDataControls:DataGridAttached.Header="更新人" CanUserSort="True" SortField="LastEditUserName" Binding="{Binding Path=[LastEditUserName]}" />
                                <ovsDataControls:DataGridTextColumn Name="FollowUpMaintenanceIsActive"
                                                        ovsDataControls:DataGridAttached.Header="激活状态" Binding="{Binding Path=[IsActive],Converter={StaticResource MyEnumConverter}}" CanUserSort="True" SortField="IsActive" />
                                <ovsDataControls:DataGridTextColumn Name="FollowUpMaintenanceLastCallTime"
                                                        ovsDataControls:DataGridAttached.Header="最近联系日期" Binding="{Binding Path=[LastCallTime],Converter={StaticResource MyDateConverter}, ConverterParameter=Long}"  CanUserSort="True" SortField="LastCallTime" />
                                <ovsDataControls:DataGridTextColumn Name="FollowUpMaintenanceLastCallStatus"
                                                        ovsDataControls:DataGridAttached.Header="回访结果" Binding="{Binding Path=[LastCallStatus], Converter={StaticResource MyEnumConverter}}"  CanUserSort="True" SortField="LastCallStatus" />
                                <ovsDataControls:DataGridTextColumn Name="FollowUpMaintenanceLastMaintenanceStatusDisp"
                                                        ovsDataControls:DataGridAttached.Header="维护结果" Binding="{Binding Path=[LastMaintenanceStatus],Converter={StaticResource MyEnumConverter}}"  CanUserSort="True" SortField="LastMaintenanceStatusDisp" />
                                <ovsDataControls:DataGridTextColumn Name="FollowUpMaintenanceLastCallReason"
                                                        ovsDataControls:DataGridAttached.Header="原因" Binding="{Binding Path=[LastCallReason], Converter={StaticResource MyEnumConverter}}"  CanUserSort="True" SortField="LastCallReason" />
                                <ovsDataControls:DataGridTextColumn Name="FollowUpMaintenanceContactCount"
                                                        ovsDataControls:DataGridAttached.Header="外拨次数" Binding="{Binding Path=[ContactCount]}"  CanUserSort="True" SortField="ContactCount" />
                                <ovsDataControls:DataGridTextColumn Name="FollowUpMaintenanceNeedBuy"
                                                        ovsDataControls:DataGridAttached.Header="购买意向" Binding="{Binding Path=[NeedBuy], Converter={StaticResource MyEnumConverter}}"  CanUserSort="True" SortField="NeedBuy" />
                                <ovsDataControls:DataGridTextColumn Name="FollowUpMaintenanceIsRMA"
                                                        ovsDataControls:DataGridAttached.Header="是否有退货" Binding="{Binding Path=[IsRMA], Converter={StaticResource BooleanConverter}}"  CanUserSort="True" SortField="IsRMA" />
                                <ovsDataControls:DataGridTextColumn Name="FollowUpMaintenanceSpiderAmt"
                                                        ovsDataControls:DataGridAttached.Header="Spider金额" Binding="{Binding Path=[SpiderAmt]}"  CanUserSort="True" SortField="SpiderAmt" />
                                <ovsDataControls:DataGridTextColumn Name="FollowUpMaintenanceSpiderCount"
                                                        ovsDataControls:DataGridAttached.Header="Spider合计" Binding="{Binding Path=[SpiderCount]}"  CanUserSort="True" SortField="SpiderCount" />
                            </ovsDataControls:DataGrid.Columns>
                        </ovsDataControls:DataGrid>
                    </toolkit:Expander>
                    <!--需跟进维护结束-->
                </Grid>
            </ovsControls:FunctionPanel.Content>

        </ovsControls:FunctionPanel>
    </Grid>
</ovs:PageBase>
