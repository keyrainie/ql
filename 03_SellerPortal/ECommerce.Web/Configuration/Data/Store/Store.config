<?xml version="1.0" encoding="utf-8" ?>
<dataOperations xmlns="http://oversea.ECommerce.com/DataOperation">


  <!-- 创建品牌报备:ECStore.dbo.StoreBrandFiling -->
  <dataCommand name="InsertStoreBrandFiling" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
if not exists (select 1 from ECStore.dbo.StoreBrandFiling (nolock) where SellerSysNo=@SellerSysNo and BrandSysNo=@BrandSysNo)
begin
INSERT INTO ECStore.dbo.StoreBrandFiling 
(SellerSysNo,BrandSysNo,InspectionNo,AgentLevel,Staus,InUserSysNo,InUserName,InDate) 
VALUES 
(@SellerSysNo,@BrandSysNo,@InspectionNo,@AgentLevel,@Staus,@InUserSysNo,@InUserName,GETDATE())
SELECT @SysNo = SCOPE_IDENTITY(); 
end
else
begin
select @SysNo=-1
end
        ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" direction="Output"/>
      <param name="@SellerSysNo" dbType="Int32" />
      <param name="@BrandSysNo" dbType="Int32" />
      <param name="@InspectionNo" dbType="AnsiString" />
      <param name="@AgentLevel" dbType="String" />
      <param name="@Staus" dbType="Int32" />
      <param name="@InUserSysNo" dbType="Int32" />
      <param name="@InUserName" dbType="AnsiStringFixedLength" />

    </parameters>
  </dataCommand>

  <!-- 更新品牌报备:ECStore.dbo.StoreBrandFiling -->
  <dataCommand name="UpdateStoreBrandFiling" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
    UPDATE ECStore.dbo.StoreBrandFiling SET 
        SellerSysNo=@SellerSysNo,
        BrandSysNo=@BrandSysNo,
        InspectionNo=@InspectionNo,
        AgentLevel=@AgentLevel,
        Staus=@Staus,
        EditUserSysNo=@EditUserSysNo,
        EditUserName=@EditUserName,
        EditDate=GETDATE() 
        WHERE SysNo=@SysNo
        ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />
      <param name="@SellerSysNo" dbType="Int32" />
      <param name="@BrandSysNo" dbType="Int32" />
      <param name="@InspectionNo" dbType="AnsiString" />
      <param name="@AgentLevel" dbType="String" />
      <param name="@Staus" dbType="Int32" />
      <param name="@EditUserSysNo" dbType="Int32" />
      <param name="@EditUserName" dbType="AnsiStringFixedLength" />

    </parameters>
  </dataCommand>

  <!-- 获取品牌报备:ECStore.dbo.StoreBrandFiling -->
  <dataCommand name="LoadStoreBrandFiling" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
    SELECT 
            SysNo, SellerSysNo, BrandSysNo, InspectionNo, AgentLevel, Staus, InUserSysNo, InUserName, InDate, EditUserSysNo, EditUserName, EditDate 
            FROM ECStore.dbo.StoreBrandFiling WITH(NOLOCK) 
            WHERE SysNo=@SysNo
        ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />

    </parameters>
  </dataCommand>


  <dataCommand name="CreateModifyRequest" database="Write" commandType="Text">
    <commandText>
      <![CDATA[      
			INSERT INTO [IPP3].[dbo].[Vendor_ModifyRequest]
					   ([VendorSysNo]
					   ,[CreateTime]
					   ,[CreateUserSysNo]
					   ,[Status]
					   ,[CompanyCode]
					   ,[RequestType]
					   ,[RANK]
					   ,[ActionType]
					   ,[ManufacturerSysNo]
             ,[VendorManufacturerSysNo]
					   ,[LEVEL]
					   ,[C2SysNo]
					   ,[C3SysNo]
					   ,[Content]
					   ,[Memo]
             ,[SettleType]
					   ,[SettlePercentage]
             ,[BuyWeekDay]
             ,[SendPeriod]
             ,[BrandSysNo]
             ,[SettlePeriodType]
             ,[AutoAudit]
             --,[MaxNoPayTimeForOrder]
             --,[IsNeedConfirmOrder]
             )
				 VALUES
					   (@VendorSysNo
					   ,getdate()
					   ,@CreateUserSysNo
					   ,@Status
					   ,@CompanyCode
					   ,@RequestType
					   ,@RANK
					   ,@ActionType
					   ,(select top 1 ManufacturerSysNo from OverseaContentManagement..brand(nolock) where sysno=@BrandSysNo )
             ,@VendorManufacturerSysNo
					   ,@LEVEL
					   ,@C2SysNo
					   ,@C3SysNo
					   ,@Content
					   ,@Memo
             ,@SettleType
					   ,@SettlePercentage
             ,@BuyWeekDay
             ,@SendPeriod
             ,@BrandSysNo
             ,@SettlePeriodType
             ,@AutoAudit
             --,@MaxNoPayTimeForOrder
             --,@IsNeedConfirmOrder
             )
			]]>
    </commandText>
    <parameters>
      <param name="@VendorSysNo" dbType="Int32" />
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" />
      <param name="@RANK" dbType="AnsiStringFixedLength" />
      <param name="@CreateUserSysNo" dbType="Int32" />
      <param name="@Status" dbType="Int32" />
      <param name="@RequestType" dbType="Int32" />
      <param name="@ManufacturerSysNo" dbType="Int32" />
      <param name="@LEVEL" dbType="String" />
      <param name="@C2SysNo" dbType="Int32" />
      <param name="@C3SysNo" dbType="Int32" />
      <param name="@Content" dbType="String" />
      <param name="@Memo" dbType="String" />
      <param name="@ActionType" dbType="Int32" />
      <param name="@VendorManufacturerSysNo" dbType="Int32" />
      <param name="@VendorManufacturerStatus" dbType="Int32" />
      <param name="@SettleType" dbType="String" size="1" />
      <param name="@SettlePercentage" dbType="Decimal" />
      <param name="@BuyWeekDay" dbType="String" />
      <param name="@SendPeriod" dbType="String" />
      <param name="@BrandSysNo" dbType="Int32" />
      <param name="@SettlePeriodType" dbType="Int32" />
      <param name="@AutoAudit" dbType="AnsiStringFixedLength" />
      <!--<param name="@MaxNoPayTimeForOrder" dbType="Int32" />
      <param name="@IsNeedConfirmOrder" dbType="Int32" />-->
    </parameters>
  </dataCommand>
  <dataCommand name="QueryAllStorePageTheme" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
SELECT 
SysNo, Name, CssResUrl, MockUrl, Status, InUserSysNo, InUserName, InDate, EditUserSysNo, EditUserName, EditDate 
FROM ECStore.dbo.StorePageTheme WITH(NOLOCK) 
WHERE [Status]=1
        ]]>
    </commandText>
    <parameters>
    </parameters>
  </dataCommand>


  <!-- 创建页面主题(字典表):ECStore.dbo.StorePageTheme -->
  <dataCommand name="InsertStorePageTheme" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
    INSERT INTO ECStore.dbo.StorePageTheme 
            (Name,CssResUrl,MockUrl,Status,InUserSysNo,InUserName,InDate) 
            VALUES 
            (@Name,@CssResUrl,@MockUrl,@Status,@InUserSysNo,@InUserName,GETDATE())

            SELECT @SysNo = SCOPE_IDENTITY(); 
        ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" direction="Output"/>
      <param name="@Name" dbType="String" />
      <param name="@CssResUrl" dbType="AnsiString" />
      <param name="@MockUrl" dbType="AnsiString" />
      <param name="@Status" dbType="Int32" />
      <param name="@InUserSysNo" dbType="Int32" />
      <param name="@InUserName" dbType="AnsiStringFixedLength" />

    </parameters>
  </dataCommand>

  <!-- 删除页面主题(字典表):ECStore.dbo.StorePageTheme -->
  <dataCommand name="DeleteStorePageTheme" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
    DELETE FROM ECStore.dbo.StorePageTheme WHERE SysNo=@SysNo
        ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />

    </parameters>
  </dataCommand>

  <!-- 更新页面主题(字典表):ECStore.dbo.StorePageTheme -->
  <dataCommand name="UpdateStorePageTheme" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
    UPDATE ECStore.dbo.StorePageTheme SET 
        Name=@Name,
        CssResUrl=@CssResUrl,
        MockUrl=@MockUrl,
        Status=@Status,
        EditUserSysNo=@EditUserSysNo,
        EditUserName=@EditUserName,
        EditDate=GETDATE() 
        WHERE SysNo=@SysNo
        ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />
      <param name="@Name" dbType="String" />
      <param name="@CssResUrl" dbType="AnsiString" />
      <param name="@MockUrl" dbType="AnsiString" />
      <param name="@Status" dbType="Int32" />
      <param name="@EditUserSysNo" dbType="Int32" />
      <param name="@EditUserName" dbType="AnsiStringFixedLength" />

    </parameters>
  </dataCommand>

  <!-- 获取页面主题(字典表):ECStore.dbo.StorePageTheme -->
  <dataCommand name="LoadStorePageTheme" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
    SELECT 
            SysNo, Name, CssResUrl, MockUrl, Status, InUserSysNo, InUserName, InDate, EditUserSysNo, EditUserName, EditDate 
            FROM ECStore.dbo.StorePageTheme WITH(NOLOCK) 
            WHERE SysNo=@SysNo
        ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />

    </parameters>
  </dataCommand>


  <dataCommand name="DelStoreAttachment" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
            DELETE ECStore.dbo.StoreAttachment 
            WHERE SysNo=@SysNo
        ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />

    </parameters>
  </dataCommand>

  <dataCommand name="DelStoreAgentProduct" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
delete ipp3.dbo.Vendor_Manufacturer where SysNo=@AgentSysNo
delete OverseaPOASNManagement.dbo.CommissionRule_Merchant where VendorManufacturerSysNo=@AgentSysNo
        ]]>
    </commandText>
    <parameters>
      <param name="@AgentSysNo" dbType="Int32" />
    </parameters>
  </dataCommand>

  <dataCommand name="QueryStoreAgentInfos" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
SELECT  DISTINCT
      a.[SysNo] as [AgentSysNo]
      ,a.[VendorSysNo]
      ,a.[ManufacturerSysNo] as [ManufacturerInfo.SysNo]
      ,a.[C2SysNo] AS [C2SysNo]
      ,a.[AgentLevel] AS [AgentLevel]
      ,a.[Status]
      ,a.[CreateTime]
      ,a.[C3SysNo] AS [C3SysNo]
      ,a.[SendPeriod]
      ,a.[BuyWeekDay]
      ,a.[BrandSysNo] as [BrandInfo.SysNo]
      ,ISNULL(f.BrandName_Ch,f.BrandName_En) AS [BrandInfo.BrandNameLocal]
      ,Isnull(b.ManufacturerName,b.BriefName) AS [ManufacturerInfo.ManufacturerNameLocal]
      ,c.Category2Name AS [C2Name]
      ,d.Category3Name AS [C3Name]
      ,e.Status AS [RequestType]
      ,e.ActionType AS [CheckType]
      ,e.[SendPeriod] as RequestSendPeriod
      ,e.[BuyWeekDay] as RequestBuyWeekDay
      ,e.[Content] as [Content]
      --,a.[SettleType]  AS [SettleType]
      --,a.[SettlePercentage] AS SettlePercentage
      ,(CASE e.ActionType WHEN 1 THEN e.[SettleType] ELSE a.[SettleType] END) AS SettleType
      ,(CASE e.ActionType WHEN 1 THEN e.[SettlePercentage] ELSE a.[SettlePercentage] END) AS SettlePercentage
      ,g.OrderCommissionFee as [VendorCommissionInfo.OrderCommissionAmt]
      ,g.DeliveryFee as [VendorCommissionInfo.DeliveryFee]
      ,g.RentFee as [VendorCommissionInfo.RentFee]
      ,g.SalesRule as [VendorCommissionInfo.StagedSaleRuleItemsXml]
      ,b.BriefName AS [ManufacturerInfo.BriefName]
      ,f.BrandName_En AS [BrandInfo.BrandNameGlobal]
      FROM ipp3.dbo.Vendor_Manufacturer a WITH(NOLOCK)
      LEFT JOIN OverseaContentManagement.dbo.V_CM_Manufacturer b WITH(NOLOCK) ON b.SysNo = a.ManufacturerSysNo
      LEFT JOIN OverseaContentManagement.dbo.V_CM_CategoryInfo c WITH(NOLOCK)  ON c.Category2Sysno = a.C2SysNo
      LEFT JOIN OverseaContentManagement.dbo.V_CM_CategoryInfo d WITH(NOLOCK)  ON d.Category3Sysno=a.C3SysNo
      LEFT JOIN IPP3.dbo.Vendor_ModifyRequest e WITH(NOLOCK)  ON e.VendorManufacturerSysNo=a.[SysNo] AND e.Status NOT IN (1,2,-2)
      LEFT JOIN OverseaContentManagement.dbo.V_IM_Brand f WITH(nolock) ON f.SysNo = a.BrandSysNo
      LEFT JOIN OverseaPOASNManagement.dbo.CommissionRule_Merchant g WITH(nolock) ON a.SysNo = g.VendorManufacturerSysNO AND g.Status = 'A'
      WHERE a.Status in (0,2) and a.VendorSysNo = @VendorSysNo
        ]]>
    </commandText>
    <parameters>
      <param name="@VendorSysNo" dbType="Int32" />
    </parameters>
  </dataCommand>
  
  <dataCommand name="QueryStoreAgentInfosByPage" database="Write" commandType="Text">
    <commandText>
      <![CDATA[


SELECT DISTINCT
        a.[SysNo] as [AgentSysNo]
      ,a.[VendorSysNo]
      ,a.[ManufacturerSysNo] as [ManufacturerInfo.SysNo]
      ,a.[C2SysNo] AS [C2SysNo]
      ,a.[AgentLevel] AS [AgentLevel]
      ,a.[Status]
      ,a.[CreateTime]
      ,a.[C3SysNo] AS [C3SysNo]
      ,a.[SendPeriod]
      ,a.[BuyWeekDay]
      ,a.[BrandSysNo] as [BrandInfo.SysNo]
      ,ISNULL(f.BrandName_Ch,f.BrandName_En) AS [BrandInfo.BrandNameLocal]
      ,Isnull(b.ManufacturerName,b.BriefName) AS [ManufacturerInfo.ManufacturerNameLocal]
      ,c.Category2Name AS [C2Name]
      ,d.Category3Name AS [C3Name]
      ,e.Status AS [RequestType]
      ,e.ActionType AS [CheckType]
      ,e.[SendPeriod] as RequestSendPeriod
      ,e.[BuyWeekDay] as RequestBuyWeekDay
      ,e.[Content] as [Content]
      --,a.[SettleType]  AS [SettleType]
      --,a.[SettlePercentage] AS SettlePercentage
      ,(CASE e.ActionType WHEN 1 THEN e.[SettleType] ELSE a.[SettleType] END) AS SettleType
      ,(CASE e.ActionType WHEN 1 THEN e.[SettlePercentage] ELSE a.[SettlePercentage] END) AS SettlePercentage
      ,g.OrderCommissionFee as [VendorCommissionInfo.OrderCommissionAmt]
      ,g.DeliveryFee as [VendorCommissionInfo.DeliveryFee]
      ,g.RentFee as [VendorCommissionInfo.RentFee]
      ,g.SalesRule as [VendorCommissionInfo.StagedSaleRuleItemsXml]
      ,b.BriefName AS [ManufacturerInfo.BriefName]
      ,f.BrandName_En AS [BrandInfo.BrandNameGlobal]
      INTO #Temp
      FROM ipp3.dbo.Vendor_Manufacturer a WITH(NOLOCK)
      LEFT JOIN OverseaContentManagement.dbo.V_CM_Manufacturer b WITH(NOLOCK) ON b.SysNo = a.ManufacturerSysNo
      LEFT JOIN OverseaContentManagement.dbo.V_CM_CategoryInfo c WITH(NOLOCK)  ON c.Category2Sysno = a.C2SysNo
      LEFT JOIN OverseaContentManagement.dbo.V_CM_CategoryInfo d WITH(NOLOCK)  ON d.Category3Sysno=a.C3SysNo
      LEFT JOIN IPP3.dbo.Vendor_ModifyRequest e WITH(NOLOCK)  ON e.VendorManufacturerSysNo=a.[SysNo] AND e.Status NOT IN (1,2,-2)
      LEFT JOIN OverseaContentManagement.dbo.V_IM_Brand f WITH(nolock) ON f.SysNo = a.BrandSysNo
      LEFT JOIN OverseaPOASNManagement.dbo.CommissionRule_Merchant g WITH(nolock) ON a.SysNo = g.VendorManufacturerSysNO AND g.Status = 'A'
      #StrWhere#
      
SELECT @TotalCount = COUNT(1) FROM #Temp

SELECT * FROM
(
    SELECT TOP (@EndNumber) 
    * 
    ,(ROW_NUMBER() OVER(ORDER BY #SortColumnName#)) AS RowNumber
    FROM
    #Temp
)AS T 
 WHERE RowNumber > @StartNumber
        ]]>
    </commandText>
    <parameters>
      <param name="@VendorSysNo" dbType="Int32" />
    </parameters>
  </dataCommand>

  <dataCommand name="QueryCommissionRule" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
    SELECT 
            SysNo, OrderCommissionFee, SalesRule, DeliveryFee, RentFee, Status, BrandSysNo, C1SysNo, C2SysNo, C3SysNo, InUserSysNo, InUserName, InDate, EditUserSysNo, EditUserName, EditDate 
            FROM ECStore.dbo.CommissionRule WITH(NOLOCK) 
            WHERE BrandSysNo=@BrandSysNo and C3SysNo=@C3SysNo
        ]]>
    </commandText>
    <parameters>
      <param name="@BrandSysNo" dbType="Int32" />
      <param name="@C3SysNo" dbType="Int32" />

    </parameters>
  </dataCommand>

  <!-- 创建佣金规则:ECStore.dbo.CommissionRule -->
  <dataCommand name="InsertCommissionRule" database="write" commandType="Text">
    <commandText>
      <![CDATA[
    INSERT INTO ECStore.dbo.CommissionRule 
            (OrderCommissionFee,SalesRule,DeliveryFee,RentFee,Status,BrandSysNo,C1SysNo,C2SysNo,C3SysNo,InUserSysNo,InUserName,InDate) 
            VALUES 
            (@OrderCommissionFee,@SalesRule,@DeliveryFee,@RentFee,@Status,@BrandSysNo,@C1SysNo,@C2SysNo,@C3SysNo,@InUserSysNo,@InUserName,GETDATE())

            SELECT @SysNo = SCOPE_IDENTITY(); 
        ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" direction="Output"/>
      <param name="@OrderCommissionFee" dbType="Decimal" />
      <param name="@SalesRule" dbType="AnsiString" />
      <param name="@DeliveryFee" dbType="Decimal" />
      <param name="@RentFee" dbType="Decimal" />
      <param name="@Status" dbType="AnsiStringFixedLength" />
      <param name="@BrandSysNo" dbType="Int32" />
      <param name="@C1SysNo" dbType="Int32" />
      <param name="@C2SysNo" dbType="Int32" />
      <param name="@C3SysNo" dbType="Int32" />
      <param name="@InUserSysNo" dbType="Int32" />
      <param name="@InUserName" dbType="AnsiStringFixedLength" />

    </parameters>
  </dataCommand>

  <!-- 更新佣金规则:ECStore.dbo.CommissionRule -->
  <dataCommand name="UpdateCommissionRule" database="write" commandType="Text">
    <commandText>
      <![CDATA[
    UPDATE ECStore.dbo.CommissionRule SET 
        OrderCommissionFee=@OrderCommissionFee,
        SalesRule=@SalesRule,
        DeliveryFee=@DeliveryFee,
        RentFee=@RentFee,
        Status=@Status,
        BrandSysNo=@BrandSysNo,
        C1SysNo=@C1SysNo,
        C2SysNo=@C2SysNo,
        C3SysNo=@C3SysNo,
        EditUserSysNo=@EditUserSysNo,
        EditUserName=@EditUserName,
        EditDate=GETDATE() 
        WHERE SysNo=@SysNo
        ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />
      <param name="@OrderCommissionFee" dbType="Decimal" />
      <param name="@SalesRule" dbType="AnsiString" />
      <param name="@DeliveryFee" dbType="Decimal" />
      <param name="@RentFee" dbType="Decimal" />
      <param name="@Status" dbType="AnsiStringFixedLength" />
      <param name="@BrandSysNo" dbType="Int32" />
      <param name="@C1SysNo" dbType="Int32" />
      <param name="@C2SysNo" dbType="Int32" />
      <param name="@C3SysNo" dbType="Int32" />
      <param name="@EditUserSysNo" dbType="Int32" />
      <param name="@EditUserName" dbType="AnsiStringFixedLength" />

    </parameters>
  </dataCommand>

  <!-- 获取佣金规则:ECStore.dbo.CommissionRule -->
  <dataCommand name="LoadCommissionRule" database="write" commandType="Text">
    <commandText>
      <![CDATA[
    SELECT 
            SysNo, OrderCommissionFee, SalesRule, DeliveryFee, RentFee, Status, BrandSysNo, C1SysNo, C2SysNo, C3SysNo, InUserSysNo, InUserName, InDate, EditUserSysNo, EditUserName, EditDate 
            FROM ECStore.dbo.CommissionRule WITH(NOLOCK) 
            WHERE SysNo=@SysNo
        ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />

    </parameters>
  </dataCommand>


  <dataCommand name="UpdateVendorManufacturerInfo" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
update  ipp3.dbo.Vendor_Manufacturer

set [VendorSysNo]=@VendorSysNo,
--[ManufacturerSysNo]=@ManufacturerSysNo,
[C2SysNo]=@C2SysNo,
[AgentLevel]=@AgentLevel,
[Status]=@Status,
[CreateTime]=getdate(),
[C3SysNo]=@C3SysNo,
CompanyCode=@CompanyCode
WHERE SysNo = @SysNo AND CompanyCode = @CompanyCode

SELECT [SysNo] as [AgentSysNo]
,[VendorSysNo]
,[ManufacturerSysNo] as [ManufacturerInfo.SysNo]
,[C2SysNo]
,[AgentLevel]
,[Status]
,[CreateTime]
,[C3SysNo]
FROM ipp3.[dbo].[Vendor_Manufacturer] WITH (NOLOCK)
WHERE SysNo = @SysNo AND CompanyCode = @CompanyCode
        ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />
      <param name="@VendorSysNo" dbType="Int32" />
      <!--<param name="@ManufacturerSysNo" dbType="Int32" />-->
      <param name="@C2SysNo" dbType="Int32" />
      <param name="@AgentLevel" dbType="String" size="50" />
      <param name="@Status" dbType="Int32" />
      <param name="@C3SysNo" dbType="Int32" />
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" />
    </parameters>
  </dataCommand>

  <dataCommand name="CreateVendorManufacturer" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
DECLARE @SysNo INT

INSERT INTO ipp3.dbo.Vendor_Manufacturer
(
[VendorSysNo],
[ManufacturerSysNo],
[C2SysNo],
[AgentLevel],
[Status],
[CreateTime],
[C3SysNo],
CompanyCode,
[BrandSysNo])
VALUES
(
@VendorSysNo,
(SELECT TOP (1) ManufacturerSysNo FROM [OverseaContentManagement].[dbo].[Brand]
  WHERE SysNo = @BrandSysNo),
@C2SysNo,
@AgentLevel,
@Status,
getdate(),
@C3SysNo,
@CompanyCode,
@BrandSysNo
)

SET @SysNo = SCOPE_IDENTITY()

SELECT [SysNo] as [AgentSysNo]
,[VendorSysNo]
,[ManufacturerSysNo] as [ManufacturerInfo.SysNo]
,[C2SysNo]
,[AgentLevel]
,[Status]
,[CreateTime]
,[C3SysNo]
FROM ipp3.[dbo].[Vendor_Manufacturer] WITH (NOLOCK)
WHERE SysNo = @SysNo AND CompanyCode = @CompanyCode
        ]]>
    </commandText>
    <parameters>
      <param name="@VendorSysNo" dbType="Int32" />
      <param name="@C2SysNo" dbType="Int32" />
      <param name="@AgentLevel" dbType="String" size="50" />
      <param name="@Status" dbType="Int32" />
      <param name="@C3SysNo" dbType="Int32" />
      <param name="@BrandSysNo" dbType="Int32" />
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" />
    </parameters>
  </dataCommand>
  <dataCommand name="CreateVendorCommissionRule" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
if not exists (select 1 from OverseaPOASNManagement.dbo.CommissionRule_Merchant where VendorManufacturerSysNo=@VendorManufacturerSysNo)
begin
INSERT INTO OverseaPOASNManagement.dbo.CommissionRule_Merchant
        (
	        VendorManufacturerSysNo,
	        OrderCommissionFee,
	        DeliveryFee,
	        RentFee,
	        Status,
	        InUser,
	        InDate,
	        EditUser,
	        EditDate,
	        CompanyCode,
	        SalesRule
        )
        VALUES
        (
	        @VendorManufacturerSysNo,
	        @OrderCommissionFee,
	        @DeliveryFee,
	        @RentFee,
	        'A',
	        @InUser,
	        GetDATE(),
	        @EditUser,
	        GetDATE(),
	        @CompanyCode,
	        @SalesRule
        )
end
else
begin
update  OverseaPOASNManagement.dbo.CommissionRule_Merchant
	        set OrderCommissionFee=@OrderCommissionFee,
	        DeliveryFee=@DeliveryFee,
	        RentFee=@RentFee,
	        Status ='A',
	        InUser=@InUser,
	        InDate=GetDATE(),
	        EditUser=@EditUser,
	        EditDate=GetDATE(),
	        CompanyCode=@CompanyCode,
	        SalesRule=@SalesRule
where VendorManufacturerSysNo=@VendorManufacturerSysNo
end
			]]>
    </commandText>
    <parameters>
      <param name="@VendorManufacturerSysNo" dbType="Int32" />
      <param name="@OrderCommissionFee" dbType="Decimal" />
      <param name="@DeliveryFee" dbType="Decimal" />
      <param name="@RentFee" dbType="Decimal" />
      <param name="@InUser" dbType="String" />
      <param name="@EditUser" dbType="String" />
      <param name="@SalesRule" dbType="String" />
      <param name="@CompanyCode" dbType="AnsiStringFixedLength"/>
    </parameters>
  </dataCommand>
  <dataCommand name="PublishStorePage" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
declare @PageTypeKey CHAR(20)
SELECT @PageTypeKey = PageTypeKey from [ECStore].[dbo].[StorePageInfo] WITH(NOLOCK)
where SysNo=@StorePageSysNo
      
if not exists (select 1 from [ECStore].[dbo].[PublishedStorePageInfo](nolock) where [SellerSysNo]=@SellerSysNo and [StorePageSysNo]=@StorePageSysNo)
begin
INSERT INTO [ECStore].[dbo].[PublishedStorePageInfo]
           ([SellerSysNo]
           ,[DataValue]
           ,[LinkUrl]
           ,[Status]
           ,[InUserSysNo]
           ,[InUserName]
           ,[InDate]
           ,[EditUserSysNo]
           ,[EditUserName]
           ,[EditDate]
           ,[StorePageSysNo]
           ,[PageName]
           ,PageTypeKey)
     VALUES
           (@SellerSysNo	
           ,@DataValue  	
           ,''
           ,@Status			
           ,@InUserSysNo	
           ,@InUserName		
           ,GETDATE()		
           ,@EditUserSysNo	
           ,@EditUserName	
           ,GETDATE()
           ,@StorePageSysNo
           ,@PageName
           ,@PageTypeKey)
           
           SELECT @SysNo = SCOPE_IDENTITY(); 

UPDATE [ECStore].[dbo].[PublishedStorePageInfo]
SET LinkUrl = 'Store/'+cast(@SellerSysNo as nvarchar)+'/'+cast(@SysNo as nvarchar)
WHERE SysNo = @SysNo

end
else
begin

update [ECStore].[dbo].[PublishedStorePageInfo]
set [DataValue]=@DataValue  
,[Status]=@Status			
,[EditUserSysNo]=@EditUserSysNo	
,[EditUserName]=@EditUserName	
,[EditDate]=GETDATE()
where [SellerSysNo]=@SellerSysNo and [StorePageSysNo]=@StorePageSysNo
end
        ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />
      <param name="@SellerSysNo" dbType="Int32" />
      <param name="@DataValue" dbType="String" />
      <param name="@Status" dbType="Int32" />
      <param name="@InUserSysNo" dbType="Int32" />
      <param name="@InUserName" dbType="AnsiStringFixedLength" />
      <param name="@EditUserSysNo" dbType="Int32" />
      <param name="@EditUserName" dbType="AnsiStringFixedLength" />
      <param name="@StorePageSysNo" dbType="Int32" />
      <param name="@PageName" dbType="AnsiStringFixedLength" />
    </parameters>
  </dataCommand>

  <dataCommand name="SaveStorePage" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
INSERT INTO [ECStore].[dbo].[StorePageInfo]
           ([SellerSysNo]
           ,[PageTypeKey]
           ,[PageName]
           ,[DataValue]
           ,[LinkUrl]
           ,[Status]
           ,[InUserSysNo]
           ,[InUserName]
           ,[InDate]
           ,[EditUserSysNo]
           ,[EditUserName]
           ,[EditDate])
     VALUES
           (@SellerSysNo
           ,@PageTypeKey
           ,@PageName
           ,@DataValue
           ,@LinkUrl
           ,@Status
           ,@InUserSysNo
           ,@InUserName
           ,GETDATE()
           ,@EditUserSysNo
           ,@EditUserName
           ,GETDATE())
SELECT @SysNo = SCOPE_IDENTITY(); 

UPDATE [ECStore].[dbo].[StorePageInfo]
SET LinkUrl = 'Store/Preview/'+cast(@SellerSysNo as nvarchar)+'/'+cast(@SysNo as nvarchar)
WHERE SysNo = @SysNo AND SellerSysNo = @SellerSysNo
        ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" direction="Output"/>
      <param name="@SellerSysNo" dbType="Int32" />
      <param name="@PageTypeKey" dbType="AnsiStringFixedLength" />
      <param name="@PageName" dbType="AnsiStringFixedLength" />
      <param name="@DataValue" dbType="AnsiStringFixedLength" />
      <param name="@LinkUrl" dbType="AnsiStringFixedLength" />
      <param name="@Status" dbType="Int32" />
      <param name="@InUserSysNo" dbType="Int32" />
      <param name="@InUserName" dbType="AnsiStringFixedLength" />
      <param name="@EditUserSysNo" dbType="Int32" />
      <param name="@EditUserName" dbType="AnsiStringFixedLength" />
    </parameters>
  </dataCommand>

  <dataCommand name="QueryAllPageLayout" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
SELECT TOP 1000 rtrim([PageLayoutKey]) as PageLayoutKey
      ,[PageLayoutName]
      ,[Status]
      ,[Memo]
  FROM [ECStore].[dbo].[PageLayout]
        ]]>
    </commandText>
    <parameters>
    </parameters>
  </dataCommand>

  <dataCommand name="QueryStorePageByPageName" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
select * from ECStore..StorePageInfo where PageName=@PageName and SellerSysNo=@SellerSysNo
        ]]>
    </commandText>
    <parameters>
      <param name="@SellerSysNo" dbType="Int32" />
      <param name="@PageName" dbType="AnsiStringFixedLength" />
    </parameters>
  </dataCommand>

  <!-- 获取页面类型，不允许随意修改，页面类型配合页面ID可以定位到所有的数据页面，所有店铺模板的页面类型都是一样的:ECStore.dbo.PageType -->
  <dataCommand name="QueryAllPageType" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
SELECT * FROM ECStore.dbo.PageType WITH(NOLOCK) 
        ]]>
    </commandText>
    <parameters>
    </parameters>
  </dataCommand>


  <!-- 获取页面模板，不允许随意修改，可供业务类型选用； 本表中保存各种页面类型中预设的几种模板，和几个通用型的自定义模板。:ECStore.dbo.PageTemplate -->
  <dataCommand name="QueryStorePageTemplate" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
SELECT TOP 1000 rtrim([Key]) as [Key]
      ,[PageTemplateType]
      ,[DataValue]
      ,[PageTypeKey]
      ,[Name]
      ,[Desc]
      ,[TemplateViewPath]
      ,[MockupUrl]
      ,[Status]
      ,[Memo]
      ,[Priority]
FROM ECStore.dbo.PageTemplate WITH(NOLOCK) 
WHERE PageTypeKey=@PageTypeKey
order by [Priority] asc
      ]]>
    </commandText>
    <parameters>
      <param name="@PageTypeKey" dbType="AnsiStringFixedLength" />

    </parameters>
  </dataCommand>

  <dataCommand name="QueryStorePageTemplateByTemplateKey" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
SELECT TOP 1 rtrim([Key]) as [Key]
      ,[PageTemplateType]
      ,[DataValue]
      ,[PageTypeKey]
      ,[Name]
      ,[Desc]
      ,[TemplateViewPath]
      ,[MockupUrl]
      ,[Status]
      ,[Memo]
      ,[Priority]
FROM ECStore.dbo.PageTemplate WITH(NOLOCK) 
WHERE [Key] = @TemplateKey
      ]]>
    </commandText>
    <parameters>
      <param name="@TemplateKey" dbType="AnsiStringFixedLength" />
    </parameters>
  </dataCommand>

  <dataCommand name="DisableStorePage" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
      UPDATE [ECStore].[dbo].[StorePageInfo]
      SET Status = 0
      WHERE SysNo = @SysNo AND SellerSysNo = @SellerSysNo  AND PageTypeKey = 'CustomPage'
      ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />
      <param name="@SellerSysNo" dbType="Int32" />
    </parameters>
  </dataCommand>

  <dataCommand name="EnableStorePage" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
      UPDATE [ECStore].[dbo].[StorePageInfo]
      SET Status = 1
      WHERE SysNo = @SysNo AND SellerSysNo = @SellerSysNo
      ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />
      <param name="@SellerSysNo" dbType="Int32" />
    </parameters>
  </dataCommand>

  <dataCommand name="DeleteStorePage" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
begin tran t1

DELETE FROM [ECStore].[dbo].[StorePageInfo]
WHERE SysNo = @SysNo AND SellerSysNo = @SellerSysNo AND PageTypeKey = 'CustomPage'

delete ECStore.dbo.PublishedStorePageInfo
where StorePageSysNo=@SysNo and SellerSysNo = @SellerSysNo

commit tran t1
      ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />
      <param name="@SellerSysNo" dbType="Int32" />
    </parameters>
  </dataCommand>

  <dataCommand name="DeleteStorePageFromPublish" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
delete ECStore.dbo.PublishedStorePageInfo
where StorePageSysNo=@SysNo and SellerSysNo = @SellerSysNo
      ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />
      <param name="@SellerSysNo" dbType="Int32" />
    </parameters>
  </dataCommand>

  <dataCommand name="GetPageElementByPageTypeKey" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
SELECT RTRIM([Key]) AS [Key]
      ,[Name]
      ,[Desc]
      ,[ElementGroupName]
      ,[DataExecuteType]
      ,[DataExecutorName]
      ,[DataExecutorDesc]
      ,[DataExecutorImplType]
      ,[FrontPartialViewPath]
      ,[MockupUrl]
      ,[Status]
      ,[Memo]
  FROM [ECStore].[dbo].[PageElement] AS P WITH(NOLOCK)
  INNER JOIN [ECStore].[dbo].[PageType_Element] AS PE WITH(NOLOCK)
  ON P.[Key]=PE.[PageElementKey]
  WHERE PE.[PageTypeKey]=@PageTypeKey AND [Status]=1
  ORDER BY P.[ElementGroupName]
        ]]>
    </commandText>
    <parameters>
      <param name="@PageTypeKey" dbType="AnsiStringFixedLength" />
    </parameters>
  </dataCommand>



  <!-- 创建企业(商家)基本信息:ECStore.dbo.StoreBasicInfo -->
  <dataCommand name="InsertStoreBasicInfo" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
    INSERT INTO ECStore.dbo.StoreBasicInfo 
            (SellerSysNo,Name,Address,Site,ContactName,
            Mobile,Phone,Email,QQ,HaveECExp,ECExpValue,
            CurrentECChannel,HaveExportExp,ExportExpValue,
            --MainProductCategory,MainBrand,
            BrandAuthorize,CooperationMode,Remark,Status,InUserSysNo,InUserName,InDate,EditUserSysNo,EditUserName,EditDate,StoreName,LogoURL) 
            VALUES 
            (@SellerSysNo,@Name,@Address,@Site,@ContactName,
            @Mobile,@Phone,@Email,@QQ,@HaveECExp,@ECExpValue
            ,@CurrentECChannel,@HaveExportExp,@ExportExpValue,
            --@MainProductCategory,@MainBrand,
            @BrandAuthorize,@CooperationMode,@Remark,@Status,@InUserSysNo,@InUserName,GETDATE(),@InUserSysNo,@InUserName,GETDATE(),@StoreName,@LogoURL)

            SELECT @SysNo = SCOPE_IDENTITY(); 
        ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" direction="Output"/>
      <param name="@SellerSysNo" dbType="Int32" />
      <param name="@Name" dbType="String" />
      <param name="@Address" dbType="String" />
      <param name="@Site" dbType="String" />
      <param name="@ContactName" dbType="String" />
      <param name="@Mobile" dbType="AnsiString" />
      <param name="@Phone" dbType="AnsiString" />
      <param name="@Email" dbType="AnsiString" />
      <param name="@QQ" dbType="AnsiString" />
      <param name="@HaveECExp" dbType="Int32" />
      <param name="@ECExpValue" dbType="Int32" />
      <param name="@CurrentECChannel" dbType="String" />
      <param name="@HaveExportExp" dbType="Int32" />
      <param name="@ExportExpValue" dbType="Int32" />
      <param name="@MainProductCategory" dbType="String" />
      <param name="@MainBrand" dbType="String" />
      <param name="@BrandAuthorize" dbType="String" />
      <param name="@CooperationMode" dbType="String" />
      <param name="@Remark" dbType="String" />
      <param name="@Status" dbType="Int32" />
      <param name="@InUserSysNo" dbType="Int32" />
      <param name="@InUserName" dbType="AnsiStringFixedLength" />
      <param name="@StoreName" dbType="AnsiStringFixedLength" />
      <param name="@LogoURL" dbType="AnsiStringFixedLength" />
    </parameters>
  </dataCommand>

  <!-- 更新企业(商家)基本信息:ECStore.dbo.StoreBasicInfo -->
  <dataCommand name="UpdateStoreBasicInfo" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
    UPDATE ECStore.dbo.StoreBasicInfo SET 
        SellerSysNo=@SellerSysNo,
        Name=@Name,
        Address=@Address,
        Site=@Site,
        ContactName=@ContactName,
        Mobile=@Mobile,
        Phone=@Phone,
        Email=@Email,
        QQ=@QQ,
        HaveECExp=@HaveECExp,
        ECExpValue=@ECExpValue,
        CurrentECChannel=@CurrentECChannel,
        HaveExportExp=@HaveExportExp,
        ExportExpValue=@ExportExpValue,
        --MainProductCategory=@MainProductCategory,
        --MainBrand=@MainBrand,
        BrandAuthorize=@BrandAuthorize,
        CooperationMode=@CooperationMode,
        Remark=@Remark,
        Status=@Status,
        EditUserSysNo=@EditUserSysNo,
        EditUserName=@EditUserName,
        EditDate=GETDATE() ,
        StoreName=@StoreName ,
        LogoURL=@LogoURL
        WHERE SysNo=@SysNo
        ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />
      <param name="@SellerSysNo" dbType="Int32" />
      <param name="@Name" dbType="String" />
      <param name="@Address" dbType="String" />
      <param name="@Site" dbType="String" />
      <param name="@ContactName" dbType="String" />
      <param name="@Mobile" dbType="AnsiString" />
      <param name="@Phone" dbType="AnsiString" />
      <param name="@Email" dbType="AnsiString" />
      <param name="@QQ" dbType="AnsiString" />
      <param name="@HaveECExp" dbType="Int32" />
      <param name="@ECExpValue" dbType="Int32" />
      <param name="@CurrentECChannel" dbType="String" />
      <param name="@HaveExportExp" dbType="Int32" />
      <param name="@ExportExpValue" dbType="Int32" />
      <param name="@MainProductCategory" dbType="String" />
      <param name="@MainBrand" dbType="String" />
      <param name="@BrandAuthorize" dbType="String" />
      <param name="@CooperationMode" dbType="String" />
      <param name="@Remark" dbType="String" />
      <param name="@Status" dbType="Int32" />
      <param name="@EditUserSysNo" dbType="Int32" />
      <param name="@EditUserName" dbType="AnsiStringFixedLength" />
      <param name="@StoreName" dbType="AnsiStringFixedLength" />
      <param name="@LogoURL" dbType="AnsiStringFixedLength" />
    </parameters>
  </dataCommand>

  <!-- 获取企业(商家)基本信息:ECStore.dbo.StoreBasicInfo -->
  <dataCommand name="LoadStoreBasicInfo" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
    SELECT 
            SysNo, SellerSysNo, Name, Address, Site, ContactName, Mobile, Phone, Email, QQ, HaveECExp, ECExpValue, CurrentECChannel, HaveExportExp, ExportExpValue, MainProductCategory, MainBrand, BrandAuthorize, CooperationMode, Remark, Status, InUserSysNo, InUserName, InDate, EditUserSysNo, EditUserName, EditDate ,StoreName,LogoURL
            FROM ECStore.dbo.StoreBasicInfo WITH(NOLOCK) 
            WHERE SysNo=@SysNo
        ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />

    </parameters>
  </dataCommand>


  <!-- 创建企业(商家)附件:ECStore.dbo.StoreAttachment -->
  <dataCommand name="InsertStoreAttachment" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
    INSERT INTO ECStore.dbo.StoreAttachment 
            (SellerSysNo,Url,Name,Status,Remark,InUserSysNo,InUserName,InDate,EditUserSysNo,EditUserName,EditDate) 
            VALUES 
            (@SellerSysNo,@Url,@Name,@Status,@Remark,@InUserSysNo,@InUserName,GETDATE(),@InUserSysNo,@InUserName,GETDATE())

            SELECT @SysNo = SCOPE_IDENTITY(); 
        ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" direction="Output"/>
      <param name="@SellerSysNo" dbType="Int32" />
      <param name="@Url" dbType="AnsiString" />
      <param name="@Name" dbType="String" />
      <param name="@Status" dbType="Int32" />
      <param name="@Remark" dbType="String" />
      <param name="@InUserSysNo" dbType="Int32" />
      <param name="@InUserName" dbType="AnsiStringFixedLength" />

    </parameters>
  </dataCommand>

  <!-- 更新企业(商家)附件:ECStore.dbo.StoreAttachment -->
  <dataCommand name="UpdateStoreAttachment" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
    UPDATE ECStore.dbo.StoreAttachment SET 
        SellerSysNo=@SellerSysNo,
        Url=@Url,
        Name=@Name,
        Status=@Status,
        Remark=@Remark,
        EditUserSysNo=@EditUserSysNo,
        EditUserName=@EditUserName,
        EditDate=GETDATE() 
        WHERE SysNo=@SysNo
        ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />
      <param name="@SellerSysNo" dbType="Int32" />
      <param name="@Url" dbType="AnsiString" />
      <param name="@Name" dbType="String" />
      <param name="@Status" dbType="Int32" />
      <param name="@Remark" dbType="String" />
      <param name="@EditUserSysNo" dbType="Int32" />
      <param name="@EditUserName" dbType="AnsiStringFixedLength" />

    </parameters>
  </dataCommand>

  <!-- 获取企业(商家)附件:ECStore.dbo.StoreAttachment -->
  <dataCommand name="LoadStoreAttachment" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
    SELECT 
            SysNo, SellerSysNo, Url, Name, Status, Remark, InUserSysNo, InUserName, InDate, EditUserSysNo, EditUserName, EditDate 
            FROM ECStore.dbo.StoreAttachment WITH(NOLOCK) 
            WHERE SysNo=@SysNo
        ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />

    </parameters>
  </dataCommand>

  <!-- 获取企业(商家)附件:ECStore.dbo.StoreAttachment -->
  <dataCommand name="QueryStoreAttachment" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
    SELECT 
            SysNo, SellerSysNo, Url, Name, Status, Remark, InUserSysNo, InUserName, InDate, EditUserSysNo, EditUserName, EditDate 
            FROM ECStore.dbo.StoreAttachment WITH(NOLOCK) 
            WHERE SellerSysNo=@SellerSysNo
        ]]>
    </commandText>
    <parameters>
      <param name="@SellerSysNo" dbType="Int32" />

    </parameters>
  </dataCommand>

  <!-- 获取企业(商家)附件:ECStore.dbo.StoreAttachment -->
  <dataCommand name="DeleteAttachmentBySellerSysNo" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
            DELETE ECStore.dbo.StoreAttachment 
            WHERE SellerSysNo=@SellerSysNo
        ]]>
    </commandText>
    <parameters>
      <param name="@SellerSysNo" dbType="Int32" />

    </parameters>
  </dataCommand>


  <!-- 获取企业(商家)基本信息:ECStore.dbo.StoreBasicInfo -->
  <dataCommand name="QueryStoreBasicInfoBySellerSysNo" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
select distinct ('['+convert(varchar(100), b.SysNo)+']'+b.BrandName_Ch) as BrandName from ipp3.dbo.Vendor_Manufacturer(nolock) m
	join OverseaContentManagement.dbo.brand (nolock) b
		on b.sysno=m.brandsysno
where m.vendorsysno=@SellerSysNo

select distinct ('['+convert(varchar(100), c3.SysNo)+']'+c3.C3Name) as C3Name from ipp3.dbo.Vendor_Manufacturer(nolock) m
	join ipp3..category3 (nolock) c3
		on c3.sysno=m.C3SysNo
where m.vendorsysno=@SellerSysNo

SELECT 
SysNo, SellerSysNo, Name, Address, Site, ContactName, Mobile, Phone, Email, QQ, HaveECExp, ECExpValue, CurrentECChannel, HaveExportExp, ExportExpValue, MainProductCategory, MainBrand, BrandAuthorize, CooperationMode, Remark, Status, InUserSysNo, InUserName, InDate, EditUserSysNo, EditUserName, EditDate ,StoreName,LogoURL
FROM ECStore.dbo.StoreBasicInfo WITH(NOLOCK) 
WHERE SellerSysNo=@SellerSysNo
        ]]>
    </commandText>
    <parameters>
      <param name="@SellerSysNo" dbType="Int32" />

    </parameters>
  </dataCommand>


  <!-- 更新店铺网页的主信息。:ECStore.dbo.StorePageInfo -->
  <dataCommand name="UpdateStorePage" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
    UPDATE ECStore.dbo.StorePageInfo SET 
        SellerSysNo=@SellerSysNo,
        PageTypeKey=@PageTypeKey,
        PageName=@PageName,
        DataValue=@DataValue,
        LinkUrl='Store/Preview/'+cast(@SellerSysNo as nvarchar)+'/'+cast(@SysNo as nvarchar),
        Status=@Status,
        EditUserSysNo=@EditUserSysNo,
        EditUserName=@EditUserName,
        EditDate=GETDATE() 
        WHERE SysNo=@SysNo
        ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />
      <param name="@SellerSysNo" dbType="Int32" />
      <param name="@PageTypeKey" dbType="AnsiStringFixedLength" />
      <param name="@PageName" dbType="String" />
      <param name="@DataValue" dbType="String" />
      <param name="@LinkUrl" dbType="String" />
      <param name="@Status" dbType="Int32" />
      <param name="@EditUserSysNo" dbType="Int32" />
      <param name="@EditUserName" dbType="AnsiStringFixedLength" />

    </parameters>
  </dataCommand>

  <!-- 创建店铺网页的Header信息。:ECStore.dbo.StorePageHeader -->
  <dataCommand name="InsertStorePageHeader" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
    INSERT INTO ECStore.dbo.StorePageHeader 
            (SellerSysNo,HeaderContent,InUserSysNo,InUserName,InDate,TextModel,HeaderContentText) 
            VALUES 
            (@SellerSysNo,@HeaderContent,@InUserSysNo,@InUserName,GETDATE(),@TextModel,@HeaderContentText)

            SELECT @SysNo = SCOPE_IDENTITY(); 
        ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" direction="Output"/>
      <param name="@SellerSysNo" dbType="Int32" />
      <param name="@HeaderContent" dbType="String" />
      <param name="@HeaderContentText" dbType="String" />
      <param name="@InUserSysNo" dbType="Int32" />
      <param name="@InUserName" dbType="AnsiStringFixedLength" />
      <param name="@TextModel" dbType="Int32" />
    </parameters>
  </dataCommand>

  <!-- 更新店铺网页的Header信息。:ECStore.dbo.StorePageHeader -->
  <dataCommand name="UpdateStorePageHeader" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
    UPDATE ECStore.dbo.StorePageHeader SET 
        SellerSysNo=@SellerSysNo,
        HeaderContent=@HeaderContent,
        EditUserSysNo=@EditUserSysNo,
        EditUserName=@EditUserName,
        EditDate=GETDATE() ,
        TextModel = @TextModel,
        HeaderContentText=@HeaderContentText
        WHERE SysNo=@SysNo
        ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />
      <param name="@SellerSysNo" dbType="Int32" />
      <param name="@HeaderContent" dbType="String" />
      <param name="@HeaderContentText" dbType="String" />
      <param name="@EditUserSysNo" dbType="Int32" />
      <param name="@EditUserName" dbType="AnsiStringFixedLength" />
      <param name="@TextModel" dbType="Int32" />
    </parameters>
  </dataCommand>

  <!-- 获取店铺网页的Header信息。:ECStore.dbo.StorePageHeader -->
  <dataCommand name="LoadStorePageHeader" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
    SELECT 
            SysNo, SellerSysNo, HeaderContent, InUserSysNo, InUserName, InDate, EditUserSysNo, EditUserName, EditDate ,TextModel
            FROM ECStore.dbo.StorePageHeader WITH(NOLOCK) 
            WHERE SysNo=@SysNo
        ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />

    </parameters>
  </dataCommand>
  <!-- 获取店铺网页的Header信息。:ECStore.dbo.StorePageHeader -->
  <dataCommand name="QueryPageHeaderBySellerSysNo" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
    SELECT 
            SysNo, SellerSysNo, HeaderContent, InUserSysNo, InUserName, InDate, EditUserSysNo, EditUserName, EditDate 
            FROM ECStore.dbo.StorePageHeader WITH(NOLOCK) 
            WHERE SellerSysNo=@SellerSysNo
        ]]>
    </commandText>
    <parameters>
      <param name="@SellerSysNo" dbType="Int32" />

    </parameters>
  </dataCommand>
  
  <dataCommand name="QueryStorePageList" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
      
     SELECT @TotalCount = COUNT(1) FROM [ECStore].[dbo].[StorePageInfo] AS s 
     #StrWhere#
      
      SELECT * FROM
      (SELECT TOP (@EndNumber)
      s.[SysNo]
      ,s.[SellerSysNo]
      ,s.[PageTypeKey]
      ,s.[PageName]
      ,s.[DataValue]
      ,s.[LinkUrl]
      ,isnull(ps.[Status],0) as  [Status]
      ,s.[Status] as [StorePageStatus]
      ,s.[InUserSysNo]
      ,s.[InUserName]
      ,s.[InDate]
      ,s.[EditUserSysNo]
      ,s.[EditUserName]
      ,s.[EditDate]
      ,ps.LinkUrl AS PLinkUrl
      ,(ROW_NUMBER() OVER(ORDER BY #SortColumnName#)) AS RowNumber
      ,vendor.SecondDomain
      FROM [ECStore].[dbo].[StorePageInfo] AS s 
      Left join [ECStore].[dbo].[PublishedStorePageInfo] ps
      ON s.SysNo=ps.StorePageSysNo
      left join ipp3..Vendor vendor(nolock)
		on vendor.sysno=s.SellerSysNo and vendor.SecondDomainStatus=1
      #StrWhere#
  ) AS T 
  WHERE RowNumber > @StartNumber
      ]]>
    </commandText>
    <parameters>
    </parameters>
  </dataCommand>

  <dataCommand name="QueryStoreNavigationList" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
      
     SELECT @TotalCount = COUNT(1) FROM [ECStore].[dbo].[StoreNavigation] AS s 
     #StrWhere#
      
      SELECT * FROM
      (SELECT TOP (@EndNumber)
      [SysNo]
      ,[SellerSysNo]
      ,[Content]
      ,[LinkUrl]
      ,[Priority]
      ,[Status]
      ,[InUserSysNo]
      ,[InUserName]
      ,[InDate]
      ,[EditUserSysNo]
      ,[EditUserName]
      ,[EditDate]
      ,(ROW_NUMBER() OVER(ORDER BY #SortColumnName#)) AS RowNumber
      FROM [ECStore].[dbo].[StoreNavigation] AS s 
      #StrWhere#
  ) AS T 
  WHERE RowNumber > @StartNumber
      ]]>
    </commandText>
    <parameters>
    </parameters>
  </dataCommand>
  
  <dataCommand name="SaveNavigationForm" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
INSERT INTO [ECStore].[dbo].[StoreNavigation]
           ([SellerSysNo]
           ,[Content]
           ,[LinkUrl]
           ,[Status]
           ,[Priority]
           ,[InUserSysNo]
           ,[InUserName]
           ,[InDate])
     VALUES
           (@SellerSysNo
           ,@Content
           ,@LinkUrl
           ,@Status
           ,@Priority
           ,@InUserSysNo
           ,@InUserName
           ,GETDATE())
SELECT @SysNo = SCOPE_IDENTITY(); 
        ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" direction="Output"/>
      <param name="@SellerSysNo" dbType="Int32" />
      <param name="@Content" dbType="AnsiStringFixedLength" />
      <param name="@LinkUrl" dbType="AnsiStringFixedLength" />
      <param name="@Status" dbType="Int32" />
      <param name="@Priority" dbType="Int32" />
      <param name="@InUserSysNo" dbType="Int32" />
      <param name="@InUserName" dbType="AnsiStringFixedLength" />
    </parameters>
  </dataCommand>

  <dataCommand name="DeleteNavigation" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
      DELETE  [ECStore].[dbo].[StoreNavigation]
WHERE SysNo = @SysNo AND SellerSysNo = @SellerSysNo  
      ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />
      <param name="@SellerSysNo" dbType="Int32" />
    </parameters>
  </dataCommand>
  
  <dataCommand name="SaveStoreBasicInfoToIPP3Vendor" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
      DECLARE @SysNo INT
      INSERT INTO IPP3.dbo.Vendor_Sequence (CreateTime) VALUES(GETDATE())
      SET @SysNo = SCOPE_IDENTITY()

      if not exists (select 1 from ipp3..vendor(nolock) where SellerID=@SellerID)
      begin
      INSERT INTO IPP3.dbo.Vendor
      (
      SysNo, VendorID, VendorName, EnglishName,
      BriefName, VendorType, District, Address,
      Zip, Phone, Fax, Email,
      Site, Bank, Account, TaxNo,
      Contact, Comment, Note,
      Status ,RMAPolicy,PayPeriod,
      RepairAddress,RepairAreaSysNo,RepairContact,RepairContactPhone,
      Cellphone,AcctContactName,AcctPhone,RMAServiceArea,
      IsConsign,PayPeriodType,ValidDate,ExpiredDate,ContractAmt,TotalPOMoney,
      CreateVendorUserSysNo,CreateVendorTime,VendorContractInfo,IsCooperate,AcctContactEmail,CompanyCode
      ,SellerID
      ,RepairPostcode--,UpdateTime
      )
      VALUES (
      @SysNo, @SysNo, @VendorName, @EnglishName,
      @BriefName, @VendorType, @District, @Address,
      @Zip, @Phone, @Fax, @Email,
      @Site, @Bank, @Account, @TaxNo,
      @Contact, @Comment, @Note,
      @Status , @RMAPolicy , @PayPeriod,
      @RepairAddress,@RepairAreaSysNo,@RepairContact,@RepairContactPhone,
      @Cellphone,@AcctContactName,@AcctPhone,@RMAServiceArea,
      @IsConsign,@PayPeriodType,@ValidDate,@ExpiredDate,@ContractAmt,@TotalPOMoney,
      @CreateVendorUserSysNo,getdate(),@VendorContractInfo,@IsCooperate,@AcctContactEmail,@CompanyCode
      ,@SellerID
      ,@RepairPostcode--,@UpdateTime
      )
      end
      else
      begin
        --update IPP3.dbo.Vendor
        --set VendorName=@VendorName
        --,set EnglishName=@EnglishName
        --,set BriefName=@BriefName
        --,set VendorType=@VendorType
        --,set District=@District
        --,set Address=@Address
        --,set Zip=@Zip
        --,set Phone=@Phone
        --,set Fax=@Fax
        --,set Email=@Email
        --,set Site=@Site
        --,set Bank=@Bank
        --,set Account=@Account
        --,set TaxNo=@TaxNo
        --,set Contact=@Contact
        --,set Comment=@Comment
        --,set Note=@Note
        --,set Status=@Status
        --,set RMAPolicy=@RMAPolicy
        --,set PayPeriod=@PayPeriod
        --,set RepairAddress=@RepairAddress
        --,set RepairAreaSysNo=@RepairAreaSysNo
        --,set RepairContact=@RepairContact
        --,set RepairContactPhone=@RepairContactPhone
        --,set Cellphone=@Cellphone
        --,set AcctContactName=@AcctContactName
        --,set AcctPhone=@AcctPhone
        --,set RMAServiceArea=@RMAServiceArea
        --,set IsConsign=@IsConsign
        --,set PayPeriodType=@PayPeriodType
        --,set ValidDate=@ValidDate
        --,set ExpiredDate=@ExpiredDate
        --,set ContractAmt=@ExpiredDate
        --,set TotalPOMoney=@TotalPOMoney
        --,set CreateVendorUserSysNo=@CreateVendorUserSysNo
        --,set CreateVendorTime=@CreateVendorTime
        --,set VendorContractInfo=@VendorContractInfo
        --,set IsCooperate=@IsCooperate
        --,set AcctContactEmail=@AcctContactEmail
        --,set RepairPostcode=@RepairPostcode
        --where SysNo=@SysNo
        print '2'
      end
      --SELECT [SysNo] as [SysNo]
      --,[VendorID] as [VendorBasicInfo.VendorID]
      --,[VendorName] as [VendorBasicInfo.VendorNameLocal]
      --,[EnglishName]  as [VendorBasicInfo.VendorNameGlobal]
      --,[BriefName] as [VendorBasicInfo.VendorBriefName]
      --,[VendorType] as [VendorBasicInfo.VendorType]
      --,[District] as [VendorBasicInfo.District]
      --,[Address] as [VendorBasicInfo.Address]
      --,[Zip] as [VendorBasicInfo.ZipCode]
      --,[Contact] as [VendorBasicInfo.Contact]
      --,[Phone] as [VendorBasicInfo.Phone]
      --,[Fax] as [VendorBasicInfo.Fax]
      --,[Email] as [VendorBasicInfo.EmailAddress]
      --,[Site] as [VendorBasicInfo.Website]
      --,[Bank] as [VendorFinanceInfo.BankName]
      --,[Account] as [VendorFinanceInfo.AccountNumber]
      --,[TaxNo] as [VendorFinanceInfo.TaxNumber]
      --,[Comment]
      --,[Note]
      --,[Status] as [VendorBasicInfo.VendorStatus]
      --,[RMAPolicy] as [VendorServiceInfo.RMAPolicy]
      --,[PayPeriod] as [VendorFinanceInfo.PayPeriod]
      --,[RepairAddress] as [VendorServiceInfo.Address]
      --,[RepairAreaSysNo]  as [VendorServiceInfo.AreaInfo.SysNo]
      --,[RepairContact] as [VendorServiceInfo.Contact]
      --,[RepairContactPhone] as [VendorServiceInfo.ContactPhone]
      --,[RepairPostcode] as [VendorServiceInfo.ZipCode]
      --,[Cellphone] as  [VendorBasicInfo.CellPhone]
      --,[AcctContactName] as [VendorFinanceInfo.AccountContact]
      --,[AcctPhone] as [VendorFinanceInfo.AccountPhone]
      --,[RMAServiceArea] as [VendorServiceInfo.RMAServiceArea]
      --,[IsConsign] as [VendorBasicInfo.ConsignFlag]
      --,[PayPeriodType] as [VendorFinanceInfo.PayPeriodType.PayTermsNo]
      --,[ValidDate] as [VendorFinanceInfo.CooperateValidDate]
      --,[ExpiredDate] as [VendorFinanceInfo.CooperateExpiredDate]
      --,[ContractAmt] as [VendorFinanceInfo.CooperateAmt]
      --,[TotalPOMoney] as [VendorFinanceInfo.TotalPOAmt]
      --,[CreateVendorUserSysNo]
      --,[CreateVendorTime]
      --,[VendorContractInfo]
      --,[HoldMark]
      --,[HoldDate]
      --,[HoldUser]
      --,[HoldReason]
      --,[IsCooperate]
      --,[AcctContactEmail]
      --,SellerID
      --,RepairPostcode
      --,CompanyCode
      --,UpdateTime
      --FROM IPP3.[dbo].[Vendor] WITH (NOLOCK) WHERE SysNo = @SysNo AND CompanyCode = @CompanyCode
			]]>
    </commandText>
    <parameters>
      <param name="@VendorName" dbType="String" size="200" />
      <param name="@EnglishName" dbType="String" size="200" />
      <param name="@BriefName" dbType="String" size="100" />
      <param name="@VendorType" dbType="Int32" />
      <param name="@District" dbType="String" size="200" />
      <param name="@Address" dbType="String" size="200" />
      <param name="@Zip" dbType="String" size="20" />
      <param name="@Contact" dbType="String" size="40" />
      <param name="@Phone" dbType="String" size="100" />
      <param name="@Fax" dbType="String" size="100" />
      <param name="@Email" dbType="String" size="100" />
      <param name="@Site" dbType="String" size="200" />
      <param name="@Bank" dbType="String" size="100" />
      <param name="@Account" dbType="String" size="100" />
      <param name="@TaxNo" dbType="String" size="100" />
      <param name="@Comment" dbType="String" size="40" />
      <param name="@Note" dbType="String" size="1000" />
      <param name="@Status" dbType="Int32" />
      <param name="@RMAPolicy" dbType="String" size="1000" />
      <param name="@PayPeriod" dbType="Int32" />
      <param name="@RepairAddress" dbType="String" size="200" />
      <param name="@RepairAreaSysNo" dbType="Int32" />
      <param name="@RepairContact" dbType="String" size="40" />
      <param name="@RepairContactPhone" dbType="String" size="100" />
      <param name="@Cellphone" dbType="String" size="100" />
      <param name="@AcctContactName" dbType="String" size="200" />
      <param name="@AcctPhone" dbType="String" size="100" />
      <param name="@RMAServiceArea" dbType="String" size="1000" />
      <param name="@IsConsign" dbType="Int32" />
      <param name="@PayPeriodType" dbType="Int32" />
      <param name="@ValidDate" dbType="DateTime" />
      <param name="@ExpiredDate" dbType="DateTime" />
      <param name="@ContractAmt" dbType="Decimal" />
      <param name="@TotalPOMoney" dbType="Decimal" />
      <param name="@CreateVendorUserSysNo" dbType="Int32" />
      <param name="@VendorContractInfo" dbType="String" size="40" />
      <param name="@IsCooperate" dbType="Int32" />
      <param name="@AcctContactEmail" dbType="String" size="100" />
      <param name="@CompanyCode" dbType="AnsiStringFixedLength" />
      <param name="@SellerID" dbType ="AnsiStringFixedLength"/>
      <param name="@RepairPostcode" dbType="String" />
      <!--<param name="@UpdateTime" dbType="DateTime"/>-->
    </parameters>
  </dataCommand>

  <dataCommand name="RestoreDefaultStorePage" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
      DECLARE @PageTypeKey NVARCHAR(50)
      DECLARE @Key NVARCHAR(50)
      
      SELECT @PageTypeKey = PageTypeKey FROM [ECStore].[dbo].[StorePageInfo]
      WHERE SysNo = @SysNo AND SellerSysNo = @SellerSysNo AND PageTypeKey!='CustomPage'

      SELECT @Key = CASE @PageTypeKey 
        WHEN 'Home' THEN 'LeftMain1'
        WHEN 'ProductList' THEN 'LeftMain3'
        WHEN 'SearchResult' THEN 'LeftMain4'
      ELSE '' END

      UPDATE [ECStore].[dbo].[StorePageInfo]
      SET DataValue = (
	        SELECT DataValue FROM [ECStore].[dbo].[PageTemplate] WHERE 
	        [Key] = @Key AND [ECStore].[dbo].[PageTemplate].PageTypeKey = @PageTypeKey
      )
      WHERE SysNo = @SysNo AND SellerSysNo = @SellerSysNo AND PageTypeKey!='CustomPage'

      ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />
      <param name="@SellerSysNo" dbType="Int32" />
    </parameters>
  </dataCommand>

  <dataCommand name="LoadVendorInfo" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
      SELECT V.[SysNo] 
      ,V.[VendorID] 
      ,V.[SellerID]
      ,V.[VendorName] as [VendorNameLocal]
      ,V.[EnglishName] as [VendorNameGlobal]
      ,V.[BriefName] as [VendorBriefName]
      ,V.[VendorType]
      ,V.[District] 
      ,V.[Address] 
      ,V.[Zip] as [ZipCode]
      ,V.[Contact] 
      ,V.[Phone]
      ,V.[Fax] 
      ,V.[Email] as [EmailAddress]
      ,V.[Site] as [Website]
      ,V.[Comment] 
      ,V.[Note] 
      ,V.[Status] as [VendorStatus]
      ,V.IsConsign as [ConsignFlag]
      ,V.[Cellphone] as  [CellPhone]
      ,V.[HoldMark] as [HoldMark]
      ,V.[HoldReason] as [HoldReason]
      ,V.[IsCooperate] as [VendorIsCooperate]
      ,V.[RANK] as [VendorBasicInfo.VendorRank]
      ,R.[RANK] AS  [VendorBasicInfo.RequestVendorRank]
      FROM [IPP3].[dbo].[Vendor] V WITH(NOLOCK)
      LEFT JOIN [IPP3].[dbo].[Vendor_ModifyRequest] R WITH(NOLOCK)
      ON V.[SysNo] = R.VendorSysNo
      AND R.status = 0
      AND R.RequestType = 1
      LEFT JOIN IPP3.dbo.Vendor_Ex C WITH(nolock)
      ON V.SysNo = C.VendorSysNo
     WHERE V.VendorID=@VendorSysNo


  SELECT TOP 1
	      a.SysNo
	      ,a.VendorSysNo
	      ,a.StockType
	      ,a.ShippingType
	      ,a.InvoiceType
	      ,a.LogoPath
	      ,a.MerchantRate
	      ,a.BriefInfo
	      ,a.Bulletin
	      ,a.DefaultStock
	      ,a.CurrencyCode
	      ,b.RentFee
        ,(CASE WHEN a.IsShowStore = 'Y' THEN 1 ELSE 0 END) as IsShowStore
        ,(case a.IM_Enabled  when 'Y' then cast(1 AS bit) else cast(0 AS bit) end) AS IM_Enabled 
      FROM ipp3.dbo.Vendor_Ex a WITH(nolock)
      LEFT JOIN OverseaPOASNManagement.dbo.CommissionRule_Merchant b WITH(nolock)
      ON a.SysNo = b.VendorManufacturerSysNo
      WHERE a.VendorSysNo = @VendorSysNo

      ]]>
    </commandText>
    <parameters>
      <param name="@VendorSysNo" dbType="Int32" />
    </parameters>
  </dataCommand>

  <!-- 创建企业申请附件:ECStore.dbo.ApplicationAttachment -->
  <dataCommand name="InsertCertificaitonAttachment" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
    INSERT INTO Ipp3.dbo.SellerApplicationAttachment 
            (SellerSysNo,Url,FileName,Status,[ApplicationType],InUser,InDate) 
            VALUES 
            (@SellerSysNo,@Url,@FileName,@Status,'C',@UserID,GETDATE())

            SELECT @SysNo = SCOPE_IDENTITY(); 
        ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" direction="Output"/>
      <param name="@SellerSysNo" dbType="Int32" />
      <param name="@Url" dbType="AnsiString" />
      <param name="@FileName" dbType="String" />
      <param name="@Status" dbType="AnsiStringFixedLength" />
      <!--<param name="@Memo" dbType="String" />-->
      <param name="@UserID" dbType="AnsiStringFixedLength" />
    </parameters>
  </dataCommand>

  <dataCommand name="InsertApplication" database="Write" commandType="Text">
    <commandText>
      <![CDATA[
    INSERT INTO Ipp3.dbo.SellerApplication 
            (SellerSysNo,Status,[ApplicationType],InUser,InDate) 
            VALUES 
            (@SellerSysNo,@Status,'C',@UserID,GETDATE())

            SELECT @SysNo = SCOPE_IDENTITY(); 
        ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" direction="Output"/>
      <param name="@SellerSysNo" dbType="Int32" />
      <param name="@Status" dbType="AnsiStringFixedLength" />
      <param name="@UserID" dbType="AnsiStringFixedLength" />
    </parameters>
  </dataCommand>
</dataOperations>

